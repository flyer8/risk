!function(){"use strict";var a=angular.module("riskMarket",["riskMarket.templates","ui.bootstrap","ngAnimate","publicNavigation","ui.mask","mainPage","registry","utils","ngCookies","ngRoute","searchResults","orderPrepare","orderPayment","orderResult","privateOffice","ngSanitize","adminMonitor","innerPages","partner","partnerLogin","publicFooter","comparePolicies"]);a.config(["$routeProvider","$logProvider","$locationProvider","DEBUG","ROUTES","STRUCTURE","MODULES","PATH_SEPARATOR","REST_API","$httpProvider","$sceDelegateProvider","BUSINESS_ENTITIES","currenciesSumProvider","insuranceCalculationProvider","orderManagerProvider","countriesProvider","riskOptionsProvider","riskFiltersProvider","soldItemsProvider","USER_ROLES","USER_TYPES","HTTP_HEADERS","insuranceCompaniesProvider","assistanceCompaniesProvider","insuredDaysProvider","policiesManagerProvider","insuranceTypesProvider","$animateProvider","ANIMATED_CLASSES",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){b.debugEnabled(d.LOG_MODE_ENABLED),k.resourceUrlWhitelist(["https://demomoney.yandex.ru/eshop.xml","https://money.yandex.ru/eshop.xml","self","https://riskmarket-dev.ru/order-done","https://riskmarket-dev.ru/order-fail","http://test.riskmarket.ru/order-done","http://test.riskmarket.ru/order-fail"]),j.defaults.headers.common[v.ACCEPT]=v.ACCEPT.JSON,r.dataSource=i.RISK_FILTERS,q.dataSource=i.RISK_OPTIONS,n.dataSource=i.INSURANCE_CALCULATOR,s.dataSource=i.ADMIN_MONITOR,n.dataSource=i.INSURANCE_CALCULATOR,j.interceptors.push("rememberMeInterceptor"),p.dataSource=i.COUNTRIES_LIST,p.compareBy="nameRus",o.draftPersistenceDestination=i.ORDER_DRAFT,o.orderPurchaseDestination=i.ORDER_PURCHASE,o.acceptanceDestination=i.PAYMENT_PROCESS_STARTED,o.draftCreationDestination=i.DRAFT_CREATE,n.dataSource=i.INSURANCE_CALCULATOR,m.dataSource=i.CURRENCIES_SUM,w.dataSource=i.INSURANCE_COMPANIES,x.dataSource=i.ASSISTANCE_COMPANIES,y.dataSource=i.INSURED_DAYS,z.dataSource=i.PRIVATE_OFFICE.POLICIES_LIST,z.removeEntityEndpoint=i.PRIVATE_OFFICE.REMOVE_POLICY,A.dataSource=i.INSURANCE_TYPES,B.classNameFilter(new RegExp(C.join("|"),"i")),c.html5Mode(!0);var D=function(a,b){return a.updateAuthState().then(angular.noop,function(a){return b.reject(a)})},E=["userAuth","$q",function(a,b){return D(a,b)}],F=["riskOptions","$q",function(a,b){return a.getList().then(function(a){return a},function(a){return b.reject(a)})}],G=["countries","$q",function(a,b){return a.getList().then(function(a){return a},function(a){return b.reject(a)})}],H=["userAuth","$q",function(a,b){return D(a,b)["finally"](function(){var c,d=a.getCurrentUser();if(d.value){var e=b.defer();d.value.userType===u.PARTNER?e.resolve(!0):e.reject(),c=e.promise}else c=b.reject();return c})}];a.when(e.MAIN_PAGE,{resolve:{load:E,countries:G},templateUrl:[f.MODULES,g.MAIN_PAGE.FOLDER,f.TEMPLATES,g.MAIN_PAGE.TEMPLATES.MAIN_PAGE].join(h),controller:g.MAIN_PAGE.CONTROLLERS.MAIN_PAGE,businessEntity:l.MAIN_PAGE}).when(e.ABOUT,{resolve:{load:E},templateUrl:[f.MODULES,g.INNER_PAGES.FOLDER,f.TEMPLATES,g.INNER_PAGES.TEMPLATES.ABOUT_SERVICE_PAGE].join(h),businessEntity:l.ABOUT_PAGE}).when(e.SEARCH_RESULTS,{resolve:{load:E,riskOptions:F,countries:G},templateUrl:[f.MODULES,g.SEARCH_RESULTS.FOLDER,f.TEMPLATES,g.SEARCH_RESULTS.TEMPLATES.SEARCH_RESULTS].join(h),controller:g.SEARCH_RESULTS.CONTROLLERS.SEARCH_RESULTS,businessEntity:l.SEARCH_RESULTS}).when(e.ORDER_PREPARE,{resolve:{load:E,riskOptions:F},templateUrl:[f.MODULES,g.ORDER_PREPARE.FOLDER,f.TEMPLATES,g.ORDER_PREPARE.TEMPLATES.ORDER_PREPARE].join(h),controller:g.ORDER_PREPARE.CONTROLLERS.ORDER_PREPARE,businessEntity:l.ORDER_PREPARE}).when(e.ORDER_PAYMENT,{resolve:{load:E,riskOptions:F},templateUrl:[f.MODULES,g.ORDER_PAYMENT.FOLDER,f.TEMPLATES,g.ORDER_PAYMENT.TEMPLATES.ORDER_PAYMENT].join(h),controller:g.ORDER_PAYMENT.CONTROLLERS.ORDER_PAYMENT,businessEntity:l.ORDER_PAYMENT}).when(e.ORDER_DONE,{resolve:{load:E},templateUrl:[f.MODULES,g.ORDER_RESULT.FOLDER,f.TEMPLATES,g.ORDER_RESULT.TEMPLATES.ORDER_DONE].join(h),controller:g.ORDER_RESULT.CONTROLLERS.ORDER_DONE,businessEntity:l.ORDER_DONE}).when(e.ORDER_FAIL,{resolve:{load:E},templateUrl:[f.MODULES,g.ORDER_RESULT.FOLDER,f.TEMPLATES,g.ORDER_RESULT.TEMPLATES.ORDER_FAIL].join(h),controller:g.ORDER_RESULT.CONTROLLERS.ORDER_FAIL}).when(e.PRIVATE_OFFICE,{resolve:{load:E,riskOptions:F},templateUrl:[f.MODULES,g.PRIVATE_OFFICE.FOLDER,f.TEMPLATES,g.PRIVATE_OFFICE.TEMPLATES.PRIVATE_OFFICE].join(h),controller:g.PRIVATE_OFFICE.CONTROLLERS.PRIVATE_OFFICE,businessEntity:l.PRIVATE_OFFICE}).when(e.ADMIN_MONITOR,{resolve:{load_admin:["userAuth","$q",function(a,b){return D(a,b)["finally"](function(){var c=a.getCurrentUser();return!(!c.value||c.value.roles.indexOf(t.ADMIN)===-1)||b.reject("User have no rights")})}]},templateUrl:[f.MODULES,g.ADMIN_MONITOR.FOLDER,f.TEMPLATES,g.ADMIN_MONITOR.TEMPLATES.ADMIN_MONITOR].join(h),controller:g.ADMIN_MONITOR.CONTROLLERS.ADMIN_MONITOR}).when(e.CONTACTS,{resolve:{load:E},templateUrl:[f.MODULES,g.INNER_PAGES.FOLDER,f.TEMPLATES,g.INNER_PAGES.TEMPLATES.CONTACTS_PAGE].join(h),businessEntity:l.CONTACTS_PAGE}).when(e.TERMS,{resolve:{load:E},name:"TERMS_PAGE",templateUrl:[f.MODULES,g.INNER_PAGES.FOLDER,f.TEMPLATES,g.INNER_PAGES.TEMPLATES.TERMS_PAGE].join(h),businessEntity:l.TERMS_PAGE}).when(e.PARTNER,{resolve:{partner:H},templateUrl:[f.MODULES,g.PARTNER.FOLDER,f.TEMPLATES,g.PARTNER.TEMPLATES.PARTNER_TRADES].join(h),controller:g.PARTNER.CONTROLLERS.PARTNER_CONTROLLER,businessEntity:l.PARTNER}).when(e.PARTNER_LOGIN,{resolve:{load:E},templateUrl:[f.MODULES,g.PARTNER_LOGIN.FOLDER,f.TEMPLATES,g.PARTNER_LOGIN.TEMPLATES.PARTNER_LOGIN].join(h),controller:g.PARTNER_LOGIN.CONTROLLERS.PARTNER_LOGIN,businessEntity:l.PARTNER_LOGIN}).when(e.COMPARE_POLICIES,{resolve:{load:E},templateUrl:[f.MODULES,g.COMPARE_POLICIES.FOLDER,f.TEMPLATES,g.COMPARE_POLICIES.TEMPLATES.COMPARE_POLICIES].join(h),controller:g.COMPARE_POLICIES.CONTROLLERS.COMPARE_POLICIES,businessEntity:l.COMPARE_POLICIES}).otherwise({redirectTo:e.MAIN_PAGE})}]),a.run(["$rootScope","EVENTS","UX","pageScroll","$log","$location","PAGE_META","$route","BUSINESS_ENTITIES","USER_TYPES","userAuth","manageLocation","ROUTES","ANALYTICS","$window","$document","TRUSTED_ORIGINS","DEFAULT_PARTNER","dataStorage","frameManager",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(a.$on(b.LOCATION.CHANGE_START,function(b){var c=m.SEARCH_RESULTS,d=[m.MAIN_PAGE,m.ABOUT,m.CONTACTS,m.TERMS,m.PARTNER,m.PARTNER_LOGIN,m.ADMIN_MONITOR,m.PRIVATE_OFFICE];a.appInFrameMode&&_.includes(d,f.path())&&(b.preventDefault(),l.redirect(c))}),a.$on(b.ROUTE.CHANGE_SUCCESS,function(){var b=h.current.businessEntity,j=_.findKey(i,function(a){return a===b});a.pageTitle=(g[j]||g.DEFAULT).TITLE;var k=i.ORDER_PAYMENT;a.appInFrameMode||i[j]===k||d.scrollTo({animationTime:c.SCROLLING.TIME,easing:c.SCROLLING.EASING,scrollTo:c.SCROLLING.DEFAULT_TOP_SCROLLING});var l=s.getData("partnerId");_.isString(l)||s.setData("partnerId",f.search().partnerId||r);var m={title:p.prop("title"),referer:p.prop("referrer"),callback:function(){e.info("Page hit was successfully send to Yandex metrika: ",m)}},q=o[n.YANDEX_METRIKA.COUNTER];q&&"function"==typeof q.hit?q.hit(f.absUrl(),m):e.warn("Can not send information about changed route to tracking system")}),a.isPartnerLoginPage=function(){return l.isCurrentLocation(m.PARTNER_LOGIN)},a.isPartnerCabinetPage=function(){return l.isCurrentLocation(m.PARTNER)},a.isMainPage=function(){return l.isCurrentLocation(m.MAIN_PAGE)},a.$on(b.ROUTE.CHANGE_ERROR,function(){f.path(m.MAIN_PAGE)}),a.$on(b.USER_ACTIONS.LOGOUT,function(){if(a.isPartnerCabinetPage())e.debug("Redirecting to the partner login page"),f.path(m.PARTNER_LOGIN);else{var b=[m.ORDER_PREPARE,m.ADMIN_MONITOR,m.ORDER_PAYMENT,m.PRIVATE_OFFICE];b.indexOf(f.path())!==-1&&f.path(m.MAIN_PAGE)}e.debug("User is now logout")}),a.routes=m,a.appInFrameMode=t.isAppInFrameMode(),a.appInFrameMode){a.currentPartner={},o.top.postMessage({request:"PARTNER_ID"},"*");var u=_.values(q);o.addEventListener(b.WINDOW.MESSAGE,function(b){_.includes(u,b.origin)&&"partnerId"===b.data.subject?(e.debug('Receiving response from trusted origin "'+b.origin+'". Setting partner id to: '+b.data.value),a.currentPartner.id=b.data.value,s.setData("partnerId",b.data.value)):e.warn('Message event was received from untrusted origin "'+b.origin+'". Doing nothing')})}o[b.WINDOW.ONBEFOREONLOAD]=function(){s.removeData("partnerId")}}])}(),function(){"use strict";angular.module("mainPage",["registry"])}(),function(){"use strict";var a=angular.module("riskMarket");a.controller("MainPageController",["$scope","$log","$location","$dateParser","ROUTES","CACHE_ITEMS","DATE_FORMAT","countries","SELECTABLE_ITEMS","TEXT_LABELS","orderManager","EVENTS",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=this;a.selectableItems=i,a.textLabels=j,a.isParticipantWarningHidden=!0,a.countries=h,a.showSearchResults=function(){m.saveFormPreview(a.formData),c.path(e.SEARCH_RESULTS)},this.saveFormPreview=function(a){var b=angular.copy(a);_.remove(b.passengers,function(a){return!a.birthDate||!a.isValid}),k.storeInsuranceParams(b)},a.formData={country:[],passengers:[],period:{"start-date":"","end-date":""}},a.submitAttempt=!1,a.validation={period:!1,passengers:!1},a.events={checkFormData:function(b){return b.country.length&&a.validation.period&&b.passengers.length&&a.validation.passengers},submitForm:function(b){a.submitAttempt=!0,a.events.checkFormData(b)&&a.showSearchResults()}};var n=a.$on(l.PARTICIPANTS_CONTROL.PASS_DATA,function(b,c){a.isParticipantWarningHidden=c}),o=a.$on(l.SCOPE.DESTROY,function(){n(),o()})}])}(),function(){"use strict";angular.module("innerPages",["registry"])}(),function(){"use strict";angular.module("searchResults",[])}(),function(){"use strict";var a=angular.module("searchResults");a.controller("SearchResultsController",["$scope","insuranceCalculation","riskOptions","$log","EVENTS","CACHE_ITEMS","REST_API","$filter","pageScroll","UX","orderManager","$rootScope","dataStorage","COMPARE_ITEMS","countries",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=this;a.countries=o,a.riskOptions=c,a.allowDisplayFilterInFrame=!l.appInFrameMode,a.cacheInsuranceParams=function(a){k.storeInsuranceParams(a)},a.fetchInsuranceParams=function(){var b=k.getInsuranceParams();return _.isEmpty(b)?(b={passengers:[],period:{"start-date":"","end-date":""},country:[],riskOptions:c,countries:o},a.cacheInsuranceParams(b)):(b.riskOptions=c,b.countries=o),b},a.insuranceParams=a.fetchInsuranceParams(),a.insuranceParams.resultsFilter=null,this.resetFilter=function(){a.insuranceParams.resultsFilter={calculationDataInput:{travelData:{period:{multi:void 0,insuredDays:void 0}},riskAliasMap:{MEDICAL_EXPENSES:{risk:{sumInsured:void 0},subRisks:{EXTRA_DENTAL_TREATMENT:{riskStatus:void 0},THIRD_PARTY_VISIT:{riskStatus:void 0},PRESCHEDULE_RETURN:{riskStatus:void 0},TRANSPORT_EXPENSES:{riskStatus:void 0},BRING_CHILDREN_BACK_HOME:{riskStatus:void 0},LEGAL_HELP:{riskStatus:void 0},LOST_OR_STOLEN_DOCUMENTS:{riskStatus:void 0}}},BROKEN_CAR:{riskStatus:void 0},FLIGHT_DELAY:{riskStatus:void 0}},currency:void 0},insuranceCompany:{companyName:void 0,registeredService:void 0},serviceCompany:{companyName:void 0,companyCode:void 0}}},this.resetFilter(),a.sortData={resultsOrder:null},this.resetComparedItems=function(){m.setData(f.COMPARED_POLICIES,angular.toJson([])),a.comparedItems=[],a.$broadcast(e.SEARCH_RESULT_ITEM.UPDATE_COMPARED_ITEMS,0)},this.resetSorting=function(){a.sortData.resultsOrder={prop:void 0,direction:void 0}},this.resetSorting(),this.filterParamsWatcher=function(a,b){a!==b&&i.scrollTo({scrollTo:j.SCROLLING.DEFAULT_TOP_SCROLLING,animationTime:j.SCROLLING.AUTO_SCROLLING_DURATION_ON_SEARCH_RESULT_PAGE})};var q=a.$watch("insuranceParams.resultsFilter",this.filterParamsWatcher,!0),r=a.$watch("sortData.resultsOrder",this.filterParamsWatcher,!0);a.$on(e.SCOPE.DESTROY,function(){q(),r()}),a.insuranceParams.resultsOrder=void 0,a.insuranceParams.riskFilters=a.insuranceParams.riskFilters||{},a.insuranceParams.specialTermFilters=a.insuranceParams.specialTermFilters||[],a.searchResults=[],p.insuranceCalculationDeferred=null,a.$on(e.ROUTE.CHANGE_START,function(){p.insuranceCalculationDeferred?(p.insuranceCalculationDeferred.cancel(),d.warn("Polling for calculation results has been terminated")):d.warn("Detected attempt to cancel non initialized deffer calculation object")}),a.fetchingResults=!1,a.allowToFetchResults=function(){return!!a.insuranceParams.period["start-date"]&&!!a.insuranceParams.period["end-date"]&&a.insuranceParams.country.length&&a.insuranceParams.passengers.length&&!a.fetchingResults},this.cleanInsuranceParams=function(a){return a.passengers&&a.passengers.length&&_.remove(a.passengers,function(a){return!a.birthDate}),a},this.checkPassengersValidity=function(a){return!(!Array.isArray(a.passengers)||!a.passengers.length)&&a.passengers.every(function(a){return a.isValid})},a.getResults=function(c){a.allowToFetchResults()&&(a.calculationDone=!1,p.cleanInsuranceParams(c),p.resetSorting(),p.resetFilter(),p.resetComparedItems(),a.cacheInsuranceParams(c),p.checkPassengersValidity(c)&&(a.allowDisplayFilterInFrame=!0,a.searchResults.splice(0),d.debug("Initiating polling process with params: ",c),p.insuranceCalculationDeferred=b.launchCalculation(c),a.fetchingResults=!0,p.insuranceCalculationDeferred.$promise.then(function(){d.debug("Calculation completed"),a.fetchingResults=!1,a.calculationDone=!0},function(b){d.error("Error during calculation process: ",b),a.fetchingResults=!1},function(b){d.debug("Data received: ",b),a.searchResults.push.apply(a.searchResults,b)})))},a.getResults(a.insuranceParams),a.expandItem=function(a){a.expanded=!a.expanded};var s=h("filter");a.isRelevantSearchResult=function(a,b){return a.relevant=!!s([a],b,!0).length,a.relevant};var t=null;a.getRelevantItemsReport=function(){var b=a.searchResults.reduce(function(a,b){return b.relevant&&(a.quantity++,a.presence=!0),a},{quantity:0,presence:!1});return t&&t.quantity===b.quantity||(t=b,a.$broadcast(e.SEARCH_RESULTS_FILTER.RELEVANT_ITEMS_REPORT_READY,t.quantity)),b},a.comparedItems=[];var u=a.$on(e.SEARCH_RESULT_ITEM.POLICY_ITEM_ADDED_FOR_COMPARE,function(b,c){c.isAddedToCompared?a.comparedItems.length<n.MAXIMUM_QUANTITY&&a.comparedItems.push(c):_.remove(a.comparedItems,{isAddedToCompared:!1}),m.setData(f.COMPARED_POLICIES,angular.toJson(a.comparedItems||[])),a.$broadcast(e.SEARCH_RESULT_ITEM.UPDATE_COMPARED_ITEMS,a.comparedItems.length)}),v=a.$on(e.SCOPE.DESTROY,function(){u(),v()})}])}(),function(){"use strict";var a=angular.module("searchResults");a.controller("searchResultItemCtrl",["$rootScope","$scope","$window","$location","CURRENCY_SYMBOLS","CACHE_ITEMS","ROUTES","TRUSTED_ORIGINS","REST_API","SEARCH_RES_ICONS","VENDOR_LOGO","TERRITORY_BLOCK","quantitySuffixFilter","orderManager","TEXT_LABELS","VENDOR_COMPANIES","EVENTS","frameManager",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.appInFrameMode=r.isAppInFrameMode();var s=i.SITE,t={included:"INCLUDED",optional:"OPTIONAL",notIncluded:"NOT_INCLUDED"},u=null;b.updateParamsGroup=function(){u={global:b.item.calculationDataInput.riskAliasMap,medical:b.item.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.subRisks,options:b.item.calculationDataInput.options}};var v=function(a,b){return"string"!=typeof a?a:0==a.length?null:{displayName:b[a].displayName,included:b[a].riskStatus===t.included,risk:b[a].risk}},w=function(a,b,c,d){return{left:v(a,b),right:v(c,d)}};b.site=s,b.config=b.config||{},b.currencySymbols=e,b.medicalExpenses=null,b.setMedicalExpenses=function(){b.updateParamsGroup(),b.medicalExpenses=[w("URGENT_HELP",u.medical,"BRING_CHILDREN_BACK_HOME",u.medical),w("MEDICAL_DRUGS",u.medical,"THIRD_PARTY_VISIT",u.medical),w("DIAGNOSIS",u.medical,"PRESCHEDULE_RETURN",u.medical),w("OUT_PATIENT_TREATMENT",u.medical,"TRANSPORT_EXPENSES",u.medical),w("INDOOR_TREATMENT",u.medical,"URGENT_MESSAGES",u.medical),w("SURGERY",u.medical,"LOST_OR_STOLEN_DOCUMENTS",u.medical),w("EXTRA_DENTAL_TREATMENT",u.medical,"SEARCH_AND_RESCUE",u.medical),w("MEDICAL_TRANSPORTATION",u.medical,"LEGAL_HELP",u.medical),w("TRANSPORT_OF_PATIENT_HOME",u.medical,"FLIGHT_DELAY",u.global),w("BODY_REPATRIATION",u.medical,"BROKEN_CAR",u.global),w("RETURN_DELAY",u.medical,"ADDITIONAL_EXPENSES",u.medical)]},b.extraOptions=null,b.setExtraOptions=function(){if(b.riskOptions){var a=b.riskOptions.ACTIVITY.specialTermDictionaryItems;b.extraOptions=[w({displayName:a.ACTIVE_REST.displayName,included:u.options&&u.options.ACTIVE_REST},null,"LUGGAGE",u.global),w({displayName:a.SPORT.displayName,included:u.options&&u.options.SPORT},null,"TRIP_CHANGE_OR_CANCELLATION",u.global),w({displayName:a.SPORT_COMPETITIONS.displayName,included:u.options&&u.options.SPORT_COMPETITIONS},null,"PERSONAL_LIABILITY",u.global),w({displayName:a.EXTREME_SPORT.displayName,included:u.options&&u.options.EXTREME_SPORT},null,"ACCIDENT",u.global)]}},b.item&&(b.setMedicalExpenses(),b.setExtraOptions()),b.events={onBuyClick:function(b){n.createOrderDraft(b),n.storeInsuranceChoice(b),a.appInFrameMode?c.open(d.protocol()+"://"+d.host()+g.ORDER_PREPARE):d.path(g.ORDER_PREPARE)},onPayClick:function(a,b){localStorage.setItem(f.ORDER_PREVIEW,angular.toJson(b)),n.storeInsuranceChoice(a),d.path(g.ORDER_PAYMENT)}},b.vendorIcon=k.CLASS,b.arrowDownIcon=j.ALL_PARAMS_ICON;try{b.territory=b.item.calculationDataInput.territoryDisplayName}catch(x){b.territory=""}b.maxTerritoryTextLength=l.MAX_SYMBOLS,b.showExtraOptions=[g.ORDER_PREPARE,g.ORDER_PAYMENT,g.PRIVATE_OFFICE].indexOf(d.path())!==-1;try{b.totalInsuredPersons=b.item.calculationDataInput.travelData.passengers.length}catch(x){b.totalInsuredPersons=0}b.quantitySuffix=m,b.vendorIconClass=function(a){var b,c=p,d=Object.keys(c)[0];try{b=a.serviceCompany.companyCode}catch(e){b=d}return b in c?c[b]:c[d]},b.item.isAddedToCompared=!!b.item.isAddedToCompared,b.item.tooltipText=o.TOOLTIPS.COMPARED_ITEM.ADD,b.updateComparedItemState=function(a){a.isAddedToCompared=!a.isAddedToCompared,a.tooltipText=a.isAddedToCompared?o.TOOLTIPS.COMPARED_ITEM.REMOVE:o.TOOLTIPS.COMPARED_ITEM.ADD,b.$emit(q.SEARCH_RESULT_ITEM.POLICY_ITEM_ADDED_FOR_COMPARE,a)},b.linkTargetAttr=r.getStaticLinksMode()}]),a.directive("searchResultItem",["EVENTS",function(a){return{scope:{item:"=",expand:"=",config:"=?",orderPreview:"=?",riskOptions:"=",previewAsTrigger:"=?",getActionLabel:"&?",getActionResource:"&?",contextAction:"&?"},transclude:!0,controller:"searchResultItemCtrl",link:function(b,c,d,e,f){var g=null;f(function(a,b){b=b.$parent.$parent,g=a});var h=g.find("[data-header]"),i=g.find("[data-extra-content]"),j=c.find("[data-primary-top]"),k=c.find("[data-primary-bottom]");j.before(h),k.append(i),c.click(function(a){b.previewAsTrigger&&void 0===$(a.target).attr("data-action-trigger")&&(b.item.expanded=!b.item.expanded,b.$digest())});var l=b.$on(a.SEARCH_RESULT_ITEM.UPDATE_ITEMS,function(){b.item&&"object"==typeof b.item&&(b.item.expanded=!1)}),m=b.$on(a.SCOPE.DESTROY,function(){l(),m()})},templateUrl:"modules/search-results/partials/search-result-item.html"}}])}(),function(){"use strict";var a=angular.module("searchResults");a.directive("searchQuery",["MODULES","STRUCTURE","PATH_SEPARATOR",function(a,b,c){return{scope:{action:"&",data:"=",actionAllowed:"&?"},templateUrl:[b.MODULES,a.SEARCH_RESULTS.FOLDER,b.TEMPLATES,a.SEARCH_RESULTS.TEMPLATES.SEARCH_QUERY].join(c),controller:["riskFilters","riskOptions","orderManager","SELECTABLE_ITEMS","CURRENCY_SYMBOLS","TEXT_LABELS","$scope","$log",function(a,b,c,d,e,f,g,h){g.selectableItems=d,g.textLabels=f;var i={sort:function(a,b,c){return c=c&&angular.isArray(a)||["asc"],_.sortByOrder(a,b,c)},numeric:function(a){return _.map(this.sort(a.values,a.sortBy,a.sortOrder),function(a){var b=a.value,c=_.transform(a.currencies,function(a,b){a.push(e[b])},[]).join(",");return b.toLocaleString()+" "+c})},string:function(a){return _.map(this.sort(a.values,a.sortBy,a.sortOrder),function(a){return a.displayName})}};g.dictionaries={luggage:{type:"numeric",list:null},trip_change_or_cancellation:{type:"numeric",list:null},accident:{type:"numeric",list:null},personal_liability:{type:"numeric",list:null}},g.formData={},g.getCountries=function(){g.countries=g.data.countries},g.getCountries(),g.fetchRiskFilters=function(){a.getList().then(function(a){h.debug("Risk filters: ",a.data),angular.forEach(g.dictionaries,function(b,c){"activity"!==c&&(b.list=i[b.type]({values:a.data[c.toUpperCase()].sumInsureds,sortBy:["value"]}))}),h.debug("$scope.dictionaries : ",g.dictionaries)},function(a){h.error("Error while trying to fetch risk filters: ",a)})},g.fetchRiskOptions=function(){g.dictionaries.activity=_.transform(g.data.riskOptions.ACTIVITY.specialTermDictionaryItems,function(a,b,c){b.code=c,a.push(b)},[])},g.fetchRiskOptions(),g.toggleRisk=function(a){var b=a.toUpperCase();b in g.data.riskFilters?delete g.data.riskFilters[b]:g.data.riskFilters[b]=1},g.toggleTerm=function(a){var b=a.toUpperCase();_.contains(g.data.specialTermFilters,b)?_.remove(g.data.specialTermFilters,function(a){return a===b}):g.data.specialTermFilters.push(b)}}]}}])}(),function(){"use strict";var a=angular.module("searchResults");a.directive("searchFilter",["MODULES","STRUCTURE","PATH_SEPARATOR","EVENTS","$document","$log","ROUTES",function(a,b,c,d,e,f,g){return{scope:{params:"=",order:"="},restrict:"A",templateUrl:[b.MODULES,a.SEARCH_RESULTS.FOLDER,b.TEMPLATES,a.SEARCH_RESULTS.TEMPLATES.SEARCH_FILTER].join(c),controller:["currenciesSum","CURRENCY_SYMBOLS","LOCALES","$scope","$q","insuranceCompanies","assistanceCompanies","insuredDays","quantitySuffixFilter","frameManager",function(a,b,c,e,h,i,j,k,l,m){function n(a){var c=_.map(_.keys(a),function(a){var c={};return"ANY"===a?(c.value=void 0,c.label=_.values(b).join(", ")):(c.value=a,c.label=b[a]),c});c.splice(0,0,_.remove(c,{value:void 0})[0]),e.dictionaries.currency=c}function o(a){var b=_.map(_.keys(a),function(a){var b={};return"ANY"===a?(b.label="Любая",b.value=void 0):(b.label=(+a).toLocaleString(c.RU),b.value=+a),b}),d=b.splice(_.findIndex(b,{value:void 0}),1)[0];b.unshift(d),e.dictionaries.insuranceSum=b}function p(a){var b=_.map(a,function(a){return{label:a.nameRus,value:{companyName:a.nameRus,registeredService:a.code},inactive:!a.active}});b=_.sortBy(b,function(a){return a.label.toLowerCase()}),b.unshift({label:"Все",value:{companyName:void 0,registeredService:void 0}}),e.dictionaries.insuranceCompanies=b}function q(a){var b=_.map(a,function(a){return{label:a.name,value:{companyName:a.name,companyCode:a.code}}});b=_.sortBy(b,function(a){return a.label.toLowerCase()}),b.unshift({label:"Все",value:{companyName:void 0,companyCode:void 0}}),e.dictionaries.assistanceCompanies=b}function r(a){var b=_.map(_.sortBy(a),function(a){return{label:a,value:a}});b.unshift({label:"Любое",value:void 0}),e.dictionaries.insuredDays=b}function s(a){var b=_.map(u[a.type][a.newValue],function(b){return"cts"===a.type?+b:b});_.forEach(a.origin,function(c){c.inactive=!_.contains(b,c.value)&&"ANY"!==a.newValue&&void 0!==c.value})}e.appInFrameMode=m.isAppInFrameMode(),e.showAdditionalFilters=!1;var t=e.$watch("showAdditionalFilters",function(a,b){a!==b&&a&&e.$broadcast(d.WIDGET.ADJUST_SIZE)});e.toggleFilters=function(){e.showAdditionalFilters=!e.showAdditionalFilters},e.quantitySuffix=l,e.dictionaries={currency:null,insuranceCompanies:null,assistanceCompanies:null,insuredDays:null,policyType:null,insuranceSum:null,sortOrder:null},e.referenceDataFetched=!1;var u=null;e.buildReferenceData=function(){var b=a.getList().then(function(a){f.debug("Currencies to sum list received: ",a.data),u=a.data,n(a.data.cts),o(a.data.stc),f.debug("Filter dictionaries after building: ",e.dictionaries)},function(a){return f.error("Can not fetch currencies to sum list: ",a),h.reject(a)}),c=i.getList().then(function(a){p(a.content)},function(a){return f.error("Can not fetch insurance companies list: ",a),h.reject(a)}),g=j.getList().then(function(a){q(a.data.content)},function(a){return f.error("Can not fetch assistance companies list: ",a),h.reject(a)}),l=k.getList().then(function(a){r(a.data)},function(a){return f.error("Can not fetch insured days list: ",a),h.reject(a)});h.all([b,c,g,l]).then(function(){e.$broadcast(d.WIDGET.ADJUST_SIZE),e.referenceDataFetched=!0},function(a){f.error("Error during building reference data: ",a)})},e.buildReferenceData();var v=e.$watch("params.riskAliasMap.MEDICAL_EXPENSES.risk.sumInsured",function(a,b){u&&a!==b&&(void 0===a&&(a="ANY"),s({newValue:a,type:"stc",origin:e.dictionaries.currency}))}),w=e.$watch("params.currency",function(a,b){u&&a!==b&&(void 0===a&&(a="ANY"),s({newValue:a,type:"cts",origin:e.dictionaries.insuranceSum}))});e.setPolicyTypes=function(){e.dictionaries.policyType=[{label:"Любой",value:void 0},{label:"Однократный",value:!1},{label:"Многократный",value:!0}]},e.setPolicyTypes(),e.setSortOrder=function(){e.dictionaries.sortOrder=[{label:"По умолчанию",value:{prop:void 0,direction:void 0}},{label:"Сначала дорогие",value:{prop:"totalPrice",direction:!0}},{label:"Сначала дешевые",value:{prop:"totalPrice",direction:!1}}]},e.setSortOrder(),e.relevantItemsQuantity=0;var x=e.$on(d.SEARCH_RESULTS_FILTER.RELEVANT_ITEMS_REPORT_READY,function(a,b){e.relevantItemsQuantity=b}),y=e.$watch("params.calculationDataInput.travelData.period.insuredDays",function(a,b){a!==b&&a!==e.dictionaries.insuredDays[0].value&&(e.params.calculationDataInput.travelData.period.multi=!0)}),z=e.$watch("params.calculationDataInput.travelData.period.multi",function(a,b){if(a!==b){var c=e.dictionaries.policyType[0].value,f=e.dictionaries.policyType[1].value;[c,f].indexOf(a)!==-1&&(e.params.calculationDataInput.travelData.period.insuredDays=e.dictionaries.insuredDays[0].value),e.$broadcast(d.WIDGET.BLOCK,"INSURED_DAYS",a===f)}});e.comparedItemsNum=0;var A=e.$on(d.SEARCH_RESULT_ITEM.UPDATE_COMPARED_ITEMS,function(a,b){e.comparedItemsNum=b,e.comparedItemsPageLink=e.comparedItemsNum>0?g.COMPARE_POLICIES:""});e.$on(d.SCOPE.DESTROY,function(){x(),v(),w(),y(),t(),z(),A()})}],link:function(a,b){function c(){if(a.showAdditionalFilters){a.$apply(function(){f.info("User scrolled a page. Hiding search filter details and triggering $digest cycle"),a.showAdditionalFilters=!1});var c=b.find("[data-filter-extra]"),e=c.css("transition-duration").split(",")[0];e=parseFloat(e)*(/ms$/i.test(e)?1:1e3),window.clearTimeout(a.resizeTimeout),a.resizeTimeout=window.setTimeout(function(){$(window).trigger(d.WINDOW.RESIZE)},1.05*e)}}e.on(d.SCROLL.REGULAR,c),a.$on(d.SCOPE.DESTROY,function(){e.off(d.SCROLL.REGULAR,c)})}}}])}(),function(){"use strict";var a=angular.module("searchResults");a.directive("stickyBlock",["EVENTS","$document","$parse",function(a,b,c){return{restrict:"A",link:function(c,d,e){function f(){if(!c.item.expanded)return void g.removeClass("sticky-enabled");var a=+n.height();if(c.item.expanded)if(h=d.find(".scrolled-block"),i=h.prop("offsetHeight"),j=h.offset().top-b.scrollTop()-k,j<=a&&b.scrollTop()>=m){if(g.addClass("sticky-enabled").css("top",a),h.css("margin-top",k),j<=a-i){var e=j+i;g.css("top",e),j<=-i&&(h.css("margin-top",0),g.removeClass("sticky-enabled"))}}else g.removeClass("sticky-enabled"),h.css("margin-top",0)}var g,h,i,j;g=d.find(".sticky-top");var k=g.prop("offsetHeight"),l=$("["+e.stickyBlockOffsetTopBy+"]"),m=l.length?l.first().height():0,n=$("["+e.stickyBlockFixedTo+"]").first();b.on(a.SCROLL.REGULAR,f);var o=function(){!c.item.expanded&&g.hasClass("sticky-enabled")&&(g.removeClass("sticky-enabled"),$("html, body").animate({scrollTop:g.offset().top-k},e.stickyBlockScrollSpeed))},p=g.find("[data-action-trigger]");p.on(a.ELEMENT.CLICK,o);var q=c.$on(a.SCOPE.DESTROY,function(){b.off(a.SCROLL.REGULAR,f),q(),p.off(a.ELEMENT.CLICK,o)})}}}])}(),function(){"use strict";angular.module("orderPrepare",[])}(),function(){"use strict";var a=angular.module("orderPrepare");a.controller("OrderPrepareController",["$scope","$log","$location","riskOptions","ROUTES","INSURER_MINIMAL_AGE","MONTH_PER_YEAR","CACHE_ITEMS","REGEXP","EVENTS","userAuth","MAX_SYMBOLS","REST_API","orderManager","MASKS","INSURANCE_COMPANIES","$dateParser","DATE_FORMAT","frameManager",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){a.insuranceChoice=n.getInsuranceChoice(),a.insuranceChoice||c.path(e.SEARCH_RESULTS),a.regexp=i,a.currentUser=k.getCurrentUser(),a.requestAuthenticate=k.requestAuthenticate,a.$on(j.USER_ACTIONS.LOGIN,function(){a.insurer.lastName=a.currentUser.value.lastName,a.insurer.firstName=a.currentUser.value.firstName,a.insurer.email=a.currentUser.value.email,a.insurer.phoneNumber=a.currentUser.value.phoneNumber,a.insurer.birthDate=a.currentUser.value.birthDate}),a.riskOptions=d;var t=n.getOrderPreview();a.insurer=t?t.insurer:null!=a.currentUser.value?a.currentUser.value:{lastName:"",firstName:"",email:"",phoneNumber:"",birthDate:""},a.toUpperCase=function(){a.insurer.firstName=a.insurer.firstName.toUpperCase(),a.insurer.lastName=a.insurer.lastName.toUpperCase()},a.prepareOrder=function(){return b.debug(this.prepare),this.prepare.$valid?(n.storeOrderPreview({calculationId:a.insuranceChoice.calculationId,insurer:a.insurer,insuredPersons:a.insuranceChoice.calculationDataInput.travelData.passengers}),n.storeInsuranceChoice(a.insuranceChoice),c.path(e.ORDER_PAYMENT),!0):(b.warn("Attempt to send invalid form"),!1)},a.ageIsAllowed=function(a){var b=new Date;b.setHours(0,0,0,0);var c=Date.parse(a.split(".").reverse().join("-")),d=new Date(c);return d.setMonth(d.getMonth()+f*g),d<b},a.isInsurerAgeAllowed=!0,a.checkInsurerBirthDate=function(b){return q(b,r)<new Date&&"string"==typeof b?(a.isBirthDateValid=!0,a.isInsurerAgeAllowed=a.ageIsAllowed(b),a.isInsurerAgeAllowed):(a.isInsurerAgeAllowed=!0,a.isBirthDateValid=!1,!1)},a.toUpperCase=function(a){return void 0!=a&&(void 0!=a.name&&(a.name=a.name.toUpperCase()),void 0!=a.surname&&(a.surname=a.surname.toUpperCase())),!0},a.toUpperCaseInsurer=function(a){return void 0!=a&&(void 0!=a.lastName&&(a.lastName=a.lastName.toUpperCase()),void 0!=a.firstName&&(a.firstName=a.firstName.toUpperCase())),!0},a.isInvalidPrepareForm=function(){return this.prepare.$invalid},a.isPrepareButtonDisabled=function(){null!=a.currentUser.value&&a.setThatEmailIsValid();var b=a.isInvalidPrepareForm()||a.isInvalidEmail()||!a.isUserAgreement;return b},a.setThatEmailIsValid=function(){a.validation.email=!0,a.validation.processing=!1},a.isInvalidEmail=function(){return!a.validation.email||a.validation.processing},a.validation={email:!0,processing:!1},a.isUserAgreement=!1,a.isEmailHint=!1,a.isEmailWarning=!1,a.firstCheckFlag=!1,a.showPopovers=function(){a.validation.email?a.isEmailHint=!0:a.isEmailWarning=!0},a.hidePopovers=function(){a.isEmailWarning=!1,a.isEmailHint=!1},a.checkEmail=function(){null==a.currentUser.value?(a.validation.processing=!0,k.checkEmail(a.insurer.email).then(function(b){a.validation.email=!b.data.created,a.firstCheckFlag?a.isEmailHint=!b.data.created:a.firstCheckFlag=!0,a.isEmailWarning=b.data.created,a.validation.processing=!1},a.setThatEmailIsValid)):a.setThatEmailIsValid()},a.checkEmail(),a.expandItem=function(a){a.expanded=!a.expanded},a.orderInfoPopover={templateUrl:"orderInfo.html"},a.searchResultsLink=e.SEARCH_RESULTS;try{a.currentCompany=a.insuranceChoice.insuranceCompany.registeredService}catch(u){a.currentCompany=""}a.vtbCompany=p.VTB.LABEL,a.isInsuranceCompany=function(a,b){return a===b},a.mask={blur:o.DATE.DEFAULT,focus:o.DATE.EMPTY},a.setMask=function(b){a.currentMask=a.mask[b]||""},a.currentMask=a.mask.blur,a.linkTargetAttr=s.getStaticLinksMode()}])}(),function(){"use strict";angular.module("orderPayment",[])}(),function(){"use strict";var a=angular.module("orderPayment");a.controller("OrderPaymentController",["$scope","$log","$q","$location","ROUTES","orderManager","CACHE_ITEMS","EVENTS","userAuth","$http","REST_API","riskOptions","httpCsrfAware","CURRENCY_SYMBOLS","manageLocation","INSURANCE_COMPANIES","frameManager",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){a.appInFrameMode=q.isAppInFrameMode(),a.paymentFormTarget=q.getStaticLinksMode(),
a.insuranceChoice=f.getInsuranceChoice(),b.debug("Current insurance choice: ",a.orderPreview),a.orderPreview=f.getOrderPreview(),b.debug("Order preview: ",a.orderPreview),a.insuranceChoice&&a.orderPreview||d.path(e.ORDER_PREPARE),a.orderPreviewSaved=!1,a.paymentDataReceived=!1,a.paymentInfo=null,a.orderDraft=null,a.allowSubmit=!1,a.acceptRequestPending=!1,a.riskOptions=l,a.editOrderDetails=function(){d.path(e.ORDER_PREPARE)},a.buildTransactionUrl=function(a){var b={success:e.ORDER_DONE,fail:e.ORDER_FAIL},c=b[a];return[d.protocol(),"://",d.host(),":",d.port(),"/",c].join("")},a.entitiesDeffered={previewData:null,draftData:null,paymentDetails:null},f.storeOrderDraft(a.orderPreview);var r=f.storePreviewData(a.orderPreview);a.entitiesDeffered.previewData=r,r.$promise.then(function(c){b.debug("Order draft id received: ",c.data),a.orderPreviewSaved=!0;var d=f.getPaymentDetails(c.data);return a.entitiesDeffered.paymentDetails=d,i.updateAuthState(),d.$promise},function(a){return b.error("Can not retrieve draft calculation id: ",a),c.reject(a)}).then(function(c){b.debug("Order payment details received: ",c.data),a.paymentDataReceived=!0,a.paymentInfo=c.data,a.paymentInfo.success=a.buildTransactionUrl("success"),a.paymentInfo.fail=a.buildTransactionUrl("fail"),a.formReady=!0},function(a){o.redirect(e.ORDER_FAIL),b.error("Can not receive payment details: ",a)}),a.$on(h.ROUTE.CHANGE_START,function(){angular.forEach(a.entitiesDeffered,function(a){a&&a.cancel()})}),a.checkOrder=function(c){a.orderPreviewSaved&&a.paymentDataReceived&&a.formReady||c.preventDefault(),a.acceptRequestPending=!0,f.acceptPolicyItem(a.paymentInfo.orderId).then(function(){b.debug("Order with id "+a.paymentInfo.orderId+" is ready to be paid."),a.allowSubmit=!0},function(c){o.redirect(e.ORDER_FAIL),a.acceptRequestPending=!1,b.error("Cannot start payment process. Reason: ",c)})},a.searchResultsLink=e.SEARCH_RESULTS,a.orderPrepareLink=e.ORDER_PREPARE,a.personalDataAgreementLink=k.PERSONAL_DATA_AGREEMENT,a.insuranceChoice.expanded="DRAFT"===a.insuranceChoice.status,a.insuredBlockExpanded=a.insuranceChoice.expanded,a.expandItem=function(b){b.expanded=!b.expanded,a.insuredBlockExpanded=b.expanded},a.currencySymbols=n;try{a.currentCompany=a.insuranceChoice.insuranceCompany.registeredService}catch(s){a.currentCompany=""}a.vtbCompany=p.VTB.LABEL,a.isInsuranceCompany=function(a,b){return a===b},a.linkTargetAttr=q.getStaticLinksMode()}])}(),function(){"use strict";angular.module("orderResult",[])}(),function(){"use strict";var a=angular.module("orderResult");a.controller("OrderDoneController",["userData","REST_API","$scope","ROUTES",function(a,b,c,d){a.clearCache(),c.linkToDownload=b.LATEST_BOUGHT_POLICY_DOWNLOAD,c.privateOfficeLink=d.PRIVATE_OFFICE}])}(),function(){"use strict";var a=angular.module("orderResult");a.controller("OrderFailController",["userData","$scope","ROUTES","ORDER_STATUSES","CACHE_ITEMS","orderManager","MACROS",function(a,b,c,d,e,f,g){b.insuranceCompanyTemplate=g.COMPANY_NAME_MACRO;var h=f.getInsuranceChoice();b.insuranceCompanyName=_.isObject(h)&&_.isObject(h.insuranceCompany)?h.insuranceCompany.companyName:"";var i=f.orderStatus;b.orderStatus=_.isEqual(i,d.DUMMY_ORDER)?d.SOMETHING_GOES_WRONG:i,b.failReasonUndefined=_.isEqual(b.orderStatus,d.SOMETHING_GOES_WRONG);var j=_.isEqual(b.orderStatus,d.INSURANCE_SERVICE_UNAVAILABLE)?{except:[e.TRIP_FORM]}:void 0;a.clearCache.call(a,j),b.privateOfficeLink=c.PRIVATE_OFFICE,b.searchResultsLink=c.SEARCH_RESULTS}])}(),function(){"use strict";angular.module("publicFooter",[])}(),function(){"use strict";var a=angular.module("publicFooter");a.controller("publicFooterController",["$scope","ROUTES","manageLocation",function(a,b,c){a.aboutPageLink=b.ABOUT,a.contactsPageLink=b.CONTACTS,a.termsPageLink=b.TERMS,a.partnerPageLink=b.PARTNER_LOGIN,a.isPartnerPage=function(){return c.isCurrentLocation(b.PARTNER)}}])}(),function(){"use strict";angular.module("publicNavigation",[])}(),function(){"use strict";var a=angular.module("publicNavigation");a.controller("loginController",["parent","$uibModalInstance","$window","$scope","$log","REGEXP","userAuth","$timeout","dataStorage","UX","WARNINGS","EVENTS","USER_TYPES","$rootScope","formHelper",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=this;d.regexp=f,d.isCollapsed=!0,d.isRestore=!1,d.loginError=!1,d.passwordRestoreError=!1,d.passwordRestoreIntent=!1,d.passwordRestoreResultReceived=!1,d.feedBack="",d.userType=m.CLIENT,d.formData={},d.formData.userName=i.getData("userEmail",!0),d.findInvalidFields=function(){n.$broadcast(l.LOGIN_MODAL.FIND_INVALID_ITEMS)},d.ok=function(){a.login(d.formData.userName,d.formData.password,!d.formData.alienComputer,d.userType).then(function(){b.dismiss("ok"),d.loginError=!1,d.feedBack=""},function(a){e.error("Can not login. Reason: ",a),d.loginError=!0,d.feedBack=k.LOGIN_FORM.LOGIN_ERROR})},d.isExistingEmail=function(){d.formData.userName&&d.login.userName.$valid&&g.checkEmail(d.formData.userName).then(function(a){d.userIsExisting=a.data.created,d.userIsExisting?(d.passwordRestoreError=!1,d.feedBack="",d.loginError=!1,d.isCollapsed=!0,d.passwordRestoreIntent&&(d.isRestore=!0)):(d.passwordRestoreError=!0,d.feedBack=k.LOGIN_FORM.USER_NOT_FOUND,d.isCollapsed=!1)},function(a){e.error("Error while checking user email: ",a)})},d.restorePassword=function(){d.passwordRestoreIntent=!0,a.resetPassword(d.formData.userName).then(function(){d.passwordRestoreError=!1,d.feedBack=k.LOGIN_FORM.PASSWORD_RESTORED,i.setData("userEmail",d.formData.userName,!0),p.hideRestoreBlock=h(function(){d.passwordRestoreIntent=!1,d.isRestore=!1},j.HIDE.RESTORE_PASSWORD_BLOCK.DELAY)},function(a){e.error("Error while restoring password: ",a)})["finally"](function(){d.passwordRestoreResultReceived=!0})},d.setRestore=function(a){a.preventDefault(),a.stopPropagation(),d.passwordRestoreIntent=!0,d.userIsExisting&&(d.isRestore=!0)},d.close=function(a){d.isRestore?(d.passwordRestoreIntent=!1,d.isRestore=!1,d.loginError=!1):b.dismiss("cancel"),a.preventDefault()},d.showpassword=function(a){o.togglePasswordDisplay(a)},d.$on(l.SCOPE.DESTROY,function(){h.cancel(p.hideRestoreBlock)})}]),a.controller("navigationController",["userAuth","$location","$scope","USER_ROLES","manageLocation","ROUTES",function(a,b,c,d,e,f){var g=this;g.currentUser=a.getCurrentUser(),g.requestAuthenticate=a.requestAuthenticate,g.resetPassword=a.resetPassword,g.logout=function(b){a.logout(),b.preventDefault()},g.isAdmin=function(){return null!=g.currentUser.value&&g.currentUser.value.roles.indexOf(d.ADMIN)!=-1},c.isPartnerPage=function(){return e.isCurrentLocation(f.PARTNER)}}])}(),function(){"use strict";var a=angular.module("publicNavigation");a.directive("handleModal",["EVENTS","$document","$timeout","KEYBOARD",function(a,b,c,d){return{restrict:"A",scope:{username:"=",isRestore:"=",close:"&closeAction"},link:function(e,f){e.$on(a.LOGIN_MODAL.FIND_INVALID_ITEMS,function(){e.findInvalidFields()}),e.$watch("isRestore",function(a){!a&&e.username&&e.findInvalidFields()}),e.findInvalidFields=function(){e.focusInvalidEl=c(function(){f.find("input.ng-invalid").first().focus()})},f.find(".restore-password-link").on(a.ELEMENT.CLICK,function(){e.username||e.findInvalidFields()}),f.find("input").on(a.ELEMENT.KEYPRESS,function(a){var b=this;a.keyCode===d.ENTER&&(b.blur(),e.findInvalidFields())}),e.closeModal=function(a){var b=angular.element(".modal");b.hasClass("in")&&!b.has(a.target).length&&(e.hideRestoreBlock=c(function(){e.close({$event:a})}))},b.on(a.ELEMENT.CLICK,e.closeModal),e.$on(a.SCOPE.DESTROY,function(){c.cancel(e.focusInvalidEl),c.cancel(e.hideRestoreBlock),b.off(a.ELEMENT.CLICK,e.closeModal)})}}}])}(),function(){"use strict";angular.module("registry",[])}(),function(){"use strict";var a=angular.module("registry");a.constant("USER_ROLES",{USER:"ROLE_USER",ADMIN:"ROLE_ADMIN"})}(),function(){"use strict";var a=angular.module("registry");a.constant("ANALYTICS",{YANDEX_METRIKA:{COUNTER:"yaCounter34477675"}})}(),function(){"use strict";var a=angular.module("registry");a.constant("HTTP_HEADERS",{ACCEPT:{NAME:"Accept",VALUES:{JSON:"application/json"}}})}(),function(){"use strict";var a=angular.module("registry");a.constant("HTTP_STATUSES",{OK:200,CREATED:201,NO_CONTENT:204,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,INTERNAL_SERVER_ERROR:500})}(),function(){"use strict";var a=angular.module("registry");a.constant("DEBUG",{LOG_MODE_ENABLED:!0}).constant("INSURER_MINIMAL_AGE",18).constant("PARTICIPANT_MAX_AGE",100).constant("MONTH_PER_YEAR",12).constant("CALCULATION_RESULTS_TIMEOUT",18e4).constant("MAX_SYMBOLS",62).constant("CACHE_ITEMS",{INSURANCE_CHOICE:"insurance-choice",ORDER_PREVIEW:"order-preview",ORDER_DRAFT:"order-draft",COMPARED_POLICIES:"comparedPolicies",TRIP_FORM:"trip-form",ORDER_STATUS:"orderStatus"}).constant("COMPARE_ITEMS",{MAXIMUM_QUANTITY:99}).constant("TIMEOUT",{ORDER_PREVIEW:6e4,CALCULATION:5e3}).constant("HEADERS",{CALCULATION_STATUS_HEADER:{NAME:"x-rm-calculation-status",VALUE:"completed"}}).constant("PATH_SEPARATOR","/").constant("DATE_FORMAT","dd.MM.yyyy").constant("SELECTABLE_ITEMS",{TRIP_FORM_ITEMS_LIMIT:8,MAIN_PAGE_TRIP_ITEMS_LIMIT:3}).constant("DEFAULT_PARTNER","ghost").constant("INSURANCE_PERIOD",{MIN:1,MAX:365})}(),function(){"use strict";var a=angular.module("registry");a.constant("EVENTS",{ROUTE:{CHANGE_START:"$routeChangeStart",CHANGE_SUCCESS:"$routeChangeSuccess",CHANGE_ERROR:"$routeChangeError"},SCOPE:{DESTROY:"$destroy"},ELEMENT:{FOCUS:"focus",FOCUSIN:"focusin",FOCUSOUT:"focusout",CLICK:"click",MOUSEDOWN:"mousedown",MOUSEOVER:"mouseover",KEYPRESS:"keypress",KEYDOWN:"keydown",INPUT:"input",BLUR:"blur"},LOGIN:{OPEN_LOGIN_FORM:"$openLoginForm",DESTROY:"$destroy",LOGIN:"onlogin",LOGOUT:"onlogout"},SEARCH_RESULTS_FILTER:{RELEVANT_ITEMS_REPORT_READY:"relevantItemsReportCompleted"},LOGIN_MODAL:{FIND_INVALID_ITEMS:"findInvalidItems"},WINDOW:{RESIZE:"resize",MESSAGE:"message",ONBEFOREONLOAD:"onbeforeunload"},WIDGET:{SET_DEFAULT_VALUE:"widgetSetDefaultValue",ADJUST_SIZE:"adjustWidgetSize",BLOCK:"blockWidget"},SCROLL:{REGULAR:"scroll",SCROLL_OVERLAY:"scrollOverlay"},USER_ACTIONS:{LOGIN:"UserLogin",LOGOUT:"UserLogout"},PAGE_TITLE:"PAGE_TITLE",REMEMBER_ME:"REMEMBER_ME",PARTICIPANTS_CONTROL:{PASS_DATA:"passParticipantData"},SEARCH_RESULT_ITEM:{UPDATE_ITEMS:"updateFilteredPolicyItems",UPDATE_COMPARED_ITEMS:"updateComparedItemsNum",POLICY_ITEM_ADDED_FOR_COMPARE:"policyItemAddedForCompare"},BLOCK_DYNAMIC_RESIZE:{RESET_DUMMY:"blockDynamicResizeResetDummy"},LOCATION:{CHANGE_START:"$locationChangeStart"}})}(),function(){"use strict";var a=angular.module("registry");a.constant("ORDER_STATUSES",{ORDER_DONE:{TITLE:"Заказ завершен"},DUMMY_ORDER:{},PAYMENT_FAILED:{TITLE:"Оплата не прошла!",FULL_DESCRIPTION:"К сожалению, полис не оформлен. Но вы можете завершить покупку, перейдя в личный кабинет."},INSURANCE_SERVICE_UNAVAILABLE:{TITLE:"Сервер страховщика не доступен!",FULL_DESCRIPTION:"К сожалению, в настоящий момент оформить полис компании &quot;${company_name}&quot;<br/>нельзя по техническим причинам.",SUGGESTIONS:"Пожалуйста, выберите предложение другого страховщика."},PAYMENT_MICROSERVICE_UNAVAILABLE:{TITLE:"Платежный сервис временно не доступен!",FULL_DESCRIPTION:"К сожалению, в настоящий момент по техническим причинам мы не можем сделать перенаправление на платежный сервис.",SUGGESTIONS:"Вы можете вернуться к оплате позже через личный кабинет."},DRAFT_FAILED:{TITLE:"Черновик полиса не создан!",FULL_DESCRIPTION:"К сожалению, в настоящий момент по техническим причинам оформить этот полис нельзя.",SUGGESTIONS:"Вы можете приобрести другой полис."},SOMETHING_GOES_WRONG:{TITLE:"Ошибка!",FULL_DESCRIPTION:"К сожалению, в настоящий момент что-то пошло не так, причина выясняется.",SUGGESTIONS:"Вы можете продолжить работу с сервисом с главной страницы или через личный кабинет."},CALCULATION_NOT_FOUND:{TITLE:"Расчёт не найден!",FULL_DESCRIPTION:"К сожалению, расчёт устарел.",SUGGESTIONS:"Вы можете вернуться на страницу выбора страховки и обновить предложения."}})}(),function(){"use strict";var a=angular.module("registry");a.constant("MACROS",{COMPANY_NAME_MACRO:"${company_name}"})}(),function(){"use strict";var a=angular.module("registry");a.constant("MODULES",{MAIN_PAGE:{FOLDER:"main-page",CONTROLLERS:{MAIN_PAGE:"MainPageController"},TEMPLATES:{MAIN_PAGE:"main-page.html",ABOUT_PAGE:"about_page.html"}},INNER_PAGES:{FOLDER:"inner-pages",CONTROLLERS:{TERMS_PAGE:"TermsPageController"},TEMPLATES:{ABOUT_SERVICE_PAGE:"about-service-page.html",CONTACTS_PAGE:"contacts-page.html",TERMS_PAGE:"terms-page.html"}},SEARCH_RESULTS:{FOLDER:"search-results",CONTROLLERS:{SEARCH_RESULTS:"SearchResultsController",SEARCH_RESULT_ITEM_CONTROLLER:"searchResultItemCtrl"},TEMPLATES:{SEARCH_RESULTS:"search-results.html",SEARCH_QUERY:"search-query.html",SEARCH_FILTER:"search-filter.html"}},TRIP_FORM:{FOLDER:"trip-form",CONTROLLERS:{TRIP_FORM:"TripFormController"},TEMPLATES:{TRIP_FORM:"trip-form.html"}},ORDER_PREPARE:{FOLDER:"order-prepare",CONTROLLERS:{ORDER_PREPARE:"OrderPrepareController"},TEMPLATES:{ORDER_PREPARE:"order-prepare.html"}},ORDER_PAYMENT:{FOLDER:"order-payment",CONTROLLERS:{ORDER_PAYMENT:"OrderPaymentController"},TEMPLATES:{ORDER_PAYMENT:"order-payment.html"}},ORDER_RESULT:{FOLDER:"order-result",CONTROLLERS:{ORDER_DONE:"OrderDoneController",ORDER_FAIL:"OrderFailController"},TEMPLATES:{ORDER_DONE:"order-done.html",ORDER_FAIL:"order-fail.html"}},PRIVATE_OFFICE:{FOLDER:"private-office",CONTROLLERS:{PRIVATE_OFFICE:"privateOfficeController"},TEMPLATES:{PRIVATE_OFFICE:"private-office.html"}},UTILS:{FOLDER:"utils",CONTROLLERS:{PARTICIPANTS_CONTROL:"participantsControlCtrl"}},ADMIN_MONITOR:{FOLDER:"admin/monitor",CONTROLLERS:{ADMIN_MONITOR:"adminMonitorController"},TEMPLATES:{ADMIN_MONITOR:"monitor.html"}},PARTNER:{FOLDER:"partner",CONTROLLERS:{PARTNER_CONTROLLER:"PartnerController"},TEMPLATES:{PARTNER_TRADES:"partner-trades.html"}},PARTNER_LOGIN:{FOLDER:"partner-login",CONTROLLERS:{PARTNER_LOGIN:"partnerLoginController"},TEMPLATES:{PARTNER_LOGIN:"partner-login.html"}},COMPARE_POLICIES:{FOLDER:"compare-policies",CONTROLLERS:{COMPARE_POLICIES:"ComparePoliciesController"},TEMPLATES:{COMPARE_POLICIES:"compare-policies.html"}}})}(),function(){"use strict";var a=angular.module("registry"),b="https://riskmarket-dev.sidenis.local",c=b+"/internal";a.constant("REST_API",{SITE:b,INSURANCE_CALCULATOR:c+"/calculations/",ORDER_DRAFT:c+"/order",ORDER_PURCHASE:c+"/payment/link",LOGIN:c+"/login",LOGOUT:c+"/logout",PING:c+"/ping/",AUTHENTICATION:b+"internal",PARTNER:c+"/admin/monitor/partner_info",USER:c+"/current/user",USER_ACCOUNT:c+"/current/user/personal/account",NEW_PASSWORD:c+"/new/password",COUNTRIES_LIST:c+"/dictionary/countries",RISK_FILTERS:c+"/dictionary/risk_filters",RISK_OPTIONS:c+"/dictionary/special_terms/",LATEST_BOUGHT_POLICY_DOWNLOAD:c+"/downloads/bought/latest/policy",PERSONAL_DATA_AGREEMENT:c+"/downloads/license/agreement",INSURANCE_COMPANIES:c+"/dictionary/insurance-service-providers",ASSISTANCE_COMPANIES:c+"/dictionary/assistance-companies",INSURED_DAYS:c+"/dictionary/insured-days",INSURANCE_TYPES:c+"/dictionary/insurance-types",PRIVATE_OFFICE:{POLICIES_LIST:c+"/private_office/all",REMOVE_POLICY:c+"/private_office/policy"},ADMIN_MONITOR:{POLICIES:c+"/admin/monitor",CSV:c+"/admin/monitor/csv",EXCEL:c+"/admin/monitor/excel"},CURRENCIES_SUM:c+"/util/medical/expenses/currencies/and/sums/mappings",CURRENT_TIME:c+"/time",PAYMENT_PROCESS_STARTED:c+"/payment/process/started",DRAFT_CREATE:c+"/drafts"})}(),function(){"use strict";var a=angular.module("registry");a.constant("ROUTES",{MAIN_PAGE:"/",SEARCH_RESULTS:"/search-results",ORDER_PREPARE:"/order-prepare",ORDER_PAYMENT:"/order-payment",ORDER_DONE:"/order-done",ORDER_FAIL:"/order-fail",PRIVATE_OFFICE:"/private-office",ADMIN_MONITOR:"/admin.monitor",ABOUT:"/about",CONTACTS:"/contacts",TERMS:"/terms",PARTNER:"/partner",PARTNER_LOGIN:"/partner-login",COMPARE_POLICIES:"/compare-policies"})}(),function(){"use strict";var a=angular.module("registry");a.constant("STRUCTURE",{MODULES:"modules",CONTROLLERS:"controllers",CONSTANTS:"constants",SERVICES:"services",PROVIDERS:"providers",FACTORIES:"factories",TEMPLATES:"partials",DOWNLOADS:"downloads"})}(),function(){"use strict";var a=angular.module("registry");a.constant("TEXT_LABELS",{INSURANCE_DOCUMENT:{MULTIPLE:"Многократная",SINGLE:"Однократная"},SELECTABLE_ITEMS:{COUNTRIES:{INTERACTIVE_BTN:"Карта",TIPS_LABEL:"Например:",TIPS:["Весь мир","Шенген","Финляндия"]}},TOOLTIPS:{COMPARED_ITEM:{ADD:"Добавить к сравнению",REMOVE:"Убрать из сравнения"}}})}(),function(){"use strict";var a=angular.module("registry");a.constant("BUSINESS_ENTITIES",{MAIN_PAGE:"main-page",TEXT_PAGE:"text-page",TRIP_FORM:"trip-form",SEARCH_RESULTS:"search-results",ORDER_PREPARE:"order-prepare",ORDER_PAYMENT:"order-payment",ORDER_DONE:"order-done",ORDER_FAIL:"order-fail",PRIVATE_OFFICE:"private-office",ABOUT_PAGE:"about-page",CONTACTS_PAGE:"contacts-page",TERMS_PAGE:"terms-page",PARTNER:"partner",PARTNER_LOGIN:"partner-login",COMPARE_POLICIES:"compare-policies"})}(),function(){"use strict";var a=angular.module("registry");a.constant("PAGE_BG_RANDOM",{IMG_FOLDER:"img/min/background-collection/",IMG_QUANTITY:4})}(),function(){"use strict";var a=angular.module("registry");a.constant("PAGE_META",{DEFAULT:{TITLE:"RiskMarket - сервис онлайн страхования и надёжного хранения полисов"},TERMS_PAGE:{TITLE:"Пользовательское соглашение РискМаркета"}})}(),function(){var a=angular.module("registry");a.constant("REGEXP",{YANDEX_WEBVISOR_FRAME_URL_FRAGMENT:/yandex\.net/i,EMAIL:/^[\w\.\-\\']+@[\w\-]+(?:(?:\.[\w\-]+)?){1,}\.[a-z]{2,6}$/i,NUMBER:/^\d+$/,ALLOWED_STATE_FOR_RAW_NAME:/^[a-z]+(?:([\s\'\-])(?!\1)(?:[a-z]+)?)?(?:\1(?!\1)(?:[a-z]+)?)?$/i,ALLOWED_STATE_FOR_RESULT_NAME:/^[a-z]{1,15}((?:\'|\-|\s)?[a-z]{0,15}){1,2}[a-z]{1,15}$/i,DURATION_MEASURE_UNIT:/ms/i})}(),function(){"use strict";var a=angular.module("registry");a.constant("UX",{SCROLLING:{TIME:500,EASING:"swing",DEFAULT_TOP_SCROLLING:0,AUTO_SCROLLING_DURATION_ON_SEARCH_RESULT_PAGE:300},HIDE:{RESTORE_PASSWORD_BLOCK:{DELAY:5e3}}})}(),function(){var a=angular.module("registry");a.constant("KEYBOARD",{ESC:27,ENTER:13,SPACE:32,ZERO:48,NINE:57,ARROW_UP:38,ARROW_DOWN:40,TAB:9})}(),function(){"use strict";var a=angular.module("registry");a.constant("CURRENCY_SYMBOLS",{USD:"$",EUR:"€",RUB:"a"})}(),function(){"use strict";var a=angular.module("registry");a.constant("SEARCH_RES_ICONS",{ALL_PARAMS_ICON:"img/min/search-result/arrow-down.png"}),a.constant("VENDOR_LOGO",{CLASS:"img/min/search/class-assistance.png"})}(),function(){"use strict";var a=angular.module("registry");a.constant("TERRITORY_BLOCK",{MAX_SYMBOLS:62,ITEM_SUGGESTION_HEIGHT:30})}(),function(){"use strict";var a=angular.module("registry");a.constant("LOCALES",{RU:"ru-Latn"})}(),function(){"use strict";var a=angular.module("registry");a.constant("POLICY_STRUCTURE",{TYPES:{ANY:{categoryLabel:"Все полисы",priority:0,serviceLabel:"any",showItemsQuantity:!1},DRAFT:{categoryLabel:"Черновики",itemLabel:"Черновик",priority:3,compositionPriority:1,actionLabel:"Оформить",serviceLabel:"draft",showItemsQuantity:!1},PAID:{categoryLabel:"Действующие",itemLabel:"Действует",priority:2,compositionPriority:1,actionLabel:"Скачать",serviceLabel:"paid",showItemsQuantity:!1},PAYMENT_PENDING:{categoryLabel:"Ожидающие оплаты",itemLabel:"Ожидает оплаты",priority:1,compositionPriority:0,serviceLabel:"payment-pending",actionLabel:"Оплатить",showItemsQuantity:!0}},POLICY_FIELDS:{TYPE:"status"}})}(),function(){"use strict";var a=angular.module("registry");a.constant("USER_TYPES",{CLIENT:"CLIENT",PARTNER:"PARTNER",ADMIN:"ADMIN"})}(),function(){"use strict";var a=angular.module("registry");a.constant("WARNINGS",{LOGIN_FORM:{USER_NOT_FOUND:"Пользователя с таким email не существует",LOGIN_ERROR:"Неверный логин или пароль",PASSWORD_RESTORED:"На указанный email выслан новый пароль"}})}(),function(){"use strict";var a=angular.module("registry");a.constant("MASKS",{DATE:{EMPTY:"__.__.____",DEFAULT:"дд.мм.гггг"}})}(),function(){"use strict";var a=angular.module("registry");a.constant("INSURANCE_COMPANIES",{VTB:{LABEL:"VTB"},ALFA:{LABEL:"ALFA"}})}(),function(){"use strict";var a=angular.module("registry");a.constant("TRUSTED_ORIGINS",{AKANO:"https://www.akano.ru","SPRINT.AKANO":"https://sprint.akano.ru",RAVTA:"https://ravta.ru",DEV:"https://riskmarket-dev.sidenis.local",QA:"https://riskmarket-qa.sidenis.local",TRAIN:"https://riskmarket-train.sidenis.local",TEST:"https://test.riskmarket.ru",SIDENIS:"https://riskmarket.sidenis.com",RISKMARKET:"https://riskmarket.ru"})}(),function(){"use strict";var a=angular.module("registry");a.constant("VENDOR_COMPANIES",{CLASS_ASSISTANCE:"class-assistance",SAVITAR_GROUP:"savitar-group",GVA:"gva",AP_COMPANIES:"ap-companies"})}(),function(){"use strict";var a=angular.module("registry");a.constant("ANIMATED_CLASSES",["search-result-params","search-result-container","btn-nav","restore","filter-container","policy-item"])}(),function(){"use strict";var a=angular.module("registry"),b="../img/min";a.constant("PICTURE_PATH_TEMPLATES",{vendorCompany:{path:b+"/search",ext:"png"}})}(),function(){"use strict";angular.module("utils",[])}(),function(){"use strict";var a=angular.module("utils");a.directive("classAt",["EVENTS",function(a){return{restrict:"A",link:function(b,c,d){var e=b.$eval(d.classAt),f={getClasses:function(){return Object.keys(e)},setMatchedClasses:function(a){var b=this.getClasses();c.removeClass(b.join(" "));var d=a.businessEntity,f=b.map(function(a){return e[a].indexOf(d)!==-1?a:""});c.addClass(f.join(" "))}};b.$on(a.ROUTE.CHANGE_SUCCESS,function(a,b){f.setMatchedClasses(b)})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("smartSticky",["$window","$timeout",function(a,b){return{restrict:"A",scope:{disabled:"=disabledSticky"},link:function(c,d,e){function f(){w=c.calculateStickyContentInitialDimensions(),M&&(d[0].getBoundingClientRect().height||(v=c.$watch(function(){return d.height()},function(a,b){a>0&&(w=c.calculateStickyContentInitialDimensions(),N||v())})))}function g(b){var c=h(y,b);return 1===c.length?c[0]:a}function h(a,b){var c,d=[],e=b.parent();do{var f=e[0];if(1!==f.nodeType)break;if(f.tagName.toUpperCase()===a.toUpperCase())return e;c=e.parent(),e=c}while(0!==c.length);return d}function i(b){return"true"===b&&a.innerHeight-(d[0].offsetHeight+parseInt(P))<0}function j(a,b,c){var d="top",e=Math.abs(a-b),f=Math.abs(a-c);return e>f&&(d="bottom"),d}function k(a){d.attr("style",Q),A=!1,I.removeClass(D),d.removeClass(B),d.addClass(C),"top"===a?(d.removeClass(E),d.css("z-index",10).css("width",d[0].offsetWidth).css("top",w.top).css("position",w.position).css("left",w.cssLeft).css("margin-top",w.marginTop).css("height",w.height)):"bottom"===a&&L===!0&&(d.addClass(E),m(),d.css("z-index",10).css("width",d[0].offsetWidth).css("top","").css("bottom",0).css("position","absolute").css("left",w.cssLeft).css("margin-top",w.marginTop).css("margin-bottom",w.marginBottom).css("height",w.height)),t&&a===K&&t.remove()}function l(a){A=!0,b(function(){w.offsetWidth=d[0].offsetWidth},0),I.addClass(D),d.removeClass(C),d.removeClass(E),d.addClass(B),m(),d.css("z-index","10").css("width",d[0].offsetWidth+"px").css("position","fixed").css("left",d.css("left").replace("px","")+"px").css(K,P+o(F)+"px").css("margin-top",0),"bottom"===K&&d.css("margin-bottom",0)}function m(){J&&(t&&t.remove(),t=angular.element("<div>"),t.css("height",d[0].offsetHeight+"px"),d.after(t))}function n(){return!!(L&&p()>z)}function o(a){var b=0;return a.getBoundingClientRect&&(b=a.getBoundingClientRect().top),b}function p(){var a;return a="undefined"!=typeof F.scrollTop?F.scrollTop:"undefined"!=typeof F.pageYOffset?F.pageYOffset:document.documentElement.scrollTop}function q(){var b;return b=H[0]instanceof HTMLElement?a.getComputedStyle(H[0],null).getPropertyValue("height").replace(/px;?/,""):a.innerHeight,parseInt(b)||0}function r(){var b=e.mediaQuery||!1,c=a.matchMedia;return b&&!(c("("+b+")").matches||c(b).matches)}var s,t,u,v,w,x,y="sticky-scroll",z=0,A=!1,B=e.stickyClass||"",C=e.unstickyClass||"",D=e.bodyClass||"",E=e.bottomClass||"",F=g(d),G=angular.element(a),H=angular.element(F),I=angular.element(document.body),J="false"!==e.usePlaceholder,K="bottom"===e.anchor?"bottom":"top",L="true"===e.confine,M=void 0!==e.isStickyLayoutDeferred&&"true"===e.isStickyLayoutDeferred,N=void 0===e.isStickyLayoutWatched||"true"===e.isStickyLayoutWatched,O=d.css("position"),P=e.offset?parseInt(e.offset.replace(/px;?/,"")):0,Q=d.attr("style")||"",R=function(){H.on("scroll",S),G.on("resize",c.$apply.bind(c,U)),f(),c.$watch(V,W),c.$on("$destroy",T)},S=function(){if(c.disabled===!0||r())return A&&k(),!1;var a,b=p();a="top"===K?L===!0?b>s&&b<=z:b>s:b<=s;var f=j(b,s,z);!a||i(e.stickLimit)||A?!a&&A?k(f,b):L&&!a&&(u=o(d[0]),k(f,b)):l(f)},T=function(){H.off("scroll",S),G.off("resize",U),I.removeClass(D),t&&t.remove()},U=function(){k(K),S()},V=function(){return c.disabled===!0?k():"top"===K?(u||o(d[0]))-o(F)+p():o(d[0])-q()+d[0].offsetHeight+p()},W=function(a,b){if(!(a===b&&"undefined"!=typeof s||A||n()||0===a)){s=a-P,L&&d.parent().css({position:"relative"});var c=d.parent()[0],e=parseInt(c.offsetHeight)-(J?0:d[0].offsetHeight),f=parseInt(d.css("margin-bottom").replace(/px;?/,""))||0,g=o(d[0]),h=o(c),i=o(F),j=g-i,k=h+e-g;z=j+k-d[0].offsetHeight-f-P+ +p(),S()}};c.getElement=function(){return d},c.getScrollbar=function(){return F},c.getInitialCSS=function(){return w},c.getAnchor=function(){return K},c.isSticking=function(){return A},c.getOriginalInitialCSS=function(){return x},c.processUnStickElement=function(a){k(a)},c.processCheckIfShouldStick=function(){S()},c.calculateStickyContentInitialDimensions=function(){return{zIndex:d.css("z-index"),top:d.css("top"),position:O,marginTop:d.css("margin-top"),marginBottom:d.css("margin-bottom"),cssLeft:d.css("left"),height:d.css("height")}},c.updateStickyContentUpdateDimensions=function(a,b){a&&b&&(w.width=a+"px",w.height=b+"px")},b(function(){x=c.calculateStickyContentInitialDimensions(),R()},0)},controller:["$scope","$window",function(a,b){this.resetLayout=function(c,d){function e(){"top"===h&&(f===b?b.scrollTo(0,0):f.scrollTop>0&&(f.scrollTop=0))}var f=a.getScrollbar(),g=a.getInitialCSS(),h=a.getAnchor();if(a.isSticking()&&(a.processUnStickElement(h),a.processCheckIfShouldStick()),a.getElement().css({width:"",height:"",position:"",top:"",zIndex:""}),g.position=a.getOriginalInitialCSS().position,delete g.offsetWidth,void 0===c&&void 0===d){var i=a.getElement()[0].getBoundingClientRect();c=i.width,d=i.height}a.updateStickyContentUpdateDimensions(c,d),e()},this.getScrollbar=function(){return a.getScrollbar()}}]}}]),window.matchMedia=window.matchMedia||function(){var a="angular-sticky: This browser does not support matchMedia, therefore the minWidth option will not work on this browser. Polyfill matchMedia to fix this issue.";return window.console&&console.warn&&console.warn(a),function(){return{matches:!0}}}()}(),function(){"use strict";var a=angular.module("utils");a.directive("dummyLink",function(){return{restrict:"A",link:function(a,b){b.on("click",function(a){a.stopPropagation(),a.preventDefault()})}}})}(),function(){"use strict";var a=angular.module("utils");a.directive("mainPageBgRandom",["PAGE_BG_RANDOM",function(a){return{restrict:"A",link:function(b,c){var d=a.IMG_FOLDER+Math.floor(Math.random()*a.IMG_QUANTITY)+".jpg";c.css("background-image","url("+d+")")}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("popoverClose",["EVENTS",function(a){return{scope:{excludeClass:"@"},link:function(b,c){function d(a){var b=$(a.target);b.hasClass("close-popover-btn")?b.closest(".popover").siblings("[data-popover-elem]").first().click():b.hasClass("trigger")||b.parents().hasClass(e)||$(".trigger").click().removeClass("trigger")}var e="exclude";c.on("click",d),b.$on(a.SCOPE.DESTROY,function(){c.off("click",d)})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("popoverElem",["EVENTS",function(a){return{link:function(b,c){function d(){c.toggleClass("trigger").siblings(".popover").addClass("exclude")}c.on("click",d),b.$on(a.SCOPE.DESTROY,function(){c.off("click",d)})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("focusStyling",function(){return{link:function(a,b,c){var d=a.$eval(c.focusStyling);b.focusin(function(){$(this).addClass(d["class"])}),b.focusout(function(){$(this).removeClass(d["class"])})}}})}(),function(){"use strict";var a=angular.module("utils");a.directive("imgSvg",["$http",function(a){return{restrict:"A",link:function(b,c,d){var e=d.src,f=function(a,b){var c=$.parseXML(a),d=$(c).find("svg"),e=b.attr("class");return"undefined"!=typeof e&&d.attr("class",e),d};a.get(e,{"Content-Type":"application/xml"}).then(function(a){c.replaceWith(f(a.data,c))})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("inputMask",function(){return{restrict:"A",require:"ngModel",scope:{model:"=ngModel",pattern:"@ngPattern"},link:function(a,b,c,d){b.on("input",function(a){var d=b.val(),e=d.length,f=c.inputMask.length;if(e<f){d+c.inputMask.slice(e)}})}}})}(),function(){"use strict";var a=angular.module("utils"),b=/^[A-Z a-z\-']+$/;a.directive("latinLetters",function(){return{restrict:"A",require:"ngModel",link:function(a,c,d,e){e.$validators.latinLetters=function(a,c){return e.$isEmpty(a)||b.test(c)}}}})}(),function(){"use strict";var a=angular.module("utils");a.directive("nameValidation",["EVENTS","$log","REGEXP",function(a,b,c){return{restrict:"A",require:"ngModel",link:function(d,e,f,g){var h,i,j,k=function(a){if(j=a.target.selectionStart,h=e.val(),h===i)return void b.warn("Name validation. Previous value and current value are the same. Doing nothing");var d=c.ALLOWED_STATE_FOR_RAW_NAME.test(h);d?(h=h.toUpperCase(),i=h):(h?h=i:i="",j--),g.$setViewValue(h),g.$modelValue=g.$viewValue,g.$render(),a.target.selectionEnd=j},l=function(){i=e.val()},m=function(){h&&(g.$setViewValue(h.trim()),g.$setValidity("nameValidation",c.ALLOWED_STATE_FOR_RESULT_NAME.test(g.$viewValue)),g.$modelValue=g.$viewValue,g.$render(),d.$apply())};e.on(a.ELEMENT.FOCUS,l).on(a.ELEMENT.INPUT,k).on(a.ELEMENT.BLUR,m),d.$on(a.SCOPE.DESTROY,function(){e.off(a.ELEMENT.INPUT,k).off(a.ELEMENT.FOCUS,l).off(a.ELEMENT.BLUR,m)})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("lazySubmit",["frameManager",function(a){return{restrict:"A",link:function(b,c,d){a.isAppInFrameMode()||d.$observe("lazySubmit",function(a){var d=b.$eval(a);!!d&&c.submit()})}}}])}(),function(){"use strict";var a=angular.module("utils");a.controller("participantsControlCtrl",["$scope","$dateParser","EVENTS","KEYBOARD","DATE_FORMAT","PARTICIPANT_MAX_AGE",function(a,b,c,d,e,f){function g(a){a.touched=!0}function h(){return a.participants.reduce(function(a,b){return a+(!!b.isValid&&!!b.birthDate&&b.touched)},0)}function i(a){var b="турист",c="";switch(a){case 0:c="Кто едет";break;case 1:c=a+" "+b;break;case 2:case 3:case 4:c=a+" "+b+"а";break;case 5:c=a+" "+b+"ов"}return c}function j(){a.participantsQuantity=h(),a.totalPassengersLabel=i(a.participantsQuantity)}a.showControls=!1,a.touched=!1,a.isParticipantAgeAllowed=!0,a.participants.length||a.participants.push({birthDate:void 0,touched:!1,isValid:!1}),a.addParticipant=function(){a.participants.push({birthDate:void 0,touched:!1,dirty:!1,isValid:!0})},a.removeParticipant=function(b){a.participants.splice(b,1),a.checkParticipants(a.participants)},a.totalPassengersLabel="Кто едет",a.checkEachParticipant=function(b){b.forEach(a.checkBirthDate)},a.checkParticipants=function(b){a.checkEachParticipant(b),a.isValid=b.every(function(b){return a.checkBirthDate(b)}),j()},a.checkBirthDate=function(d){var g=b(d.birthDate,e)<new Date;return a.isParticipantAgeAllowed=!0,g&&(a.isParticipantAgeAllowed=b(d.birthDate,e).getFullYear()>=(new Date).getFullYear()-f,a.$emit(c.PARTICIPANTS_CONTROL.PASS_DATA,a.isParticipantAgeAllowed)),d.isValid=!d.touched||g&&a.isParticipantAgeAllowed,
d.isValid},a.onBirthDateInput=function(b,c){g(a),g(c),null!=c.birthDate&&(c.dirty=!0),a.checkParticipants(a.participants),b.which===d.ENTER&&a.isValid&&(a.showControls=!1)},a.mask={blur:"дд.мм.гггг",focus:"__.__.____"},a.currentMask=a.mask.blur,a.lazyUpdate||j()}]),a.directive("participantsControl",["$document","EVENTS","KEYBOARD",function(a,b,c){return{scope:{isValid:"=",participants:"=",maxParticipantCount:"=",lazyUpdate:"="},controller:"participantsControlCtrl",templateUrl:"modules/utils/directives/participants-control/partials/participants-control.html",link:function(d,e){var f={participantControlPopupAdd:e.find(".participants-control-popup-add")};d.togglePopup=function(){d.showControls=!d.showControls},d.handleOuterClick=function(a){var b=!!e.find($(a.target)).length;b||(d.showControls=b,d.$digest())},d.tabHandler=function(a){a.keyCode===c.TAB&&d.handleOuterClick({target:""})},d.blockPropagation=function(a){a.stopPropagation()},a.on(b.ELEMENT.MOUSEDOWN,d.handleOuterClick),f.participantControlPopupAdd.on(b.ELEMENT.KEYDOWN,d.tabHandler);var g=d.$on(b.SCOPE.DESTROY,function(){a.off(b.ELEMENT.MOUSEDOWN,d.handleOuterClick),f.participantControlPopupAdd.off(b.ELEMENT.KEYDOWN,d.tabHandler),g()})}}}])}(),function(){"use strict";var a=angular.module("utils");a.controller("periodControlCtrl",["$scope","$window","$dateParser","dateFilter","DATE_FORMAT","INSURANCE_PERIOD","$timeout",function(a,b,c,d,e,f,g){a.dateType={preview:"preview",start:"start",finish:"finish"},a.overdueType={before:"before",after:"after"};var h=new Date;h.setHours(0,0,0,0);var i=new Date;i.setDate(h.getDate()+f.MAX),i.setHours(0,0,0,0);var j=c(a[a.dateType.start],e)||h;a.formData={type:a.dateType.preview,month:j.getMonth(),year:j.getFullYear(),grid:0,show:{popup:!1},valid:{start:!0,finish:!1}},a.helpers={getOffsetDayArray:function(a,b){var c=[],d=new Date(a,b,1).getDay();for(d=0==d?6:d-1;d;)c[--d]=d;return c},getOverdueDayCount:function(b,c,d,e,g,h,i){var j=0;switch(i){case a.overdueType.after:new Date(b,c,g.getDate())>=g?j=b==g.getFullYear()&&c==g.getMonth()?g.getDate()-f.MIN:0:h==a.dateType.finish&&new Date(b,c,g.getDate())<g&&(j=b==g.getFullYear()&&c==g.getMonth()?g.getDate():d);break;case a.overdueType.before:new Date(b,c,0)<e&&(j=b==e.getFullYear()&&c==e.getMonth()?e.getDate()-1:d)}return j},getOverdueType:function(b){var c=i.getTime()-b.getTime(),d=Math.ceil(c/864e5);return d>0?a.overdueType.before:a.overdueType.after},fillCalendar:function(b,c){var d=0;switch(b.overdueType){case a.overdueType.after:for(b.overdue=new Array(c-b.overdue.length);d<b.overdue.length;d++)b.overdue[d]=c-b.overdue.length+d+1;for(var e=0;d<c;e++,d++)b.actual[e]={index:e+1,select:!1};break;case a.overdueType.before:for(;d<b.overdue.length;d++)b.overdue[d]=d+1;for(var e=0;d<c;e++,d++)b.actual[e]={index:d+1,select:!1}}},setCalendarSelection:function(b,c,d,e){if(null!=e&&e.getFullYear()==d&&e.getMonth()==c)switch(b.overdueType){case a.overdueType.after:b.actual[e.getDate()-1].select=!0;break;case a.overdueType.before:var f=e.getDate()-b.overdue.length-1;f>=0&&(b.actual[f].select=!0)}}},a.events={notInPreviewMode:function(){var b=c(a[a.dateType.start],e),d=c(a[a.dateType.finish],e);return"preview"!=a.formData.type||null!=b||null!=d},checkPreviewMode:function(){var b=c(a[a.dateType.start],e),d=c(a[a.dateType.finish],e);null==b&&null==d&&g(function(){a.formData.type="preview"},0)},updatePopup:function(b){var d=c(a[b],e)||c(a.start,e)||h,f=a.formData.month==d.getMonth();a.formData.year=d.getFullYear(),a.formData.month=d.getMonth(),f&&a.events.updateGrid()},dateFieldFocus:function(b){a.formData.type=b,a.formData.show.popup=!0,a.events.updatePopup(b)},inputBtnClick:function(){var b=!a.formData.show.popup;a.events.dateFieldFocus(a.dateType.start),a.formData.show.popup=b},prevMonthClick:function(){0==a.formData.month?(a.formData.year--,a.formData.month=11):a.formData.month--},nextMonthClick:function(){11==a.formData.month?(a.formData.year++,a.formData.month=0):a.formData.month++},selectDate:function(b,f){a[a.formData.type]=d(new Date(a.formData.year,a.formData.month,b.index),e),a.events.checkDates(),a.events.updateGrid(),a.events.moveFocus(),f&&(a.formData.month=c(a[a.dateType.start],e).getMonth())},moveFocus:function(){a.formData.type==a.dateType.start?a.events.dateFieldFocus(a.dateType.finish):a.formData.type==a.dateType.finish&&g(function(){a.formData.show.popup=!1},0)},checkDates:function(){var b=c(a[a.dateType.start],e),d=c(a[a.dateType.finish],e);null!=d&&d.setDate(d.getDate()-f.MIN+2),a.formData.valid[a.dateType.finish]=d>b,a.isValid=a.formData.valid[a.dateType.start]&&a.formData.valid[a.dateType.finish]},updateGrid:function(){var b=a.formData.year,d=a.formData.month,g=new Date(h),j=new Date(i),k=new Date(b,d+1,0).getDate(),l=c(a[a.formData.type],e);a.formData.type==a.dateType.finish&&(g=c(a[a.dateType.start],e)||new Date(h),g.setDate(g.getDate()+f.MIN-1),j=new Date(g),j.setFullYear(j.getFullYear()+1));var m=a.helpers.getOverdueType(new Date(b,d,i.getDate())),n={overdueType:m,offset:a.helpers.getOffsetDayArray(b,d),overdue:new Array(a.helpers.getOverdueDayCount(b,d,k,g,j,a.formData.type,m)),actual:[]};a.helpers.fillCalendar(n,k),a.helpers.setCalendarSelection(n,d,b,l),a.formData.grid=n},outerClick:function(b){0!=angular.element(".period-control").find(b.target).length||angular.element(b.target).hasClass("period-control-popup-active-day")||(a.$apply(function(){a.formData.show.popup=!1}),a.events.checkPreviewMode(),a.shouldReactOnFocus=!0)},changePopupVisibility:function(c){c?b.addEventListener("click",a.events.outerClick):b.removeEventListener("click",a.events.outerClick)}},a.$watch("formData.month",a.events.updateGrid),a.$watch("formData.show.popup",a.events.changePopupVisibility),a.months=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],a.daysAcronyms=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],a.shouldReactOnFocus=!0}]),a.directive("periodControl",["EVENTS","KEYBOARD",function(a,b){return{scope:{start:"=",finish:"=",isValid:"="},controller:"periodControlCtrl",templateUrl:"modules/utils/directives/period-control/partials/period-control.html",link:function(c,d){c.createFocusinHandler=function(a){return function(){c.events.dateFieldFocus(a),c.$digest()}},c.focusinHandler=function(){return!!c.shouldReactOnFocus&&(c.events.dateFieldFocus(c.dateType.start),c.$digest(),c.shouldReactOnFocus=!1,void c.inputs.startDate.focus())},c.finishTabHandler=function(a){a.keyCode===b.TAB&&(c.shouldReactOnFocus||(c.shouldReactOnFocus=!0),c.events.outerClick({target:null}))},c.inputs={startDate:d.find("#startdate"),endDate:d.find("#enddate")},c.startDateFocusInHandler=c.createFocusinHandler(c.dateType.start),c.endDateFocusInHandler=c.createFocusinHandler(c.dateType.finish),d.on(a.ELEMENT.FOCUSIN,c.focusinHandler),c.inputs.startDate.on(a.ELEMENT.FOCUSIN,c.startDateFocusInHandler),c.inputs.endDate.on(a.ELEMENT.FOCUSIN,c.endDateFocusInHandler),c.inputs.endDate.on(a.ELEMENT.KEYDOWN,c.finishTabHandler);var e=c.$on(a.SCOPE.DESTROY,function(){d.off(a.ELEMENT.FOCUSIN,c.focusinHandler),c.inputs.startDate.off(a.ELEMENT.FOCUSIN,c.startDateFocusInHandler),c.inputs.endDate.off(a.ELEMENT.FOCUSIN,c.endDateFocusInHandler),c.inputs.endDate.off(a.ELEMENT.KEYDOWN,c.finishTabHandler),e()})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("selectableItems",["KEYBOARD","$filter","EVENTS","TERRITORY_BLOCK","$parse",function(a,b,c,d,e){return{restrict:"E",require:"ngModel",scope:{selection:"=ngModel",items:"="},templateUrl:"modules/utils/directives/selectable-items/partials/selectable-items.html",link:function(f,g,h){function i(b){_.includes(y,b.which)&&(b.which===a.ESC?(f.switchSuggestions(!1),b.preventDefault()):b.which===a.ARROW_UP||b.which===a.ARROW_DOWN?f.suggestions.length&&!f.enableSuggestions?f.switchSuggestions(!0):f.suggestions.length&&(b.which===a.ARROW_UP?F.decrease():F.increase()):b.which===a.ENTER&&f.suggestions.length&&(F.value<0?f.addItem(f.suggestions[0]):f.addItem(f.suggestions[F.value]),m()),f.$digest())}function j(){f.enableSuggestions||f.resetValue(p),f.$apply()}function k(a){a.originalEvent.ignore=!0}function l(a){f.suggestions.length&&!a.originalEvent.ignore&&r.is(":visible")&&(f.switchSuggestions(!1),F.reset(),f.showHideIfNothingSelected(),f.$digest())}function m(){var a=document.createDocumentFragment(),b=C(f.items,f.matchedSuggestionFilter);f.suggestions=D(b,[f.topicsFilter,f.relevantIndexFilter,f.alphabetFilter]);var c=f.suggestions;f.previousSuggestions=c,r.empty(),c.forEach(function(b,d){var e=$("<li/>",{"class":v});b.parent&&e.addClass("parent"),b.parent&&c[d+1]&&!c[d+1].parent&&e.addClass("separator");var g=F.value===d?" item-active":"",h=$("<span/>",{"class":w+g,"data-index":d});h.data(n,b);var i=E(b[f.itemLabel],p.val().trim());h.html(i),e.append(h),a.appendChild(e.get(0))}),c.length&&r.append(a)}var n="item";f.enableSuggestions=!1,f.selection=angular.isArray(f.selection)?f.selection:[];var o=e(h.params)(f.$parent);angular.forEach(o,function(a,b){f[b]=a});var p=g.find(".suggestion-input").first(),q=g.find(".selectable-items"),r=g.find(".selectable-items-suggestions"),s=g.find(".btn-trigger"),t=$(document.body),u=g.find(".items-wrapper"),v="item-container",w="item",x=f.itemLabel;f.resetValue=function(a){a.val("")},f.removeItem=function(a){f.squeezeInputArea();var b={};b[x]=a[x],_.remove(f.selection,b),f.adjustUserInputWidth(),f.showHideDefault(!f.selection.length&&!p.val()),p.removeAttr("disabled")},f.addItem=function(a){if(!f.suggestionsListIsFull()){var b=f.itemLabel,c={};c[b]=a[b];var d=!!_.find(f.selection,c);if(d)return $log.warn("Attempt to add duplicate"),!1;f.squeezeInputArea(),f.selection.push(a),f.resetValue(p),f.suggestionsListIsFull()&&p.attr("disabled","disabled"),f.switchSuggestions(!1),f.showHideDefault(!f.selection.length&&!p.val()),f.adjustUserInputWidth(),f.adjustInputOnLoad=!1}};var y=[a.ESC,a.ENTER,a.ARROW_UP,a.ARROW_DOWN];f.switchSuggestions=function(a){f.enableSuggestions=a},f.suggestionsListIsFull=function(){return f.selection.length>=f.maxItems},f.fakeInputVisible=!0,f.adjustInputOnLoad=!0,f.isFakeInputVisible=function(){return f.adjustInputOnLoad&&p.outerWidth(f.inputSize),f.fakeInputVisible&&p.get(0)!=document.activeElement&&!f.selection.length&&!p.val()},f.showHideDefault=function(a){f.fakeInputVisible=a};var z=function(){f.suggestionsListIsFull()||(f.showHideDefault(!1),f.fakeInputVisible||f.toggleSuggestionsDisplay?(f.switchSuggestions(!1),f.showHideIfNothingSelected()):(p.focus(),f.switchSuggestions(!0)),f.toggleSuggestionsDisplay=!1,f.$digest())},A=function(){f.toggleSuggestionsDisplay=!!f.enableSuggestions},B=function(){f.switchSuggestions(!0),F.reset(),f.showHideDefault(!1),f.$digest()};f.showHideIfNothingSelected=function(){f.showHideDefault(!f.selection.length&&!p.val())},f.tipClick=function(a){var b={};b[x]=a[x];var c=_.find(f.items,{nameRus:a});!!c&&f.addItem(c)},f.uniqueSuggestionFilter=function(a){return!_.find(f.selection,{nameRus:a.nameRus})},f.topicsFilter=function(a){return-a.parent},f.relevantIndexFilter=function(a){var b=p.val().trim().toLowerCase();return a[x].toLowerCase().indexOf(b)},f.alphabetFilter=function(a){return a[f.itemLabel].toLowerCase()},f.matchedSuggestionFilter=function(a){return f.relevantIndexFilter(a)!==-1&&f.uniqueSuggestionFilter(a)},f.squeezeInputArea=function(){return p.length?(p.width(0),!0):($log.warn("There is no input element inside suggestions container"),!1)},f.inputSize=0,f.adjustUserInputWidth=function(){setTimeout(function(){f.inputSize=u.outerWidth()-p.position().left-(p.outerWidth(!0)-p.width())-s.outerWidth(),p.outerWidth(f.inputSize)})},f.adjustUserInputWidth();var C=b("filter"),D=b("orderBy"),E=b("highlight"),F={currentValue:-1,zeroValue:0,scrollValue:3,reset:function(){this.updateDOM(),this.currentValue=-1,r.scrollTop(0)},increase:function(){this.currentValue<f.suggestions.length-1?(this.updateDOM(),this.currentValue++,this.currentValue>=this.scrollValue&&r.scrollTop(r.scrollTop()+H),this.updateDOM()):(r.scrollTop(0),this.value=this.zeroValue)},decrease:function(){this.currentValue>this.zeroValue?(this.updateDOM(),this.currentValue--,this.currentValue<=f.suggestions.length-this.scrollValue&&r.scrollTop(r.scrollTop()-H),this.updateDOM()):(r.scrollTop(r[0].scrollHeight),this.value=f.suggestions.length-1)},get value(){return this.currentValue},set value(a){this.updateDOM(),this.currentValue=a,this.updateDOM()},updateDOM:function(){if(this.currentValue>=this.zeroValue){var a="item-active";r.find("."+w).eq(this.currentValue).toggleClass(a)}}};m();var G=$(".selectable-items-suggestions .item-container"),H=d.ITEM_SUGGESTION_HEIGHT;G.length&&(H=G.first().height());var I=function(a){a.stopPropagation();var b=f.suggestions[F.value];f.addItem(b),F.reset(),f.suggestionsListIsFull()||p.focus(),f.$digest()},J=function(a){var b=$(a.target).data("index");F.value=b},K=_.throttle(i,100);r.on(c.ELEMENT.CLICK,"."+w,I).on(c.ELEMENT.MOUSEOVER,"."+w,J);var L=function(a){i(a),F.reset(),m(),f.switchSuggestions(!0),f.$digest()};s.on(c.ELEMENT.CLICK,A),q.on(c.ELEMENT.CLICK,z),p.on(c.ELEMENT.INPUT,L).on(c.ELEMENT.KEYDOWN,K).on(c.ELEMENT.CLICK,B).on(c.ELEMENT.FOCUS,m).on(c.ELEMENT.BLUR,j),t.on(c.ELEMENT.CLICK,l),g.on(c.ELEMENT.CLICK,k);var M=f.$on(c.SCOPE.DESTROY,function(){t.off(c.ELEMENT.CLICK,l),g.off(c.ELEMENT.CLICK,k),r.off(c.ELEMENT.CLICK,I).off(c.ELEMENT.MOUSEOVER,J),M(),p.off(c.ELEMENT.INPUT,L).off(c.ELEMENT.KEYDOWN,K).off(c.ELEMENT.CLICK,B).off(c.ELEMENT.FOCUS,m).off(c.ELEMENT.BLUR,j),s.off(c.ELEMENT.CLICK,A),q.off(c.ELEMENT.CLICK,z)})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("userInputList",["$timeout","EVENTS",function(a,b){return{scope:{values:"=",targetModel:"=",viewProp:"@",modelProp:"@",enabled:"=",ignoreEvents:"=",defaultViewValue:"@",widgetCode:"@?"},templateUrl:"modules/utils/directives/user-input-list/partials/user-input-list.html",link:function(a,c){function d(a){"remove"===a.type?(clearTimeout(f),c.removeClass(e.dropDownListEnabledCssClass)):f=setTimeout(function(){"LI"!==a.target.parentElement.tagName&&c.toggleClass(e.dropDownListEnabledCssClass)})}c.attr("tabindex",-1),a.hideDropdownListPromise=null;var e={dropDownListEnabledCssClass:"slide-down",listTriggerBtnCssClass:"btn-trigger",dropDownListItemCssClass:"user-input-item-value",dropDownListCurrentItemCssClass:"current-item",selectedInput:"user-input-item-selected"},f=null;c.on(b.ELEMENT.CLICK,"."+e.listTriggerBtnCssClass,d),a.adjustWidgetSize=function(){var a=c.find("."+e.dropDownListItemCssClass),b=Math.max.apply(null,a.map(function(a,b){return $(b).outerWidth(!0)+30}));c.find("."+e.dropDownListCurrentItemCssClass).width(b)},setTimeout(a.adjustWidgetSize),a.$watch("values",function(){a.setDefaultValue(),setTimeout(a.adjustWidgetSize)}),a.$watch("targetModel",function(b,c){if(b!==c)if("self"===a.modelProp&&"self"===a.viewProp)a.selectedValue=b;else{var d={};d[a.modelProp]=b;var e=_.find(a.values,d);a.selectedValue[a.modelProp]=b,a.selectedValue[a.viewProp]=e[a.viewProp]}});var g=a.$on(b.WIDGET.ADJUST_SIZE,function(){setTimeout(a.adjustWidgetSize)}),h=a.$on(b.WIDGET.BLOCK,function(b,d,e){if(d===a.widgetCode){var f=(e?"add":"remove")+"Class";c[f]("inactive")}});a.$on(b.SCOPE.DESTROY,function(){g(),h()}),a.setCurrentValue=function(b){b.inactive||(a.selectedValue=angular.copy(b),"self"===a.modelProp?(a.targetModel=b,d({type:"remove"})):(a.targetModel=b[a.modelProp],d({type:"remove"})))},a.getViewValue=function(b){return"self"===a.viewProp?b:!!b&&b[a.viewProp]||""},a.selectedValue=null,a.setDefaultValue=function(){if(a.values&&a.values.length){var b=angular.copy(a.values[0]);void 0!==a.defaultViewValue&&(b[a.viewProp]=a.defaultViewValue),a.setCurrentValue(b)}},a.setDefaultValue();var i=function(a){var b=a.relatedTarget;b?_.indexOf(b.classList,e.selectedInput)<0&&_.indexOf(b.parentElement.classList,e.selectedInput)<0&&d({type:"remove"}):d({type:"remove"})};c.on(b.ELEMENT.FOCUSOUT,i),a.ignoreEvents||a.$on(b.WIDGET.SET_DEFAULT_VALUE,function(){a.setDefaultValue()})}}}])}(),function(){"use strict";var a=angular.module("utils");a.provider("policiesManager",function(){this.dataSource="",this.$get=["$http","$q","HTTP_STATUSES",function(a,b,c){var d=this.dataSource.trim(),e=this.removeEntityEndpoint.trim();if(!d)throw"Please configure data sources for policiesManagerProvider";if(!e)throw"Please configure entity removing endpoint for policiesManagerProvider";return{getList:function(){return a.get(d).then(function(a){return a.data},function(a){return b.reject(a)})},removeItem:function(d){return a["delete"](e+"/"+d).then(function(a){return a.status===c.OK||b.reject("Server responded with success, but actual code is not 200: "+a.status)},function(a){return b.reject(a)})}}}]})}(),function(){"use strict";var a=angular.module("utils");a.directive("downloadLink",["STRUCTURE",function(a){return{restrict:"A",link:function(b,c,d){d.$observe("href",function(b){c.attr("target",String(b).indexOf(a.DOWNLOADS)!==-1?"_blank":"_self")})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("numberValidation",["REGEXP",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){e.$validators.numberValidation=function(b,c){return e.$isEmpty(b)||a.NUMBER.test(c)}}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("birthdateValidation",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){var e=c.validationMethodName,f=a,g=f[e];if(isNaN(c.upperScopeDepth)){if(!g)for(;null!==f.$parent&&(f=f.$parent,g=f[e],"function"!=typeof g););}else for(var h=0,i=+c.upperScopeDepth;h<i;h++)f=f.$parent,g=f[e];g="function"==typeof g?g:angular.noop,d.$validators.birthdateValidation=function(a){if(!d.$isEmpty(a)){var b;try{b=g.call(null,a)}catch(c){b=!1}}return d.$isEmpty(a)||b}}}})}(),function(){"use strict";var a=angular.module("utils");a.directive("disallowSymbolEnter",["EVENTS","KEYBOARD",function(a,b){return{restrict:"A",link:function(c,d,e){var f=function(a){var c=a.which;switch(e.disallowSymbolEnter){case"space":c===b.SPACE&&a.preventDefault();break;case"non-digits":(c<b.ZERO||c>b.NINE)&&a.preventDefault();break;default:return}};d.on(a.ELEMENT.KEYPRESS,f),c.$on(a.SCOPE.DESTROY,function(){d.off(a.ELEMENT.KEYPRESS,f)})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("restrictInputMaxlength",["MAX_SYMBOLS",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){var f=d.restrictInputMaxlength,g=f&&!isNaN(f)?f:a;e.$parsers.push(function(a){return!e.$isEmpty(a)&&a.length>g&&(a=a.substring(0,g),e.$setViewValue(a),e.$modelValue=a,e.$render()),a})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("cloneAnimation",["EVENTS","REGEXP",function(a,b){return{restrict:"A",link:function(c,d){var e,f,g,h,i=b.DURATION_MEASURE_UNIT,j=function(){d.hasClass("active")||(g=d.clone(),g.addClass("animated-el"),g.insertAfter(d),e=g.css("animationDuration"),f=i.test(e)?parseFloat(e):1e3*parseFloat(e),h=setTimeout(function(){g.remove()},f))};d.on(a.ELEMENT.CLICK,j),c.$on(a.SCOPE.DESTROY,function(){d.off(a.ELEMENT.CLICK,j),clearTimeout(h)})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("fixClonedContent",["EVENTS","$document",function(a,b){return{restrict:"A",link:function(c,d,e){function f(){n=d.offset().top,b.scrollTop()>n?(i.removeClass(h),o=parseFloat(j.css("padding-left")),g()):i.addClass(h)}function g(){i.css("left",o-j.scrollLeft())}var h=e.cssHiddenClass||"hidden",i=$('<div class="fixed-el-container"></div>');i.addClass(h),d.prepend(i);var j=$("."+e.fixClonedContentParent),k="."+e.fixClonedContent,l=function(){i.empty();var a=$(document.createDocumentFragment());d.find(k).each(function(b,c){a.append($(c).clone(!0))}),i.append(a)},m=setTimeout(l);b.on(a.SCROLL.REGULAR,f),j.on(a.SCROLL.REGULAR,g);var n,o;c.$watch(l),c.$on(a.SCOPE.DESTROY,function(){clearTimeout(m),b.off(a.SCROLL.REGULAR,f),j.off(a.SCROLL.REGULAR,g)})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("overlayScrollEmitter",["EVENTS","$document","$window",function(a,b,c){return{link:function(b,d,e){function f(){u=q.scrollLeft(),b.$emit(a.SCROLL.SCROLL_OVERLAY,u)}var g,h,i=e.containerContentWidth,j=e.innerContentBlock,k=null,l=function(){k={width:document.documentElement.clientWidth}},m=0,n=function(){k&&(h=(k.width-i)/2,h>=0&&d.css("padding-left",h))},o=function(){var a=$('<div class="dummy-block-wrapper"></div>');$("body").append(a);var b=$('<div class="dummy-block"></div>');a.append(b),m=a.prop("offsetWidth")-a.prop("clientWidth"),a.remove()};o();var p=null,q=null,r=function(){q=$('<div class="scrollable-overlay-wrapper"></div>'),p=$('<div class="scrollable-overlay"></div>'),q.append(p),d.prepend(q)};r();var s=function(){g=d.find("."+j);var a=g.prop("scrollWidth");g.css("width",Math.max(a,i)),p.css("width",a+h),q.css("height",m+p.prop("clientHeight"))},t=c.requestAnimationFrame(function w(){l(),n(),s(),t=c.requestAnimationFrame(w)});q.on(a.SCROLL.REGULAR,f);var u,v=b.$on(a.BLOCK_DYNAMIC_RESIZE.RESET_DUMMY,function(){g.css("width",i)});b.$on(a.SCOPE.DESTROY,function(){c.cancelAnimationFrame(t),q.off(a.SCROLL.REGULAR,f),v()})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("overlayScrollHandler",["EVENTS","$rootScope",function(a,b){return{link:function(c,d){var e=b.$on(a.SCROLL.SCROLL_OVERLAY,function(a,b){d.scrollLeft(b)});c.$on(a.SCOPE.DESTROY,function(){e()})}}}])}(),function(){"use strict";var a=angular.module("utils");a.directive("bgImage",["PICTURE_PATH_TEMPLATES","$log",function(a,b){return{restrict:"A",link:function(c,d,e){var f=c.$eval(e.bgImage)||{},g=f.template,h=f.file;if(!g||!h)return void b.warn("Unable to set background image for element. Either template or file is incorrect");var i=a[g],j="url("+i.path+"/"+h+"."+i.ext+")";d.css("background-image",j)}}}])}(),function(){"use strict";var a=angular.module("utils");a.factory("dateParserHelpers",[function(){var a={};return{getInteger:function(b,c,d,e){var f=b.substring(c),g=a[d+"_"+e];g||(g=new RegExp("^(\\d{"+d+","+e+"})"),a[d+"_"+e]=g);var h=g.exec(f);return h?h[1]:null}}}]).factory("$dateParser",["$locale","dateParserHelpers",function(a,b){var c=a.DATETIME_FORMATS,d=c.MONTH.concat(c.SHORTMONTH),e=c.DAY.concat(c.SHORTDAY);return function(a,f){if(angular.isDate(a))return a;try{if(a+="",f+="",!f.length)return new Date(a);c[f]&&(f=c[f]);for(var g=new Date,h=0,i=0,j="",k=g.getFullYear(),l=g.getMonth()+1,m=g.getDate(),n=0,o=0,p=0,q=0,r="am",s=0,t=!1;i<f.length;){j=f.charAt(i);var u="";if("'"!=f.charAt(i)){for(;f.charAt(i)==j&&i<f.length;)u+=f.charAt(i++);if("yyyy"==u||"yy"==u||"y"==u){var v,w;if("yyyy"==u&&(v=4,w=4),"yy"==u&&(v=2,w=2),"y"==u&&(v=2,w=4),k=b.getInteger(a,h,v,w),null===k)throw"Invalid year";h+=k.length,2==k.length&&(k=k>70?1900+(k-0):2e3+(k-0))}else if("MMMM"===u||"MMM"==u){l=0;for(var x=0;x<d.length;x++){var y=d[x];if(a.substring(h,h+y.length).toLowerCase()==y.toLowerCase()){l=x+1,l>12&&(l-=12),h+=y.length;break}}if(l<1||l>12)throw"Invalid month"}else if("EEEE"==u||"EEE"==u)for(var z=0;z<e.length;z++){var A=e[z];if(a.substring(h,h+A.length).toLowerCase()==A.toLowerCase()){h+=A.length;break}}else if("MM"==u||"M"==u){if(l=b.getInteger(a,h,u.length,2),null===l||l<1||l>12)throw"Invalid month";h+=l.length}else if("dd"==u||"d"==u){if(m=b.getInteger(a,h,u.length,2),null===m||m<1||m>31)throw"Invalid date";h+=m.length}else if("HH"==u||"H"==u){if(n=b.getInteger(a,h,u.length,2),null===n||n<0||n>23)throw"Invalid hours";h+=n.length}else if("hh"==u||"h"==u){if(n=b.getInteger(a,h,u.length,2),null===n||n<1||n>12)throw"Invalid hours";h+=n.length}else if("mm"==u||"m"==u){if(o=b.getInteger(a,h,u.length,2),null===o||o<0||o>59)throw"Invalid minutes";h+=o.length}else if("ss"==u||"s"==u){if(p=b.getInteger(a,h,u.length,2),null===p||p<0||p>59)throw"Invalid seconds";h+=p.length}else if("sss"===u){if(q=b.getInteger(a,h,3,3),null===q||q<0||q>999)throw"Invalid milliseconds";h+=3}else if("a"==u){if("am"==a.substring(h,h+2).toLowerCase())r="AM";else{if("pm"!=a.substring(h,h+2).toLowerCase())throw"Invalid AM/PM";r="PM"}h+=2}else if("Z"==u){if(t=!0,"Z"===a[h])s=0,h+=1;else if(":"===a[h+3]){var B=a.substring(h,h+6);s=60*parseInt(B.substr(0,3),10)+parseInt(B.substr(4,2),10),h+=6}else{var B=a.substring(h,h+5);s=60*parseInt(B.substr(0,3),10)+parseInt(B.substr(3,2),10),h+=5}if(s>720||s<-720)throw"Invalid timezone"}else{if(a.substring(h,h+u.length)!=u)throw"Pattern value mismatch";h+=u.length}}else{for(;"'"!=f.charAt(++i)&&i<f.length;)u+=f.charAt(i);if(a.substring(h,h+u.length)!=u)throw"Pattern value mismatch";h+=u.length,i++}}if(h!=a.length)throw"Pattern value mismatch";if(k=parseInt(k,10),l=parseInt(l,10),m=parseInt(m,10),n=parseInt(n,10),o=parseInt(o,10),p=parseInt(p,10),q=parseInt(q,10),2==l)if(k%4===0&&k%100!==0||k%400===0){if(m>29)throw"Invalid date"}else if(m>28)throw"Invalid date";if((4==l||6==l||9==l||11==l)&&m>30)throw"Invalid date";n<12&&"PM"==r?n+=12:n>11&&"AM"==r&&(n-=12);var C=new Date(k,l-1,m,n,o,p,q);return t?new Date(C.getTime()-6e4*(s+C.getTimezoneOffset())):C}catch(D){return}}}])}(),function(){"use strict";var a=angular.module("utils");a.factory("pageScroll",["$log",function(a){if(!jQuery)throw{message:"pageScroll requires jQuery to be plugged in"};return{scrollTo:function(b){var c=$("body, html"),d=$(document).scrollTop();return d===b.scrollTo?void a.info("Current document's scrollTop is the same as desired scrollTo. Doing nothing"):void c.stop().animate({scrollTop:b.scrollTo},b.animationTime,b.easing)}}}])}(),function(){"use strict";var a=angular.module("utils");a.factory("textTranslator",["TEXT_LABELS",function(a){return{translate:function(b,c){var d=a[b][c];return d?d:""}}}])}(),function(){"use strict";var a=angular.module("utils");a.factory("csrf",["$http","$log","$q","REST_API",function(a,b,c,d){return{get:function(){var e=function(a){b.info("Token received."),b.info("Cookies: ",a.headers().cookie)},f=function(a){return b.error("Error during GET request to get token"),c.reject(a)};return a.get(d.PING).then(e,f)}}}])}(),function(){"use strict";var a=angular.module("utils");a.factory("httpCsrfAware",["$http","$q","$log","csrf",function(a,b,c,d){return{callMethod:function(a,e){var f=function(){var b=null;return a.apply(b,e)},g=function(a){return c.error("Error during GET request to get token token"),b.reject(a)};return d.get().then(f,g)}}}])}(),function(){"use strict";var a=angular.module("utils");a.factory("userAuth",["$rootScope","$http","REST_API","$uibModal","$location","$route","BUSINESS_ENTITIES","ROUTES","EVENTS","$q","$log","csrf","httpCsrfAware","REST_API",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=function(){null!=f.current&&null!=f.current.businessEntity&&[g.ORDER_PREPARE,g.ORDER_PAYMENT,g.PRIVATE_OFFICE].indexOf(f.current.businessEntity)>=0&&e.path(h.MAIN_PAGE)},p={value:null},q=function(a,d,e,f){localStorage.setItem(i.REMEMBER_ME,e);var g=function(a,c,d,f){return b.post(a,{email:c,password:d,userType:f},{headers:{Accept:"application/json","Content-type":"application/json","remember-me":e},isArray:!1})};return m.callMethod(g,[c.LOGIN,a,d,f])},r=function(b){p.value=b.data,localStorage.setItem("userAuth",!0),a.$broadcast(i.USER_ACTIONS.LOGIN,[b.data])},s=function(a){return k.error("Can not send broadcast. Reason: ",a.statusText),j.reject(a.statusText)},t={getCurrentUser:function(){return p},getPartnerData:function(){return b.get(c.PARTNER).then(function(a){return a.data},function(a){return j.reject(a)})},login:function(a,b,c,d){return q(a,b,c,d).then(r,s)},logout:function(){var d=function(a){return b.post(a,null,{headers:{Accept:"application/json"}})};return m.callMethod(d,[c.LOGOUT]).then(function(){k.debug("User is logging out. Clear local storage..."),a.$broadcast(i.USER_ACTIONS.LOGOUT,p.value),p.value=null,localStorage.clear()},o).then(l.get,function(){k.error("Error during resolving promise")})},checkEmail:function(a){var d=function(a,c){return b.post(a,{email:c},{headers:{Accept:"application/json","Content-type":"application/json"},isArray:!1})};return m.callMethod(d,[c.USER_ACCOUNT,a])},resetPassword:function(a){var d=function(a,c){return b.post(a,{email:c},{headers:{Accept:"application/json","Content-type":"application/json"}})};return m.callMethod(d,[c.NEW_PASSWORD,a])}};return a.$on(i.REMEMBER_ME,function(a){return null!==localStorage.getItem("userAuth")?(localStorage.removeItem("userAuth"),t.logout()):a}),t.requestAuthenticate=function(){return d.open({animation:!0,templateUrl:"login.html",size:"sm",controller:"loginController",resolve:{parent:function(){return t}},backdrop:"static"}),!1},t.updateAuthState=function(){var d=function(a){if(p.value=null,null!==localStorage.getItem("userAuth"))return k.error("User is no longer authorised"),t.logout(),j.reject(a)},e=function(b){p.value=b.data,a.$broadcast(i.USER_ACTIONS.LOGIN,[b.data])};return b.get(c.USER,{headers:{Accept:"application/json"},isArray:!1,cache:!1}).then(e,d)},t}])}(),function(){"use strict";var a=angular.module("utils");a.factory("userData",["CACHE_ITEMS",function(a){return{getCacheNames:function(){return _.values(a)},clearCache:function(a){var b=this.getCacheNames();try{var c=a.except}catch(d){c=[]}b.forEach(function(a){c.indexOf(a)===-1&&(a in localStorage?localStorage:sessionStorage).removeItem(a)})}}}])}(),function(){"use strict";var a=angular.module("utils");a.factory("rememberMeInterceptor",["$log","REST_API","$rootScope","$cookies","EVENTS",function(a,b,c,d,e){return{request:function(b){var f=localStorage.getItem(e.REMEMBER_ME);return null===localStorage.getItem("userAuth")||"true"!==f&&null!==f||void 0!==d.get("remember-me")||(a.error("remember-me cookie is lost, broadcasting"),c.$broadcast(e.REMEMBER_ME,b)),b}}}])}(),function(){"use strict";var a=angular.module("utils");a.factory("manageLocation",["$location",function(a){return{isCurrentLocation:function(b){return a.path()===b},redirect:function(b){a.path(b)}}}])}(),function(){"use strict";var a=angular.module("utils");a.factory("dataStorage",function(){return{setData:function(a,b,c){(c?sessionStorage:localStorage).setItem(a,b)},getData:function(a,b){var c=b?sessionStorage:localStorage;return c.getItem(a)},removeData:function(a,b){var c=b?sessionStorage:localStorage;return c.removeItem(a)}}})}(),function(){"use strict";var a=angular.module("utils");a.factory("formHelper",function(){return{togglePasswordDisplay:function(a){var b=$(a.currentTarget);b.hasClass("showing")?(b.removeClass("showing"),$("#password").attr("type","password")):(b.addClass("showing"),$("#password").attr("type","text")),a.preventDefault()}}})}(),function(){"use strict";var a=angular.module("utils");a.factory("frameManager",["$window","REGEXP",function(a,b){return{isAppInFrameMode:function(){return a.self!==a.top&&!b.YANDEX_WEBVISOR_FRAME_URL_FRAGMENT.test(a.self.location.href)},getStaticLinksMode:function(){return this.isAppInFrameMode()?"_blank":"_self"}}}])}(),function(){"use strict";var a=angular.module("utils");a.filter("highlight",function(){return function(a,b,c){c=c||"span";var d=a.search(new RegExp(b,"i"));if(d===-1)return a;var e=a.substring(0,d),f=a.substr(d,b.length),g=a.substring(d+b.length);return f=f.length?"<"+c+' class="mark">'+f+"</"+c+">":f,e+f+g}})}(),function(){"use strict";var a=angular.module("utils");a.filter("quantitySuffix",function(){return function(a,b,c){var d=[2,0,1,1,1,2],e=a%100,f=e>7&&e<20?2:d[e%10<5?e%10:5];return b+c[f]}})}(),function(){"use strict";var a=angular.module("utils");a.filter("wordcut",function(){return function(a,b){if(a.length<b)return a;a=a.substring(0,b).trim();var c=a.split(" ");return c.length>1&&c.pop(),a=c.join(" "),""!==a&&(a+="..."),a}})}(),function(){"use strict";var a=angular.module("utils");a.filter("numtolocale",function(){return function(a){return a=parseInt(a).toLocaleString()}})}(),function(){"use strict";var a=angular.module("utils");a.filter("numdivider",function(){return function(a,b,c){if(void 0==a)return"";if(!b&&!c)return a;var d=new RegExp(b||",","g");return a=a.toString().replace(d,c||",");
}})}(),function(){"use strict";var a=angular.module("utils");a.provider("countries",function(){this.dataSource="",this.compareBy="",this.$get=["$http","$q","$log",function(a,b,c){var d=this,e=d.dataSource.trim();if(!e)throw{message:"An empty data source was give for countries. Please configure countriesProvider"};return{getList:function(){return c.debug("Initiating request for fetching countries list"),a.get(e).then(function(a){return a.data},function(a){return b.reject(a)})},compareBy:d.compareBy}}]})}(),function(){"use strict";var a=angular.module("utils");a.provider("currenciesSum",function(){this.dataSource="",this.$get=["$http",function(a){var b=this.dataSource.trim();if(!b)throw{message:"Empty data source for currencies to sum list. Please configure currenciesSumProvider"};return{getList:function(){return a.get(b)}}}]})}(),function(){"use strict";var a=angular.module("utils");a.provider("insuranceCalculation",function(){this.dataSource="",this.$get=["$http","$q","$log","HEADERS","TIMEOUT","httpCsrfAware",function(a,b,c,d,e,f){var g=this.dataSource.trim();if(!g)throw{message:"Empty data source. Please configure insuranceCalculationProvider"};var h={offerId:0,deferred:null},i={getNewData:function(b){c.debug("Trying to fetch calculated data...");var d=a({isArray:!1,method:"POST",headers:{Accept:"application/json"},url:g+h.offerId+"/successful-calculations?calculationType=NEW",cache:!1,timeout:b});return{$promise:d}},launchPolling:function(a){var f=this;this.getNewData(a).$promise.then(function(g){var j=g.headers();return c.debug("Response headers: ",j),j[d.CALCULATION_STATUS_HEADER.NAME]===d.CALCULATION_STATUS_HEADER.VALUE?(h.deferred.resolve(),i.resetProcessData(),b.reject("Calculation process done")):g.data&&g.data.length?(h.deferred.notify(g.data),void f.launchPolling(a)):(setTimeout(function(){f.launchPolling(a)},e.CALCULATION),b.reject("Calculation timeout exceeded"))},function(a){return c.error("Can not get current calculation data: ",a),b.reject(a)})},resetProcessData:function(){h.offerId=0,h.deferred=null}};return{launchCalculation:function(d){var e=b.defer(),j=b.defer();h.deferred=e;var k=function(b,c){return a({method:"POST",url:b,isArray:!1,headers:{Accept:"application/json","Content-type":"application/json"},timeout:c.promise,data:d})};return f.callMethod(k,[g,j]).then(function(a){c.debug("Calculations group id received: ",a.data),h.offerId=a.data,i.launchPolling(j.promise)},function(a){c.error("Can not create calculation group: ",a),i.resetProcessData(),e.reject(a)}),{$promise:e.promise,cancel:function(){j.resolve()}}}}}]})}(),function(){"use strict";var a=angular.module("utils");a.provider("orderManager",function(){this.draftPersistenceDestination="",this.orderPurchaseDestination="",this.acceptanceDestination="",this.$get=["$http","$q","httpCsrfAware","CACHE_ITEMS","HTTP_STATUSES","dataStorage","ROUTES","ORDER_STATUSES","$log",function(a,b,c,d,e,f,g,h,i){var j=this.draftPersistenceDestination,k=this.orderPurchaseDestination,l=this.acceptanceDestination,m=this.draftCreationDestination;if(!j)throw{message:"Empty draftPersistenceDestination for orderManagerProvider. Please configure it"};if(!k)throw{message:"Empty orderPurchaseDestination for orderManagerProvider. Please configure it"};if(!l)throw{message:"Empty acceptanceDestination for orderManagerProvider. Please configure it"};if(!m)throw{message:"Empty draftCreationDestination for orderManagerProvider. Please configure it"};return f.setData(d.ORDER_STATUS,angular.toJson(h.DUMMY_ORDER),!0),{storePreviewData:function(d){var g=b.defer(),i=function(b,c){return a.post(b,d,{headers:{Accept:"application/json","Content-type":"application/json",partner:f.getData("partnerId")},timeout:c.promise})},k=this,l=c.callMethod(i,[j,g]).then(function(a){return a.status===e.NO_CONTENT?(k.orderStatus=h.CALCULATION_NOT_FOUND,b.reject(h.CALCULATION_NOT_FOUND.TITLE)):a},function(a){var c=a.status===e.REQUEST_TIMEOUT?h.DRAFT_FAILED:h.SOMETHING_GOES_WRONG;return k.orderStatus=c,b.reject(c.TITLE)});return{$promise:l,cancel:function(){g.resolve()}}},getDraftData:function(c){var d=b.defer(),e=a.get(j+c,{timeout:d.promise});return{$promise:e,cancel:function(){d.resolve()}}},getPaymentDetails:function(d){var f=b.defer(),g=function(b,c){return a({method:"POST",url:b,headers:{Accept:"application/json","Content-type":"application/json",orderId:d},timeout:c.promise})},i=this,j=c.callMethod(g,[k,f]).then(function(a){return a.status===e.NO_CONTENT?(i.orderStatus=h.PAYMENT_MICROSERVICE_UNAVAILABLE,b.reject(h.PAYMENT_MICROSERVICE_UNAVAILABLE.TITLE)):a},function(a){return i.orderStatus=a.status===e.NOT_FOUND||a.status===e.INTERNAL_SERVER_ERROR?h.PAYMENT_MICROSERVICE_UNAVAILABLE:h.SOMETHING_GOES_WRONG,b.reject(a)});return{$promise:j,cancel:function(){f.resolve()}}},get orderStatus(){try{return angular.fromJson(f.getData(d.ORDER_STATUS,!0))}catch(a){return null}},set orderStatus(a){if(!_.isObject(a))throw{message:"Order status is not an object!"};f.setData(d.ORDER_STATUS,angular.toJson(a),!0)},acceptPolicyItem:function(d){var f=this,g={method:"POST",url:l,headers:{"Content-Type":"application/json"},params:{orderId:d}},i=function(c){return a(c).then(function(a){return a.status===e.NO_CONTENT?(f.orderStatus=h.INSURANCE_SERVICE_UNAVAILABLE,b.reject({reason:"Server did not managed to accept policy item",status:a.status})):a.data},function(a){return f.orderStatus=h.INSURANCE_SERVICE_UNAVAILABLE,b.reject(a)})};return c.callMethod(i,[g])},storeInsuranceParams:function(a){localStorage.setItem(d.TRIP_FORM,angular.toJson(a))},getInsuranceParams:function(a){var b=localStorage.getItem(d.TRIP_FORM);return a?b:angular.fromJson(b)},storeInsuranceChoice:function(a){localStorage.setItem(d.INSURANCE_CHOICE,angular.toJson(a))},getInsuranceChoice:function(){return angular.fromJson(f.getData(d.INSURANCE_CHOICE))},storeOrderPreview:function(a){localStorage.setItem(d.ORDER_PREVIEW,angular.toJson({calculationId:a.calculationId,insurer:a.insurer,insuredPersons:a.insuredPersons}))},getOrderPreview:function(){return angular.fromJson(localStorage.getItem(d.ORDER_PREVIEW))},storeOrderDraft:function(a){localStorage.setItem(d.ORDER_DRAFT,angular.toJson(a))},createOrderDraft:function(d){var e={method:"POST",url:m+"/"+d.calculationId,headers:{"Content-Type":"application/json"}},f=function(c){return a(c).then(function(a){return a.data},function(a){return i.error("Failed to get draft id: ",a),b.reject(a)})};return c.callMethod(f,[e])}}}]})}(),function(){"use strict";var a=angular.module("utils");a.provider("insuranceCompanies",function(){this.dataSource="",this.$get=["$http","$q",function(a,b){var c=this.dataSource.trim();if(!c)throw{message:"Please configure insuranceCompaniesProvider"};return{getList:function(){return a.get(c).then(function(a){return a.data},function(a){return b.reject(a)})}}}]})}(),function(){"use strict";var a=angular.module("utils");a.provider("assistanceCompanies",function(){this.dataSource="",this.$get=["$http",function(a){var b=this.dataSource.trim();if(!b)throw{message:"Please configure assistanceCompaniesProvider"};return{getList:function(){return a.get(b)}}}]})}(),function(){"use strict";var a=angular.module("utils");a.provider("riskFilters",function(){this.dataSource="",this.$get=["$http",function(a){var b=this.dataSource;if(!b.trim())throw{message:"Empty dataSource for risk filters. Please configure riskFiltersProvider"};return{getList:function(){return a.get(b)}}}]})}(),function(){"use strict";var a=angular.module("utils");a.provider("riskOptions",function(){this.dataSource="",this.$get=["$http","$q",function(a,b){var c=this.dataSource;if(!c.trim())throw{message:"Empty dataSource for risk options. Please configure riskOptionsProvider"};return{getList:function(){return a.get(c).then(function(a){return a.data},function(a){return b.reject(a)})}}}]})}(),function(){"use strict";var a=angular.module("utils");a.provider("insuredDays",function(){this.dataSource="",this.$get=["$http",function(a){var b=this.dataSource.trim();if(!b)throw{message:"Please configure insuranceDaysProvider"};return{getList:function(){return a.get(b)}}}]})}(),function(){"use strict";var a=angular.module("utils");a.provider("soldItems",function(){this.dataSource="",this.$get=["$http","$q",function(a,b){var c=this.dataSource.POLICIES;if(!c.trim())throw{message:"Empty dataSource for sales report. Please configure soldItemsProvider"};return{soldItemsDataAll:function(d){var e=b.defer(),f=a.get(c,{method:"GET",params:{periodString:d},headers:{Accept:"application/json","Content-type":"application/json"},timeout:e.promise});return{$promise:f,cancel:function(){e.resolve()}}}}}]})}(),function(){"use strict";var a=angular.module("utils");a.provider("insuranceTypes",function(){this.dataSource="",this.$get=["$http","$q",function(a,b){var c=this.dataSource.trim();if(!c)throw{message:"Please configure insuranceTypesProvider"};return{getList:function(){return a.get(c).then(function(a){return a.data},function(a){return b.reject(a)})}}}]})}(),function(){"use strict";angular.module("privateOffice",[])}(),function(){"use strict";var a=angular.module("privateOffice");a.controller("privateOfficeController",["$scope","$q","policiesManager","$location","riskOptions","ROUTES","POLICY_STRUCTURE","$log","orderManager","EVENTS","INSURANCE_COMPANIES",function(a,b,c,d,e,f,g,h,i,j,k){var l=this;this.getDownloadLink=function(a){var b="";try{b=a.links.downloadLink||b}catch(c){h.warn("Attempt to get policy's link failed: ",c)}return b},this.saveOrderPreview=function(a){i.storeOrderPreview({calculationId:a.calculationId,insurer:a.insurer,insuredPersons:a.insuredPersons})},this.getPaymentStepLink=function(){return f.ORDER_PAYMENT},a.policyStructure=_.reduce(g.TYPES,function(a,b,c){var d=angular.copy(b);return d.type=c,a.push(d),a},[]),a.policyFilter={},a.policyFilter[g.POLICY_FIELDS.TYPE]=void 0,a.policiesFetched=!1,a.policiesList=null,a.itemsPerCategory=null,a.activePolicyType=null,a.setPoliciesFilter=function(b){a.policyFilter[g.POLICY_FIELDS.TYPE]="ANY"!==b?b:void 0},a.getPolicyFilter=function(){return a.policyFilter},a.getPolicyType=function(a){return g.TYPES[a[g.POLICY_FIELDS.TYPE]].itemLabel},a.checkPolicyType=function(a,b){return b===g.TYPES[a[g.POLICY_FIELDS.TYPE]].serviceLabel},a.getPolicyActionLabel=function(a){return g.TYPES[a[g.POLICY_FIELDS.TYPE]].actionLabel},a.setActivePolicyType=function(b){a.activePolicyType=b},a.setActivePolicyType("ANY"),a.policyTypeIsActive=function(b){return a.activePolicyType===b},this.createComparator=function(b,c){return["category","date"].indexOf(b)===-1?angular.noop:function(d){var e;if("category"===b){var f=a.getPolicyFilter(),h=!f[g.POLICY_FIELDS.TYPE],i=g.TYPES[d[g.POLICY_FIELDS.TYPE]];e=i[h?"compositionPriority":"priority"]}else e=new Date(d.creationDate).getTime();return e*(c?-1:1)}},a.sortByCategory=this.createComparator("category"),a.sortByDate=this.createComparator("date",!0),a.policiesExists=function(b){if("ANY"===b&&a.policiesList.length)return!0;var c={};return c[g.POLICY_FIELDS.TYPE]=b,_.some(a.policiesList,c)},this.countItemsByCategory=function(b,c){a.itemsPerCategory=_.countBy(b,c),h.debug("Grouping items per category: ",a.itemsPerCategory)},c.getList().then(function(b){h.debug("Fetched policies list: ",b),b.forEach(function(a){a.calculationData.status=a.status,angular.merge(a.calculationData,a.confirmationData)}),a.policiesList=b,a.policiesFetched=!0,l.countItemsByCategory(b,g.POLICY_FIELDS.TYPE)},function(a){h.error("Can not fetch policies list: ",a)}),a.riskOptions=e,a.expandItem=function(a){a.expanded=!a.expanded},a.removeItem=function(d){var e=_.get(d,"confirmationData.policyId");if("undefined"==typeof e){var f="No policy ID specified for deletion.";return h.error(f),b.reject(f)}return c.removeItem(e).then(function(){h.debug("Policy item "+e+" was successfully removed from personal cabinet"),_.remove(a.policiesList,d)},function(a){return h.error("Can not remove item "+e+" from personal cabinet: ",a),b.reject(a)})},a.getActionResource=function(b){switch(!0){case a.checkPolicyType(b,"paid"):return l.getDownloadLink(b);case a.checkPolicyType(b,"draft"):case a.checkPolicyType(b,"payment-pending"):return l.getPaymentStepLink()}},a.executePolicyAction=function(b){(a.checkPolicyType(b,"draft")||a.checkPolicyType(b,"payment-pending"))&&(i.storeInsuranceChoice(b),l.saveOrderPreview(b))},a.updateFilteredPolicyItems=function(){a.$broadcast(j.SEARCH_RESULT_ITEM.UPDATE_ITEMS)},a.vtbCompany=k.VTB.LABEL,a.isInsuranceCompany=function(a,b){return a===b}}])}(),function(){"use strict";angular.module("adminMonitor",[])}(),function(){"use strict";var a=angular.module("adminMonitor");a.controller("adminMonitorController",["$scope","$log","$q","soldItems","userAuth","REST_API","insuranceTypes","insuranceCompanies","$http","httpCsrfAware","HTTP_STATUSES",function(a,b,c,d,e,f,g,h,i,j,k){var l=this;a.site=f.SITE,a.cancelPolicyDestination=a.site+"/internal/policy/order/admin/status/",a.insuranceTypes=null,a.insuranceCompanies=null,this.data=null,this.fetchInsuranceTypes=function(){g.getList().then(function(c){b.debug("Fetched insurance types: ",c),a.insuranceTypes=c},function(a){b.error("Unable to fetch insurance types: ",a)})},this.fetchPoliciesData=function(e){return d.soldItemsDataAll(e.value).$promise.then(function(c){return a.soldItems=c.data,b.debug("Received sold items: ",a.soldItems),a.soldItems},function(a){return b.error("Error while trying to fetch info about sold items: ",a),c.reject(a)})},this.fetchInsuranceCompanies=function(){h.getList().then(function(c){b.debug("Fetched insurance companies: ",c),a.insuranceCompanies=c.content},function(a){b.error("Unable to fetch insurance companies list: ",a)})},a.soldItems=[],a.overallPrice=0,a.overallRiskmarketRevenue=0,a.periods=[{value:"DAY",label:"Сегодня"},{value:"YESTERDAY",label:"Вчера"},{value:"MONTH",label:"Текущий месяц"},{value:"ALL",label:"За все время"}],a.soldBy=[{value:"ALL",label:"Все продажи"},{value:"RiskMarket",label:"Через РискМаркет"},{value:"Partners",label:"Через партнеров"}],a.paidStatuses=[{value:"ALL",label:"Все"},{value:"true",label:"Оплачены"},{value:"false",label:"Не оплачены"}],a.policyStatuses=[{value:"ALL",label:"Все"},{value:"OK",label:"Не требуют ручного вмешательства"},{value:"ALARM",label:"Требуют ручного вмешательства"}],a.getInsuranceType=function(b){return a.insuranceTypes&&b in a.insuranceTypes?a.insuranceTypes[b]:""},a.getInsuranceCompanyName=function(b){var c="";if(a.insuranceCompanies){var d=_.find(a.insuranceCompanies,{code:b});c=d?d.nameRus:c}return c},a.getRiskmarketRevenue=function(a,b){return a?b:0},this.setPaidStatusInCtrl=function(b){a.paidStatus=angular.copy(b)},this.setPaidStatusInCtrl(a.paidStatuses[0]),a.setPaidStatus=function(b){l.setPaidStatusInCtrl(b),l.fillTotalsReport(a.soldItems)},a.paidStatusIsChosen=function(b){return a.paidStatus.value===b.value},this.setPolicyStatusInCtrl=function(b){a.policyStatus=angular.copy(b)},this.setPolicyStatusInCtrl(a.policyStatuses[0]),a.setPolicyStatus=function(b){l.setPolicyStatusInCtrl(b),l.fillTotalsReport(a.soldItems)},a.policyStatusIsChosen=function(b){return a.policyStatus.value===b.value},this.setChosenPeriod=function(b){a.chosenPeriod=angular.copy(b)},this.setChosenPeriod(a.periods[0]),a.periodIsChosen=function(b){return a.chosenPeriod.value===b.value},a.showPaidInfo=function(d){l.setChosenPeriod(d),c.all([l.fetchPoliciesData(d)]).then(function(){l.fillTotalsReport(a.soldItems),l.updateCsvExportLink(d.value)},function(a){b.error("Unable to fill totals report data: ",a)})},a.getTotalSoldItems=function(){for(var b=0,c=0,d=a.soldItems.length;c<d;c++)a.show(a.soldItems[c])&&++b;return b},a.toRusString=function(a){return a?"да":"нет"},a.show=function(b){return a.showAccordingPaidStatuses(b)&&a.showAccordingPolicyStatuses(b)},a.showAccordingPaidStatuses=function(b){return"ALL"===a.paidStatus.value||"true"===a.paidStatus.value==b.paid},a.showAccordingPolicyStatuses=function(b){return"ALL"===a.policyStatus.value||a.policyStatus.value===b.status},this.fillTotalsReport=function(b){var c=b.reduce(function(b,c){return b.totalPrice+=c.paid&&a.show(c)?c.price:0,b.totalPartnerRevenue+=a.getRiskmarketRevenue(c.paid&&a.show(c),c.price),b},{totalPrice:0,totalRiskmarketRevenue:0});a.overallPrice={"int":Math.floor(c.totalPrice),"float":c.totalPrice%1},a.overallRiskmarketRevenue={"int":Math.floor(c.totalRiskmarketRevenue),"float":c.totalRiskmarketRevenue%1}},this.updateCsvExportLink=function(b){a.downloadUrl=f.ADMIN_MONITOR.EXCEL+"/"+b},a.showConfirmDialog=function(b,c){if(b)window.alert("Полис уже отменен.");else{var d=window.confirm("Вы уверены, что хотите отменить этот полис?");d?(console.log("You pressed OK!"),a.cancelPolicy(c)):console.log("You pressed Cancel!")}},a.cancelPolicy=function(b){var d=c.defer(),e=a.cancelPolicyDestination+b,f=function(a,b){return i({method:"POST",url:a,headers:{status:"CANCELLED"},timeout:b.promise})};j.callMethod(f,[e,d]).then(function(b){b.status===k.NO_CONTENT&&window.info("There is no policy with such id"),a.showPaidInfo(a.chosenPeriod)},function(a){window.error("Could not change policy status!")})},a.showPaidInfo(a.chosenPeriod),this.updateCsvExportLink(f.ADMIN_MONITOR.EXCEL+"/"+a.chosenPeriod.value),this.fetchInsuranceTypes(),this.fetchInsuranceCompanies()}])}(),function(){"use strict";angular.module("partner",[])}(),function(){"use strict";var a=angular.module("partner");a.controller("PartnerController",["$scope","$log","$q","soldItems","userAuth","REST_API","insuranceTypes","insuranceCompanies",function(a,b,c,d,e,f,g,h){var i=this;a.insuranceTypes=null,a.insuranceCompanies=null,this.partner=null,this.fetchPartnerData=function(){return e.getPartnerData().then(function(a){return b.debug("Partner data: ",a),i.partner=a,i.partner},function(a){return b.error("Unable to fetch partner data: ",a),c.reject(a)})},this.fetchInsuranceTypes=function(){g.getList().then(function(c){b.debug("Fetched insurance types: ",c),a.insuranceTypes=c},function(a){b.error("Unable to fetch insurance types: ",a)})},this.fetchPaidData=function(e){return d.soldItemsDataAll(e.value).$promise.then(function(c){return a.soldItems=c.data,b.debug("Received sold items: ",a.soldItems),a.soldItems},function(a){return b.error("Error while trying to fetch info about sold items: ",a),c.reject(a)})},this.fetchInsuranceCompanies=function(){h.getList().then(function(c){b.debug("Fetched insurance companies: ",c),a.insuranceCompanies=c.content},function(a){b.error("Unable to fetch insurance companies list: ",a)})},a.soldItems=[],a.overallPrice=0,a.overallPartnerRevenue=0,a.periods=[{value:"DAY",label:"Сегодня"},{value:"YESTERDAY",label:"Вчера"},{value:"MONTH",label:"Текущий месяц"},{value:"ALL",label:"За все время"}],a.getInsuranceType=function(b){return a.insuranceTypes&&b in a.insuranceTypes?a.insuranceTypes[b]:""},a.getInsuranceCompanyName=function(b){var c="";if(a.insuranceCompanies){var d=_.find(a.insuranceCompanies,{code:b});c=d?d.nameRus:c}return c},a.getPartnerRevenue=function(a,c){var d=0;if(i.partner&&i.partner.active){var e=i.partner.insuranceTypeDatas[a];d=e?e.commission/100*c:d,e||b.warn("Partner does not have a commission for that type of policy")}return d},this.setChosenPeriod=function(b){a.chosenPeriod=angular.copy(b)},this.setChosenPeriod(a.periods[0]),a.periodIsChosen=function(b){return a.chosenPeriod.value===b.value},a.showPaidInfo=function(d){i.setChosenPeriod(d),c.all([i.fetchPartnerData(),i.fetchPaidData(d)]).then(function(){i.fillTotalsReport(a.soldItems),i.updateCsvExportLink(d.value)},function(a){b.error("Unable to fill totals report data: ",a)})},a.getTotalSoldItems=function(){return a.soldItems.length},this.fillTotalsReport=function(b){var c=b.reduce(function(b,c){return b.totalPrice+=c.price,b.totalPartnerRevenue+=a.getPartnerRevenue(c.insuranceTypeCode,c.price),b},{totalPrice:0,totalPartnerRevenue:0});a.overallPrice={"int":Math.floor(c.totalPrice),"float":c.totalPrice%1},a.overallPartnerRevenue={"int":Math.floor(c.totalPartnerRevenue),"float":c.totalPartnerRevenue%1}},this.updateCsvExportLink=function(b){a.downloadUrl=f.ADMIN_MONITOR.CSV+"/"+b},a.showPaidInfo(a.chosenPeriod),this.updateCsvExportLink(f.ADMIN_MONITOR.CSV+"/"+a.chosenPeriod.value),this.fetchInsuranceTypes(),this.fetchInsuranceCompanies()}])}(),function(){"use strict";angular.module("partnerLogin",[])}(),function(){"use strict";var a=angular.module("partnerLogin");a.controller("partnerLoginController",["$scope","$log","userAuth","ROUTES","manageLocation","REGEXP","USER_TYPES","WARNINGS","formHelper",function(a,b,c,d,e,f,g,h,i){var j=this;a.regexp=f,a.feedBack="",a.loginError=!1,a.userType=g.PARTNER,this.goToCabinet=function(){e.redirect(d.PARTNER)};var k=c.getCurrentUser().value;return k&&k.userType===g.PARTNER?void j.goToCabinet():(a.submit=function(){c.login(a.formData.userName,a.formData.password,!a.formData.alienComputer,a.userType).then(function(){a.loginError=!1,a.feedBack="",j.goToCabinet()},function(c){b.error("Can not login. Reason: ",c),a.loginError=!0,a.feedBack=h.LOGIN_FORM.LOGIN_ERROR})},void(a.showpassword=function(a){i.togglePasswordDisplay(a)}))}])}(),function(){"use strict";angular.module("comparePolicies",["registry"])}(),function(){"use strict";var a=angular.module("comparePolicies");a.controller("ComparePoliciesController",["$scope","manageLocation","orderManager","dataStorage","ROUTES","CURRENCY_SYMBOLS","CACHE_ITEMS","$log","EVENTS","VENDOR_COMPANIES",function(a,b,c,d,e,f,g,h,i,j){var k=this;a.sortData={order:""},a.comparedPoliciesList=angular.fromJson(d.getData(g.COMPARED_POLICIES))||[],a.searchResultsLink=e.SEARCH_RESULTS,this.getCompareParamData=function(b){return _.isArray(a.compareParams)?_.find(a.compareParams,{paramName:b})||null:null},this.cacheInsuranceParams=function(a){c.storeInsuranceParams(a)},this.fetchInsuranceParams=function(){var a=c.getInsuranceParams(!0);return a||(a={passengers:[],period:{"start-date":"","end-date":""},country:[]},k.cacheInsuranceParams(a)),c.getInsuranceParams()},a.insuranceParams=this.fetchInsuranceParams(),a.insuranceParams.riskFilters=a.insuranceParams.riskFilters||{},a.insuranceParams.specialTermFilters=a.insuranceParams.specialTermFilters||[],a.launchCalculation=function(a){k.cacheInsuranceParams(a),b.redirect(e.SEARCH_RESULTS)},this.polyfillSameValue=function(a){var b=/^[0_]|OPTIONAL|NOT_INCLUDED$/i;return"object"==typeof a?a.riskStatus=b.test(a.riskStatus)?"NOT_INCLUDED":a.riskStatus:a=b.test(a)?"NOT_INCLUDED":a,a},a.matchesFilter=function(b,c){if(!a.sortData.order||b.showAlways||b.match&&b.match.paramName)return!0;if(_.isArray(c)&&c.length){if(b.match=b.match||{},_.isArray(b.children))b.match.paramName=b.children.some(function(b){var d=k.getCompareParamData(b);return a.matchesFilter(d,c)});else{var d=c[0],e=b.paramGroup?a.getSubRisk(b,d):a.getPolicyParamValue(b,d);b.match.paramName=1==c.length||c.some(function(c){var d=b.paramGroup?a.getSubRisk(b,c):a.getPolicyParamValue(b,c);return d=k.polyfillSameValue(d),e=k.polyfillSameValue(e),!angular.equals(d,e)})}return b.match.paramName}return!1},this.resetFilterValues=function(){a.paramFilterValues=[{label:"различающиеся",value:"differing"},{label:"все",value:void 0}]},this.resetFilterValues(),a.byPolicyItem=function(a){c.createOrderDraft(a),c.storeInsuranceChoice(a),b.redirect(e.ORDER_PREPARE)},this.clearComparedParamsMatchCache=function(){a.compareParams.forEach(function(a){delete a.match})},a.removeItemFromComparison=function(b){_.remove(a.comparedPoliciesList,{calculationId:b.calculationId,totalPrice:b.totalPrice}),k.clearComparedParamsMatchCache(),d.setData(g.COMPARED_POLICIES,angular.toJson(a.comparedPoliciesList)),a.$broadcast(i.BLOCK_DYNAMIC_RESIZE.RESET_DUMMY)},a.vendorIconClass=function(a){var b,c=j,d=Object.keys(c)[0];try{b=a.serviceCompany.companyCode}catch(e){b=d}return b in c?c[b]:c[d]},a.currencySymbols=f,a.compareParams=[{paramName:"insuranceCompany",displayName:"Страховщик",showAlways:!0},{paramName:"insuranceProgramName",displayName:"Программа",paramPath:"calculationDataInput.insuranceProgramName",showAlways:!0},{paramName:"totalPrice",displayName:"Стоимость",showAlways:!0},{paramName:"termDays",displayName:"Застраховано дней",paramPath:"calculationDataInput.travelData.period.termDays",showAlways:!0},{paramName:"tripsNum",displayName:"Количество поездок",showAlways:!0},{paramName:"daysInTrip",displayName:"Макс. дней в одной поездке",paramPath:"calculationDataInput.travelData.period.daysInTrip",showAlways:!0},{paramName:"territoryDisplayName",displayName:"Территория страхования",paramPath:"calculationDataInput.territoryDisplayName",showAlways:!0},{paramName:"vendorCompany",displayName:"Сервисная компания",showAlways:!0},{paramName:"medicalExpenses",displayName:"Медицинская помощь и экстренные расходы",paramsTitle:!0,showAlways:!0,paramGroup:"medical-primary"},{paramName:"urgentHelp",displayName:"Неотложная помощь",paramGroup:"medical",paramKey:"URGENT_HELP"},{paramName:"medicalDrugs",displayName:"Медицинские препараты и средства",paramGroup:"medical",paramKey:"MEDICAL_DRUGS"},{paramName:"diagnosis",displayName:"Диагностирование",paramGroup:"medical",paramKey:"DIAGNOSIS"},{paramName:"outPatientTreatment",displayName:"Амбулаторное лечение",paramGroup:"medical",paramKey:"OUT_PATIENT_TREATMENT"},{paramName:"indoorTreatment",displayName:"Стационарное лечение",paramGroup:"medical",paramKey:"INDOOR_TREATMENT"},{paramName:"surgery",displayName:"Хирургия",paramGroup:"medical",paramKey:"SURGERY"},{paramName:"extraDentalTreatment",displayName:"Экстренная стоматология",paramGroup:"medical",paramKey:"EXTRA_DENTAL_TREATMENT"},{paramName:"medicalTransportation",displayName:"Перевозка больного в месте пребывания",paramGroup:"medical",paramKey:"MEDICAL_TRANSPORTATION"},{paramName:"transportHome",displayName:"Перевозка больного домой",paramGroup:"medical",paramKey:"TRANSPORT_OF_PATIENT_HOME"},{paramName:"bodyRepatriation",displayName:"Посмертная репатриация",paramGroup:"medical",paramKey:"BODY_REPATRIATION"},{paramName:"returnDelay",displayName:"Задержка возвращения",paramGroup:"medical",paramKey:"RETURN_DELAY"},{paramName:"bringChildrenHome",displayName:"Возвращение детей домой",paramGroup:"medical",paramKey:"BRING_CHILDREN_BACK_HOME"},{paramName:"thirdPartyVisit",displayName:"Визит родственника или третьего лица",paramGroup:"medical",paramKey:"THIRD_PARTY_VISIT"},{paramName:"prescheduleReturn",displayName:"Досрочное возвращение",paramGroup:"medical",paramKey:"PRESCHEDULE_RETURN"},{paramName:"transportExpenses",displayName:"Временное возвращение",paramGroup:"medical",paramKey:"TRANSPORT_EXPENSES"},{paramName:"urgentMessages",displayName:"Оплата срочных сообщений",paramGroup:"medical",paramKey:"URGENT_MESSAGES"},{paramName:"lostOrStolenDocuments",displayName:"Потеря или хищение документов",paramGroup:"medical",paramKey:"LOST_OR_STOLEN_DOCUMENTS"},{paramName:"searchAndRescue",displayName:"Поисково-спасательные работы",paramGroup:"medical",paramKey:"SEARCH_AND_RESCUE"},{paramName:"legalHelp",displayName:"Юридическая помощь и консультации",paramGroup:"medical",paramKey:"LEGAL_HELP"},{paramName:"flightDelay",displayName:"Задержка рейса",paramGroup:"global",paramKey:"FLIGHT_DELAY"},{paramName:"brokenCar",displayName:"Проблемы с автомобилем",paramGroup:"global",paramKey:"BROKEN_CAR"},{paramName:"additionalExpenses",displayName:"Иные расходы",paramGroup:"medical",paramKey:"ADDITIONAL_EXPENSES"},{paramName:"extraOptions",displayName:"Опции",paramsSubTitle:!0,children:["activeRest","sport","sportCompetitions","extremeSport","luggage","tripCancel","personalLiability","accident"]},{paramName:"activeRest",displayName:"Активный отдых",paramGroup:"options",paramKey:"ACTIVE_REST"},{paramName:"sport",displayName:"Любительский спорт",paramGroup:"options",paramKey:"SPORT"},{paramName:"sportCompetitions",displayName:"Соревнования и сборы",paramGroup:"options",paramKey:"SPORT_COMPETITIONS"},{paramName:"extremeSport",displayName:"Экстремальный спорт",paramGroup:"options",paramKey:"EXTREME_SPORT"},{paramName:"luggage",displayName:"Багаж",paramGroup:"global",paramKey:"LUGGAGE"},{paramName:"tripCancel",displayName:"Отмена поездки",paramGroup:"global",paramKey:"TRIP_CHANGE_OR_CANCELLATION"},{paramName:"personalLiability",displayName:"Гражданская ответственность",paramGroup:"global",paramKey:"PERSONAL_LIABILITY"},{paramName:"accident",displayName:"Несчастный случай",paramGroup:"global",paramKey:"ACCIDENT"}],a.getPolicyParamValue=function(a,b){return _.get(b,a.paramPath)||""},a.riskStatuses={included:"INCLUDED",optional:"OPTIONAL",notIncluded:"NOT_INCLUDED"},a.getSubRisk=function(a,b){try{switch(a.paramGroup){case"global":return b.calculationDataInput.riskAliasMap[a.paramKey];case"medical":return b.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.subRisks[a.paramKey];case"medical-primary":return b.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.risk.sumInsured;case"options":return b.calculationDataInput.options[a.paramKey]}}catch(c){return h.warn("Did not manage to determine policy parameter group: ",c),""}}}])}(),angular.module("riskMarket.templates",[]).run(["$templateCache",function(a){"use strict";a.put("modules/admin/monitor/partials/monitor.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><div class="container-content-primary admin-monitor admin-monitor-advanced"><h2 class="admin-monitor-header">Личный кабинет администратора</h2><section class="control-panel"><div class="view-modes-container"><h3 class="content-title">Заказы за</h3><ul class="view-modes"><li class="view-mode" data-ng-repeat="period in periods" data-ng-class="{\'view-mode-active\': periodIsChosen(period)}" data-ng-click="showPaidInfo(period)"><span data-ng-bind="period.label"></span></li></ul></div><div class="view-modes-container"><h3 class="content-title">Статус оплаты</h3><ul class="view-modes"><li class="view-mode" data-ng-repeat="paidStatus in paidStatuses" data-ng-class="{\'view-mode-active\': paidStatusIsChosen(paidStatus)}" data-ng-click="setPaidStatus(paidStatus)"><span data-ng-bind="paidStatus.label"></span></li></ul></div><div class="view-modes-container"><h3 class="content-title">Статус полиса</h3><ul class="view-modes"><li class="view-mode" data-ng-repeat="policyStatus in policyStatuses" data-ng-class="{\'view-mode-active\': policyStatusIsChosen(policyStatus)}" data-ng-click="setPolicyStatus(policyStatus)"><span data-ng-bind="policyStatus.label"></span></li></ul></div><div class="brief"><div class="brief-info-chunk"><span class="brief-info-topic">Всего<br>полисов:</span><output class="brief-info-details"><span class="brief-info-primary-value" data-ng-bind="getTotalSoldItems()"></span></output></div><div class="brief-info-chunk"><span class="brief-info-topic">Продано<br>на:</span><output class="brief-info-details"><span class="brief-info-primary-value" data-ng-bind="overallPrice.int | number: 0 | numdivider: \',\' : \' \'"></span> <span class="brief-info-secondary-value" data-ng-bind="overallPrice.float * 100 | number: 0"></span> <span class="brief-info-value-dimension">a</span></output></div><div class="brief-control"><a class="btn btn-white-transparent" data-ng-href="{{downloadUrl}}" target="_blank">Скачать отчет</a></div></div></section><div class="details-panel"><div class="details-header"><h5 class="subject-title col-smaller">Номер<br>заказа</h5><h5 class="subject-title col-smaller">Дата<br>продажи</h5><h5 class="subject-title col-larger">Канал<br>продаж</h5><h5 class="subject-title col-smaller">Вид<br>страхования</h5><h5 class="subject-title col-larger">Страховщик</h5><h5 class="subject-title col-larger">Номер<br>полиса</h5><h5 class="subject-title col-largest">Электропочта<br>клиента</h5><h5 class="subject-title col-smaller">Дата<br>начала</h5><h5 class="subject-title col-smaller">Дата<br>окончания</h5><h5 class="subject-title col-smaller">Стоимость<br>полиса</h5><h5 class="subject-title col-smaller">Оплачен</h5><h5 class="subject-title col-smaller">Отправлен</h5><h5 class="subject-title col-smaller">Аннулирован</h5><h5 class="subject-title col-smaller">Статус</h5></div><div class="detail-item" data-ng-repeat="item in soldItems | orderBy:\'-orderId\'" data-ng-show="show(item)"><span class="detail-item-param col-smaller" data-ng-bind="item.orderId"></span> <span class="detail-item-param col-smaller" data-ng-bind="item.creationDate | date:\'dd.MM.yyyy\'"></span> <span class="detail-item-param col-larger" data-ng-bind="item.soldBy"></span> <span class="detail-item-param col-smaller" data-ng-bind="item.insuranceTypeCode"></span> <span class="detail-item-param col-larger" data-ng-bind="item.insuranceCompany"></span> <span class="detail-item-param col-larger"><a target="_self" data-ng-href="{{site + \'/\' + item.policyLink}}">{{item.policyNumber}}</a></span> <span class="detail-item-param col-largest" data-ng-bind="item.clientEmail"></span> <span class="detail-item-param col-smaller" data-ng-bind="item.startDate"></span> <span class="detail-item-param col-smaller" data-ng-bind="item.endDate"></span> <span class="detail-item-param detail-item-param-important col-smaller" data-ng-bind="item.price | number: 2 | numdivider: \',\' : \' \'"></span> <span class="detail-item-param col-smaller" data-ng-bind="toRusString(item.paid)"></span> <span class="detail-item-param col-smaller" data-ng-bind="toRusString(item.sent)"></span> <span class="detail-item-param col-smaller" data-ng-bind="toRusString(item.cancelled)" data-ng-click="showConfirmDialog(item.cancelled, item.policyId)"></span> <span class="detail-item-param col-smaller" data-ng-bind="item.status" data-ng-class="{\'view-mode-ok\': item.status === \'OK\', \'view-mode-alarm\': item.status === \'ALARM\'}"></span></div></div></div></div>'),
a.put("modules/compare-policies/partials/compare-policies.html",'<div class="container-fluid container-wrapper container-wrapper-darker compare-policies-container"><div data-search-query data-data="insuranceParams" data-action="launchCalculation(data);" data-action-allowed="true" class="search-query-container"></div><div class="filter-container filter-light compare-policies-params-panel" data-filter-container><div class="filter-wrapper"><div class="dummy-block"></div><div class="filtered-items-number">Сравнение <span data-ng-bind-template="{{ comparedPoliciesList.length }} {{ comparedPoliciesList.length | quantitySuffix : \'страхов\' : [\'ки\', \'ок\', \'ок\'] }}"></span></div><div class="filter-area params-filter"><span class="item-label">Параметры</span><div class="user-input-widget" data-user-input-list data-target-model="sortData.order" data-values="paramFilterValues" data-view-prop="label" data-ignore-events="true" data-model-prop="value"></div></div></div></div><div class="compare-policies-wrapper" data-overlay-scroll-emitter data-overlay-scroll-handler data-container-content-width="1130" data-inner-content-block="compare-policies-list"><div class="compare-policies-list" data-ng-if="comparedPoliciesList.length" data-fix-cloned-content="top-fixed-el" data-fix-cloned-content-parent="compare-policies-wrapper"><div class="flex-container" data-ng-repeat="param in compareParams" data-ng-show="matchesFilter(param, comparedPoliciesList)" data-ng-class="{ \'top-fixed-el\': param.paramName === \'insuranceCompany\' || param.paramName === \'insuranceProgramName\' || param.paramName === \'totalPrice\' }"><div class="params-row-header bordered" data-ng-class="{\n'+"\t\t\t\t\t\t      'align-bottom': param.paramName === 'insuranceCompany' || param.paramName === 'totalPrice',\n\t\t\t\t\t\t      'params-group-header': param.paramsTitle,\n\t\t\t\t\t\t      'params-group-subheader': param.paramsSubTitle,\n\t\t\t\t\t\t      'no-border': param.paramName === 'insuranceCompany' || param.paramName === 'insuranceProgramName' || param.paramName === 'vendorCompany' || param.paramName === 'totalPrice'  || param.paramName === 'medicalExpenses' || param.paramName === 'extraOptions',\n\t\t\t\t\t\t      'no-border subgroup-param': param.paramName === 'urgentHelp' || param.paramName === 'activeRest',\n\t\t\t\t\t\t      'vendor-company': param.paramName === 'vendorCompany'\n\t\t\t\t\t\t     }\"><div class=\"param-name\" data-ng-bind=\"param.displayName\" data-ng-class=\"{ 'bordered item-price-header': param.paramName === 'totalPrice' }\"></div></div><div data-ng-repeat=\"item in comparedPoliciesList\" class=\"item-values bordered\" data-ng-class=\"{ 'no-border': param.paramName === 'insuranceCompany' || param.paramName === 'insuranceProgramName' || param.paramName === 'vendorCompany' || param.paramName === 'totalPrice'  || param.paramName === 'medicalExpenses' || param.paramName === 'extraOptions',\n\t\t\t\t      'no-border subgroup-param': param.paramName === 'urgentHelp' || param.paramName === 'activeRest',\n\t\t\t\t      'vendor-company': param.paramName === 'vendorCompany'\n\t\t\t\t      }\"><div data-ng-if=\"param.paramName === 'insuranceCompany'\" class=\"param-value program-descr\"><span data-ng-bind-template=\"{{ item.calculationDataInput.travelData.period.multi ? 'Многократный' : 'Однократный' }}&nbsp;полис, \"></span><br><span>страховая сумма<br></span> <span data-ng-bind-template=\"{{ (item.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.risk.sumInsured | number: 0 | numdivider: ',' : ' ') }}\"></span> <span class=\"currency\" data-ng-bind=\"currencySymbols[item.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.risk.currency]\"></span></div><div data-ng-bind=\"getPolicyParamValue(param, item)\" class=\"param-value\" data-bg-image=\"{\n\t\t\t\t\t\t\t\t\ttemplate: 'vendorCompany',\n\n\t\t\t\t\t\t\t\t\tfile: (param.paramName === 'insuranceCompany') ? item.insuranceCompany.registeredService.toLowerCase() : (param.paramName === 'vendorCompany') ? item.serviceCompany.companyCode.toLowerCase() : ''\n\t\t\t\t\t\t\t\t}\" data-ng-class=\"{\n\t\t\t\t\t\t     'compared-item-insurer-logo' : param.paramName === 'insuranceCompany',\n\t\t\t\t\t\t     'program-territory' : param.paramName === 'territoryDisplayName',\n\t\t\t\t\t\t     'vendor-logo': param.paramName === 'vendorCompany',\n\t\t\t\t\t\t     'program-name': param.paramName === 'insuranceProgramName'\n\t\t\t\t\t\t     }\"></div><div data-ng-if=\"param.paramName === 'totalPrice'\"><button class=\"btn btn-green btn-buy\" data-ng-click=\"byPolicyItem(item)\" data-action-item>Купить</button> <button class=\"btn btn-grey-transparent action-delete\" data-ng-click=\"removeItemFromComparison(item)\" data-action-item>Удалить</button><div class=\"bordered item-price\"><span class=\"currency-base\" data-ng-bind=\"(item.priceContainer.integralPart | number: 0 | numdivider: ',' : ' ')\"></span> <span class=\"currency-fraction\" data-ng-bind=\"item.priceContainer.fractionalPart\"></span> <span class=\"currency currency-symbol\" data-ng-bind=\"currencySymbols['RUB']\"></span></div></div><div data-ng-if=\"param.paramName === 'tripsNum'\" class=\"param-value\"><span data-ng-show=\"item.calculationDataInput.travelData.period.multi\" class=\"infinity\">&infin;</span> <span data-ng-show=\"!item.calculationDataInput.travelData.period.multi\">1</span></div><div class=\"param-value params-group-header\" data-ng-if=\"param.paramName === 'medicalExpenses'\"><span data-ng-bind-template=\"{{ (getSubRisk(param, item) | number: 0 | numdivider: ',' : ' ') }}\"></span> <span class=\"value-currency\" data-ng-bind-template=\" {{ currencySymbols[item.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.risk.currency] }}\"></span></div><div class=\"param-value value excluded\" data-ng-if=\"param.paramGroup === 'medical' || param.paramGroup === 'global'\" data-ng-class=\"{ 'included': getSubRisk(param, item).riskStatus === riskStatuses.included, 'sum-insured': getSubRisk(param, item).risk && getSubRisk(param, item).risk.sumInsured }\"><span data-ng-bind=\"getSubRisk(param, item).risk.sumInsured | number: 0 | numdivider: ',' : ' '\"></span> <span class=\"value-currency\" data-ng-bind-template=\"{{ getSubRisk(param, item).risk && getSubRisk(param, item).risk.sumInsured ? currencySymbols[getSubRisk(param, item).risk.currency] : ' ' }}\"></span></div><div class=\"param-value value excluded\" data-ng-if=\"param.paramGroup === 'options'\" data-ng-class=\"{ 'included': getSubRisk(param, item) }\"></div><div class=\"param-value params-group-subheader\" data-ng-if=\"param.paramName === 'extraOptions'\"></div></div></div></div><p data-ng-if=\"!comparedPoliciesList.length\">Нет страховок для сравнения</p></div></div>"),a.put("modules/inner-pages/partials/about-service-page.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><article class="container-content inner-page"><header><h1 class="inner-page-header">Сервис онлайн-страхования</h1></header><section class="intro-block"><p class="inner-page-intro-text">RiskMarket.ru даёт возможность на одном сайте рассчитать,<br>выбрать и купить страховки на разные случаи жизни прямо<br>у ведущих страховых компаний.</p></section><section class="flex-container inner-page-block"><div class="inner-page-block-name choice"><header><h3 class="inner-page-block-header">Большой выбор<br>Гарантия цены</h3></header></div><div class="inner-page-block-content"><p>RiskMarket.ru имеет прямые подключения к сервисам страховых компаний и, отвечая на запросы пользователей, предоставляет множество актуальных вариантов страховых продуктов.</p><p>Полис медицинского страхования выезжающих за рубеж, страховка имущества или ответственности, договор страхования жизни и здоровья &mdash; их стоимость будет такая же, как в страховой компании. А порой ниже за счёт специальных бонусных программ для постоянных пользователей.</p></div></section><section class="flex-container inner-page-block"><div class="inner-page-block-name payment"><header><h3 class="inner-page-block-header">Удобная безопасная покупка</h3></header></div><div class="inner-page-block-content"><p>Для поиска подходящей страховки сервис предлагает воспользоваться системой фильтров и сортировок, а подробное описание условий, рейтинги и отзывы клиентов помогут сделать окончательный выбор.</p><p>Для покупки полиса останется лишь ввести необходимые данные, оплатить привычным способом и получить полис на e-mail.</p><h4 class="inner-page-block-subheader">Передача данных защищена</h4><p>Онлайн-покупка нуждается в надёжном канале связи. RiskMarket.ru обеспечивает его, используя специальный SSL-сертификат. Он позволяет организовать шифрование передаваемой информации, подтвердить подлинность сайта и его владельца, обеспечить защиту данных от подмены в процессе передачи по сети.</p><h4 class="inner-page-block-subheader">Популярный способ оплаты</h4><p>Оплата полиса на сайте осуществляется банковскими картами – самым популярным способом оплаты в Интернете. Платёжный сервис отвечает требованиям Центробанка РФ о защите информации о платежах.</p></div></section><section class="flex-container inner-page-block"><div class="inner-page-block-name safekeeping"><header><h3 class="inner-page-block-header">Надёжное хранение полисов</h3></header></div><div class="inner-page-block-content"><p>После оплаты информация о проданном полисе незамедлительно записывается в базе страховой компании. RiskMarket.ru направляет купленный полис, оформленный в электронном виде, на указанный пользователем адрес электронной почты. В дальнейшем его можно распечатать и предъявить для подтверждения заключения страхового договора.</p><p>Кроме того, на сервисе для пользователя создается личный кабинет, в котором сохраняется история покупок, и откуда всегда можно распечатать необходимую страховку.</p></div></section><section class="final-block"><a href="/" class="final-block-link">Покупайте страховки онлайн на RiskMarket.ru!</a></section></article></div>'),a.put("modules/inner-pages/partials/contacts-page.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><article class="container-content inner-page"><header><h1 class="inner-page-header">Контактная информация</h1></header><section class="flex-container contact-mails"><div><h4>Поддержка клиентов:</h4><a class="contact-link" href="mailto:help@riskmarket.ru">help@riskmarket.ru</a></div><div><h4>Общие вопросы:</h4><a class="contact-link" href="mailto:info@riskmarket.ru">info@riskmarket.ru</a></div><div><h4>Для партнеров:</h4><a class="contact-link" href="mailto:partner@riskmarket.ru">partner@riskmarket.ru</a></div></section><section class="flex-container inner-page-block rm-account-block"><div class="inner-page-block-name rm-account"><header><h3 class="inner-page-block-header">Общество с ограниченной ответственностью «РискМаркет»</h3></header></div><div class="inner-page-block-content"><div class="rm-account-details"><div class="flex-container"><div class="account-detail-name">ОГРН</div><div class="account-detail-value">1157847408113</div></div><div class="flex-container"><div class="account-detail-name">ИНН</div><div class="account-detail-value">7801295503</div></div><div class="flex-container"><div class="account-detail-name">КПП</div><div class="account-detail-value">780101001</div></div><div class="flex-container"><div class="account-detail-name">Юр. адрес</div><div class="account-detail-value">199106, Санкт-Петербург, Средний проспект В.О., дом 76/18, литера А, пом.1-Н, тел. 8&nbsp;(499)&nbsp;350-95-63</div></div><div class="flex-container"><div class="account-detail-name">БИК</div><div class="account-detail-value">044030811</div></div><div class="flex-container"><div class="account-detail-name">Банк</div><div class="account-detail-value">Филиал № 7806 ВТБ 24 (ПАО)</div></div><div class="flex-container"><div class="account-detail-name">р/с</div><div class="account-detail-value">40701810929260001835</div></div><div class="flex-container"><div class="account-detail-name">к/с</div><div class="account-detail-value">30101810300000000811</div></div></div></div></section></article></div>'),a.put("modules/inner-pages/partials/terms-page.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><article class="container-content inner-page terms-page"><header><h1 class="inner-page-header">Пользовательское соглашение</h1></header><section class="inner-page-block"><p>ООО «РискМаркет» (далее – РискМаркет) предлагает пользователю сети Интернет использовать сервис «RiskMarket страхование онлайн» (далее – RiskMarket или Сервис) для онлайн покупки страховых полисов непосредственно у представленных на сервисе страховых компаний.</p><p>Пользуясь RiskMarket, пользователь принимает требования и положения настоящего Пользовательского соглашения (далее - Соглашение), которое распространяется на сайт www.riskmarket.ru и на сайты субагентов, использующих программное обеспечение РискМаркета (далее - Сайтах).</p><p>На RiskMarket пользователям доступна информационно-справочная система, которая содержит информацию о страховых полисах по разным видам страхования (далее – Полис), предназначенную для потенциальных покупателей Полисов (страхователей). Информация о Полисах, представленная на Сервисе, основана на информации, предоставленной страховыми компаниями.</p><p>На RiskMarket пользователю даётся возможность оформления Полиса в страховой компании, его оплаты и получения в электронном виде на свой адрес электронной почты.</p><p>До момента оформления Полиса на Сервисе пользователь обязуется ознакомиться со всеми условиями приобретения Полиса, условиями и правилами страхования страховых компаний.</p><p>Все страховые компании, представленные на RiskMarket имеют соответствующие действующие лицензии на осуществление страхования, выданные Центральным Банком Российской Федерации.</p><p>При покупке Полиса на Сервисе пользователь заключает договор страхования непосредственно со страховой компанией, чей Полис покупается, и вступает с ней в прямые договорные отношения. Покупка Полиса на RiskMarket означает согласие пользователя со всеми существенными условиями и правилами страховой компании.</p><p>Условия и правила страхования являются неотъемлемой частью покупаемого Полиса и доступны для свободного ознакомления в описании Полиса до момента покупки.</p><p>Все права и обязательства по заключённому со страховой компанией договору возникают непосредственно у страховой компании. Для решения вопросов по предоставлению страховых услуг в рамках приобретённых на Сервисе Полисов (оказание экстренной помощи при наступлении страховых событий, подача соответствующих обращений и заявлений, другие действия, связанные с урегулированием страховых случаев) необходимо обращаться в страховую компанию, чей Полис приобретён. Контакты и адреса страховых компаний для урегулирования страховых случаев доступны на RiskMarket без дополнительных регистраций, а также эту информацию пользователь получает на свой адрес электронной почты после покупки вместе с Полисом в электронном виде.</p><p>Для того чтобы воспользоваться услугой покупки Полиса онлайн на RiskMarket, пользователь соглашается предоставить правдивую, точную и полную информацию о себе, а также о третьих лицах, которых он желает застраховать, (далее – Третьи лица), по вопросам, предлагаемым в форме заказа Полиса, а также с тем, что электронная почта пользователя и его иные идентификационные данные являются аналогом собственноручной подписи пользователя.</p><p>Покупая Полис, пользователь подтверждает, что полностью ознакомился с положениями настоящего Соглашения, полностью понимает их, а также понимает предмет и условия заключаемого со страховой компанией договора, полностью понимает значение и последствия своих действий в рамках условий и правил страхования.</p><p>Пользователь подтверждает, что является дееспособным физическим лицом, имеющим право заключать договоры страхования в отношении себя и лиц, указанных пользователем на Сайтах.</p><p>Пользователь подтверждает, что согласие Третьих лиц на передачу и обработку их персональных данных РискМаркету пользователем получено в порядке, предусмотренном Федеральным законом от 27.07.2006 №152-ФЗ «О персональных данных».</p><p>В соответствии с настоящим Соглашением пользователь даёт своё согласие и согласие всех лиц, указанных пользователем на Сайтах, ООО «РискМаркет» (199106, Санкт-Петербург, Средний проспект В.О., дом 76/18, литера А, пом 1-Н, ИНН 7801295503) и страховым компаниям, чей Полис приобретается, на обработку любой информации (Персональных данных), введенной пользователем в форму заказа Полиса на Сайтах, включая, без ограничения: сбор, систематизацию, накопление, хранение, уточнение (обновление, изменение), использование, распространение (в том числе передачу), обезличивание, блокирование, уничтожение, а также осуществление любых иных действий с персональными данными пользователя с учетом действующего законодательства, в течение срока договорных отношений, связанных со страхованием, и в течение 5 (Пяти) лет после окончания срока действия этих договорных отношений, и подтверждает, что, давая такое согласие, пользователь действует по своей воле и в своём интересе и интересах Третьих лиц.</p><p>Целью обработки персональных данных является формирование (разработка), заключение, исполнение договора страхования, а также информирование об оказываемых РискМаркетом услугах, изменениях тарифов и новых продуктах, в том числе разработанных с участием партнеров РискМаркета, включая, но не ограничиваясь информированием посредством коротких сообщений (SMS) на указанный пользователем телефонный номер.</p><p>Своим согласием пользователь предоставляет право РискМаркету на осуществление любых действий в отношении предоставленных пользователем своих персональных данных и Третьих лиц, предусмотренных Законом и/или выбранных по усмотрению РискМаркетом, которые необходимы или желаемы для достижения указанных выше целей. Пользователь может отозвать свое согласие на обработку персональных данных в любое время путем направления в РискМаркет письменного и подписанного уведомления.</p><p>Настоящим согласием пользователь признаёт и подтверждает, что в случае необходимости предоставления Персональных данных для достижения указанных выше целей третьему лицу, а равно как при привлечении третьих лиц к оказанию услуг в указанных целях, РискМаркет вправе в необходимом объёме раскрывать для совершения вышеуказанных действий информацию о пользователе (включая Персональные данные) таким третьим лицам, их уполномоченным представителям, а также предоставлять таким лицам документы, содержащие такую информацию.</p><p>Покупая Полис, пользователь подтверждает, что осведомлён о том, что правила отказа от заключаемого с помощью Сайтов договора страхования (Полиса) закреплены в правилах страхования той компании, чей Полис приобретается.</p><p>Пользователь использует RiskMarket на свой собственный риск. Сервисы предоставляются «как есть». РискМаркет не принимает на себя никакой ответственности, в том числе за соответствие сервисов целям пользователя.</p><p>РискМаркет не несёт ответственности за любые виды убытков, произошедшие вследствие использования пользователем Сервиса и покупки Полисов.</p><p>При любых обстоятельствах ответственность РискМаркета в соответствии со статьей 15 Гражданского кодекса России ограничена 1000 (одной тысячью) рублей РФ и возлагается на него при наличии в его действиях вины.</p><p>РискМаркет в любое время без уведомления пользователя может изменять текст настоящего Соглашения, такие изменения вступают в силу с момента публикации.</p></section></article></div>'),a.put("modules/main-page/partials/about_page.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><acticle class="container-fluid container-content container-content-primary text-page"><header><hgroup><h1>О RiskMarket</h1></hgroup></header><section><table class="float-right"><tbody><tr><td><figure><img src="img/tmp/feature-1.gif"><figcaption>Широкий выбор программ от ведущих страховых компаний</figcaption></figure></td><td><figure><img src="img/tmp/feature-2.gif"><figcaption>Покупка полиса в любое время без посещения офиса</figcaption></figure></td></tr><tr><td><figure><img src="img/tmp/feature-3.gif"><figcaption>Удобная оплата всеми банковскими картами</figcaption></figure></td><td><figure><img src="img/tmp/feature-4.gif"><figcaption>Надёжное хранение всех полисов и оповещения о продлении</figcaption></figure></td></tr></tbody></table><p>В сети интернет по адресу RiskMarket.ru располагаются страховые онлайн-сервисы, позволяющие широкому кругу пользователей приобрести полисы страхования российских страховых компаний. С точки зрения продаж сайт, в первую очередь, предназначен для физических лиц. Корпоративные клиенты требуют отдельного рассмотрения.</p></section><section><header><hgroup><h3>На RiskMarket представлены:</h3></hgroup></header><ul><li>полный перечень страховых продуктов, предлагаемых на рынке страхования – имущественные виды страхования, страхование ответственности, личное страхование, накопительное страхование, добровольное и обязательное страхование, прочие виды. Для каждого продукта установлен свой набор параметров необходимых и достаточных для расчёта;</li><li>перечень всех страховых компаний с координатами (офисы продаж, отделы урегулирования убытков, списки партнёров – банки, СТОА, медучреждения, пр.), ссылками на их сайты, рейтинги (официальные, народные), другая полезная информация, касающаяся страховщиков;</li><li>базы действующих агентов и брокеров, предоставляющих услуги по оформлению полисов страхования.</li></ul></section><section><header><hgroup><h3>Потенциальным страхователям ресурс позволяет:</h3></hgroup></header><ul><li>подробно узнать о страховых продуктах, условиях страхования и страховых компаниях;</li><li>познакомиться с мнением других пользователей о компаниях и их услугах, а также с различного рода специальными рейтингами;</li><li>определиться, какой страховой полис необходим;</li><li>рассчитать стоимость полиса по индивидуальным параметрам в разных страховых компаниях;</li><li>сравнить предложения страховщиков;</li><li>сделать выбор подходящего варианта;</li><li>если покупка полиса онлайн возможна, то купить его прямо на RiskMarket, получив полис на свою электронную почту;</li><li>если купить онлайн нельзя, то перейти на сайт выбранной страховой компании или заполнить специальную заявку на страхование, разместить её среди продавцов и, после ознакомления с полученными предложениями, выбрать продавца для заключения договора;</li><li>получать бонусы за купленные на сервисе полисы, которые можно использовать для оплаты новых полисов;</li><li>посредством личного кабинета, контролировать и управлять своими полисами страхования (оплачивать очередные взносы, оформлять пролонгацию, держать свои данные, которые указываются в полисе, в актуальном состоянии и пр.), следить за своим бонусным счётом.</li></ul></section></acticle></div>'),a.put("modules/main-page/partials/main-page.html",'<div class="main-page"><div class="main-slider"><div class="slider-item trip-slide"><div><h2>Защита на любом континенте</h2><h3>Покупайте туристическую страховку у ведущих компаний онлайн</h3></div></div></div><div class="main-order-prepare"><table><tr><td><selectable-items data-params="{\n\t\t\t\t\t\t\t\t\tmode: \'full\',\n\n\t\t\t\t\t\t\t\t\tlabels: textLabels,\n\n\t\t\t\t\t\t\t\t\titemLabel: \'nameRus\',\n\n\t\t\t\t\t\t\t\t\tmaxItems: selectableItems.MAIN_PAGE_TRIP_ITEMS_LIMIT,\n\n\t\t              enableTips: true\n\t\t\t\t\t\t\t\t}" data-ng-model="formData.country" data-items="countries" data-uib-tooltip="Укажите страну" data-tooltip-placement="top" data-tooltip-trigger="none" data-tooltip-is-open="submitAttempt && !formData.country.length" data-tooltip-enable="submitAttempt && !formData.country.length"></selectable-items></td><td><participants-control data-participants="formData.passengers" data-max-participant-count="4" data-is-valid="validation.passengers" data-uib-tooltip="Укажите туристов" data-tooltip-placement="top" data-tooltip-trigger="manual" data-tooltip-is-open="submitAttempt && !validation.passengers && isParticipantWarningHidden" data-tooltip-enable="submitAttempt && !validation.passengers && isParticipantWarningHidden" data-lazy-update="true"></participants-control></td><td><period-control data-start="formData.period[\'start-date\']" data-finish="formData.period[\'end-date\']" data-is-valid="validation.period" data-uib-tooltip="Укажите даты" data-tooltip-placement="top" data-tooltip-trigger="none" data-tooltip-is-open="submitAttempt && (!formData.period[\'start-date\'] || !formData.period[\'end-date\'])" data-tooltip-enable="submitAttempt && (!formData.period[\'start-date\'] || !formData.period[\'end-date\'])"></period-control></td></tr><tr><td colspan="3" style="text-align:center"><button class="btn btn-success" data-ng-disabled data-ng-click="events.submitForm(formData);">Рассчитать полис</button></td></tr></table></div></div>'),a.put("modules/order-payment/partials/order-payment.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><div class="container-fluid container-content container-content-primary"><div class="actions-sequence"><div class="action-back"><a class="btn btn-grey-transparent" data-ng-href="{{searchResultsLink}}">К результатам поиска</a></div><ul class="items actions"><li class="action-sequence-step-wrapper visited"><a class="item action-sequence-step" data-ng-href="{{orderPrepareLink}}" data-sequence-title="Оформление">Оформление</a></li><li class="action-sequence-step-wrapper active"><a class="item action-sequence-step" href="#" data-dummy-link="" data-sequence-title="Оплата">Оплата</a></li><li class="action-sequence-step-wrapper"><a class="item action-sequence-step" href="#" data-dummy-link="" data-sequence-title="Получение">Получение</a></li></ul></div></div><div class="container-fluid container-content container-content-search-results container-content-order-draft"><div class="list-items"><search-result-item data-item="insuranceChoice" data-expand="expandItem" data-risk-options="riskOptions" data-config="{\n            showParamsButton: true\n        }" data-ng-class="{\'expanded-item\': insuranceChoice.expanded}"></search-result-item><section class="container-content-insured" data-ng-if="insuredBlockExpanded"><header class="page-header"><h2 class="subject-title subject-section-title">Застрахованные</h2></header><div class="items"><div class="item item-insured-person item-insured-person-attributes"><div class="item-component"><h4 class="subject-title subject-title-param">Дата рождения</h4></div><div class="item-component"><h4 class="subject-title subject-title-param">Фамилия</h4></div><div class="item-component"><h4 class="subject-title subject-title-param">Имя</h4></div><div class="item-component" data-ng-if="isInsuranceCompany(vtbCompany, currentCompany)"><h4 class="subject-title subject-title-param">Загранпаспорт</h4></div></div><div data-ng-class="{\'item-insured-person-terminator\': $last}" class="item item-insured-person" data-ng-repeat="insuredPerson in orderPreview.insuredPersons"><div class="item-component item-smaller"><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insuredPerson.birthDate"></span></div></div></div><div class="item-component"><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insuredPerson.surname"></span></div></div></div><div class="item-component"><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insuredPerson.name"></span></div></div></div><div class="item-component" data-ng-if="isInsuranceCompany(vtbCompany, currentCompany)"><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insuredPerson.internationalPassportSerialAndNumber"></span></div></div></div></div></div></section><section class="container-content-insured container-content-insurer" data-ng-if="insuredBlockExpanded"><header class="page-header"><h2 class="subject-title subject-section-title">Страхователь</h2></header><div class="items"><div class="item item-insured-person item-insured-person-insurer"><div class="items-inner-wrapper"><div class="item-component"><h4 class="subject-title">Дата рождения</h4><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="orderPreview.insurer.birthDate"></span></div></div></div><div class="item-component"><h4 class="subject-title">Фамилия</h4><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="orderPreview.insurer.lastName"></span></div></div></div><div class="item-component"><h4 class="subject-title">Имя</h4><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="orderPreview.insurer.firstName"></span></div></div></div></div><div class="items-inner-wrapper"><div class="item-component item-larger"><h4 class="subject-title">E-mail</h4><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input user-input-email" data-ng-bind="orderPreview.insurer.email"></span></div></div></div><div class="item-component"><h4 class="subject-title">Мобильный телефон</h4><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="orderPreview.insurer.phoneNumber"></span></div></div></div></div></div></div><div class="item-component item-component-switcher item-component-switcher-read-only user-agreement-switcher"><input type="checkbox" id="user-agreement" data-ng-disabled="true" data-ng-checked="true"><label for="user-agreement">Принимаю <a class="unblocked" target="{{linkTargetAttr}}" data-ng-href="{{site + insuranceChoice.links.linkToRules}}">условия страхования</a> и выражаю <a class="unblocked" target="{{linkTargetAttr}}" data-ng-href="{{personalDataAgreementLink}}">согласие на обработку персональных данных</a>.</label></div><div class="actions-section actions-section-edit"><button data-ng-click="editOrderDetails();" class="btn btn-green-transparent">Редактировать данные</button></div></section><div class="container-content-payment-wrapper"><div class="container-content-bonus-wrapper"><section class="container-content-bonus"><header class="page-header"><h2 class="subject-section-title">Бонусы и скидки</h2></header><div class="items"><div class="item"><h4 class="subject-title">Промокод</h4><div class="item-component"><div data-focus-styling="{class: \'focus\'}" class="user-input-element user-input-single-text"><input type="text"></div><button class="btn btn-green-transparent">Применить</button></div></div><div class="item"><h4 class="subject-title">Бонусы</h4><div class="item-component"><div data-focus-styling="{class: \'focus\'}" class="user-input-element user-input-single-text"><input type="text" placeholder="количество бонусов"></div><button class="btn btn-green-transparent">Использовать</button></div></div></div></section></div><section class="container-content-card-payment"><header class="page-header"><h2 class="subject-title subject-section-title col-xs-8">Безопасный платеж банковской картой на сумму <span class="card-payment-note">Оплата осуществляется через систему Яндекс.Деньги</span></h2><div class="item-price col-xs-4"><span class="currency-base" data-ng-bind="(insuranceChoice.priceContainer.integralPart | number: 0 | numdivider: \',\' : \' \')"></span> <span class="currency-fraction" data-ng-bind="insuranceChoice.priceContainer.fractionalPart"></span> <span class="currency currency-symbol" data-ng-bind="currencySymbols[\'RUB\']"></span></div></header><div class="card-payment-text"><p class="card-payment-subheader">Сразу после успешной оплаты оформленный полис придет на вашу электронную почту</p></div></section></div></div><article class="container-content-payment"><div class="actions-section actions-section-pay"><div class="security-text col-xs-4"><span class="plain-text">передача информации защищена сертификатом SSL&nbsp;256 бит, подписанным компанией GeoTrust</span></div><div class="btn-payment col-xs-4"><form novalidate method="post" target="{{paymentFormTarget}}" action="{{paymentInfo.address}}" data-lazy-submit="{{allowSubmit}}"><input type="hidden" name="shopId" data-ng-value="paymentInfo.shopId"> <input type="hidden" name="scid" data-ng-value="paymentInfo.scid"> <input name="paymentType" value="AC" type="hidden"> <input name="customerNumber" data-ng-value="paymentInfo.customerNumber" type="hidden"> <input type="hidden" name="orderNumber" data-ng-value="paymentInfo.orderId"> <input type="hidden" name="sum" data-ng-value="paymentInfo.amount"> <button data-ng-if="!appInFrameMode || appInFrameMode && !allowSubmit" type="button" class="btn btn-success btn-lg btn-center" data-ng-click="checkOrder($event);" data-ng-class="{ spinner: !formReady || acceptRequestPending }" data-ng-bind-template="{{ !formReady || acceptRequestPending ? \' \' : (appInFrameMode ? \'Подтвердить\' : \'Оплатить\') }}"></button> <button data-ng-if="appInFrameMode && allowSubmit" class="btn btn-success btn-lg btn-center" data-ng-bind-template="{{ !formReady ? \' \' : \'Оплатить\' }}" type="submit"></button></form></div></div></article></div></div>'),
a.put("modules/order-prepare/partials/order-prepare.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><div class="container-fluid container-content container-content-primary"><div class="actions-sequence"><div class="action-back"><a class="btn btn-grey-transparent" data-ng-href="{{searchResultsLink}}">К результатам поиска</a></div><ul class="items actions"><li class="action-sequence-step-wrapper active"><a class="item action-sequence-step" data-ng-href="{{orderPrepareLink}}" data-sequence-title="Оформление">Оформление</a></li><li class="action-sequence-step-wrapper"><span class="item action-sequence-step" data-sequence-title="Оплата">Оплата</span></li><li class="action-sequence-step-wrapper"><span class="item action-sequence-step" data-sequence-title="Получение">Получение</span></li></ul></div></div><div class="container-fluid container-content container-content-search-results order-prepare-insurance-choice"><search-result-item data-item="insuranceChoice" data-risk-options="riskOptions" data-expand="expandItem" data-config="{\n                                showParamsButton: true\n                            }" data-ng-class="{\'expanded-item\': insuranceChoice.expanded}"></search-result-item></div><section class="container-content order-prepare-auth-block" data-ng-hide="currentUser.value != null" data-ng-if="!appInFrameMode"><div class="order-prepare-auth-block-text">Если вы уже оформляли страховки на нашем<br>сервисе, то рекомендуем авторизоваться</div><div class="order-prepare-auth-block-btn"><button class="btn btn-green-transparent" data-ng-click="requestAuthenticate()">Войти</button></div></section><form name="prepare" novalidate data-ng-submit="prepareOrder();"><section class="container-fluid container-content container-content-insured"><header class="page-header"><h2 class="subject-title subject-section-title">Застрахованные</h2></header><div class="items"><div class="item item-insured-person item-insured-person-attributes"><div class="item-component popover-wrapper"><h4 class="subject-title subject-title-param">Дата рождения <span class="icon-hint" data-uib-popover-template="orderInfoPopover.templateUrl" data-popover-elem></span></h4></div><div class="item-component"><h4 class="subject-title subject-title-param">Фамилия</h4></div><div class="item-component"><h4 class="subject-title subject-title-param">Имя</h4></div><div class="item-component" data-ng-if="isInsuranceCompany(vtbCompany, currentCompany)"><h4 class="subject-title subject-title-param">Загранпаспорт</h4></div></div><ng-form name="member" data-ng-repeat="insuredPerson in insuranceChoice.calculationDataInput.travelData.passengers"><div data-ng-class="{\'item-insured-person-terminator\': $last}" class="item item-insured-person"><div class="item-component item-smaller"><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insuredPerson.birthDate"></span></div></div></div><div class="item-component"><div data-focus-styling="{class: \'focus\'}" class="user-input-element user-input-single-text" data-ng-class="{error: (member.lastName.$error.required || member.lastName.$error.nameValidation) && (member.lastName.$touched || member.$submitted)}"><input type="text" data-ng-model="insuredPerson.surname" name="lastName" data-ng-required="true" data-name-validation="true" data-popover-trigger="focus" data-uib-popover="Только латинские буквы" placeholder="IVANOV" restrict-input-maxlength></div></div><div class="item-component"><div data-focus-styling="{class: \'focus\'}" class="user-input-element user-input-single-text" data-ng-class="{error: (member.firstName.$error.required || member.firstName.$error.nameValidation) && (member.firstName.$touched || member.$submitted)}"><input type="text" data-ng-model="insuredPerson.name" data-ng-required="true" name="firstName" data-popover-trigger="focus" data-uib-popover="Только латинские буквы" placeholder="IVAN" restrict-input-maxlength data-name-validation="true"></div></div><div class="item-component" data-ng-if="isInsuranceCompany(vtbCompany, currentCompany)"><div data-focus-styling="{class: \'focus\'}" class="user-input-element user-input-single-text" data-ng-class="{error: (member.internationalPassportSerialAndNumber.$invalid || member.internationalPassportSerialAndNumber.$error.numberValidation) && member.internationalPassportSerialAndNumber.$touched }"><input type="text" data-ng-model="insuredPerson.internationalPassportSerialAndNumber" data-ng-required="true" data-disallow-symbol-enter="non-digits" number-validation="true" name="internationalPassportSerialAndNumber" data-popover-trigger="focus" data-uib-popover="Серия и номер без пробелов" placeholder="012345678" restrict-input-maxlength></div></div></div></ng-form></div></section><section class="container-fluid container-content container-content-insured"><header class="page-header"><h2 class="subject-title subject-section-title">Страхователь</h2></header><ng-form name="ensurer"><div class="items"><div class="item item-insured-person item-insured-person-insurer"><div class="items-inner-wrapper"><div class="item-component item-smaller"><h4 class="subject-title">Дата рождения</h4><div data-focus-styling="{class: \'focus\'}" class="user-input-element user-input-spartan user-input-single-text" data-ng-hide="(currentUser.value != null && currentUser.value.birthDate != null)" data-ng-class="{error: (ensurer.birthDate.$invalid || !isBirthDateValid || !isInsurerAgeAllowed) && ensurer.birthDate.$touched}"><input type="text" data-ng-required="true" name="birthDate" data-ng-model="insurer.birthDate" data-model-view-value="true" data-ui-mask="99.99.9999" data-ui-mask-placeholder="{{currentMask}}" data-birthdate-validation="true" data-validation-method-name="checkInsurerBirthDate" data-ng-focus="setMask(\'focus\')" data-ng-blur="setMask(\'blur\'); checkInsurerBirthDate(insurer.birthDate)" data-popover-trigger="none" data-popover-enable="!isInsurerAgeAllowed" data-popover-is-open="!isInsurerAgeAllowed" data-uib-popover-template="\'birthDatePopoverTemplateWarning.html\'"></div><div class="user-input-widget user-input-widget-read-only" data-ng-show="(currentUser.value != null && currentUser.value.birthDate != null)"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insurer.birthDate"></span></div></div></div><div class="item-component"><h4 class="subject-title">Фамилия</h4><div data-focus-styling="{class: \'focus\'}" class="user-input-element user-input-spartan user-input-single-text" data-ng-hide="currentUser.value != null" data-ng-class="{error: (ensurer.lastName.$error.required || ensurer.lastName.$error.nameValidation) && (ensurer.lastName.$touched || ensurer.$submitted)}"><input type="text" data-ng-model="insurer.lastName" data-ng-required="true" data-name-validation="true" name="lastName" data-popover-trigger="focus" data-uib-popover="Только латинские буквы" placeholder="IVANOV" restrict-input-maxlength></div><div class="user-input-widget user-input-widget-read-only" data-ng-show="currentUser.value != null"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insurer.lastName"></span></div></div></div><div class="item-component"><h4 class="subject-title">Имя</h4><div data-focus-styling="{class: \'focus\'}" data-ng-hide="currentUser.value != null" class="user-input-element user-input-single-text" data-ng-class="{error: (ensurer.firstName.$error.required || ensurer.firstName.$error.nameValidation) && (ensurer.firstName.$touched|| ensurer.$submitted)}"><input type="text" data-ng-model="insurer.firstName" data-ng-required="true" data-name-validation="true" name="firstName" data-popover-trigger="focus" data-uib-popover="Только латинские буквы" placeholder="IVAN" restrict-input-maxlength></div><div class="user-input-widget user-input-widget-read-only" data-ng-show="currentUser.value != null"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insurer.firstName"></span></div></div></div></div><div class="items-inner-wrapper"><div class="item-component item-larger popover-wrapper"><h4 class="subject-title">E-mail</h4><div data-focus-styling="{class: \'focus\'}" class="user-input-element user-input-single-text" data-ng-hide="currentUser.value != null" data-ng-class="{error: (ensurer.email.$touched || ensurer.$submitted) && (ensurer.email.$error.required || ensurer.email.$error.pattern || !validation.email)}" data-popover-trigger="none" data-popover-enable="isEmailWarning" data-popover-is-open="isEmailWarning" data-uib-popover-template="\'emailPopoverTemplateWarning.html\'"><input type="text" class="user-input-email" data-ng-model="insurer.email" data-ng-required="true" name="email" data-ng-pattern="regexp.EMAIL" maxlength="64" data-ng-focus="showPopovers()" data-ng-change="checkEmail()" data-ng-blur="hidePopovers()" data-popover-trigger="none" data-popover-enable="isEmailHint" data-popover-is-open="isEmailHint" data-uib-popover-template="\'emailPopoverTemplateHelper.html\'" placeholder="ivan.ivanov@domain.ru" restrict-input-maxlength data-disallow-symbol-enter="space"></div><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper" data-ng-show="currentUser.value != null"><span class="user-input" data-ng-bind="insurer.email"></span></div></div></div><div class="item-component"><h4 class="subject-title">Мобильный телефон</h4><div data-focus-styling="{class: \'focus\'}" data-ng-hide="currentUser.value != null" class="user-input-element user-input-single-text" data-ng-class="{error: (ensurer.phonenumber.$touched && !insurer.phoneNumber)}"><input type="tel" data-ng-model="insurer.phoneNumber" data-ui-mask="+7 (999) 999-99-99" data-ui-placeholder="+7 (911) 123-45-67" data-ui-options="{clearOnBlur: false}" data-ng-required="true" data-model-view-value="true" name="phonenumber"></div><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper" data-ng-show="currentUser.value != null"><span class="user-input" data-ng-bind="insurer.phoneNumber"></span></div></div></div><div class="item-insured-person-note">Указанные контактные данные будут использоваться<br>для отправки купленного полиса</div></div></div></div></ng-form><div class="item-component item-component-switcher user-agreement-switcher"><span class="user-input user-input-switcher"><input type="checkbox" id="user-agreement" data-ng-checked="isUserAgreement" data-ng-model="isUserAgreement"><label for="user-agreement">Принимаю <a target="{{linkTargetAttr}}" data-ng-href="{{site + insuranceChoice.links.linkToRules}}">условия страхования</a> и выражаю <a target="{{linkTargetAttr}}" data-ng-href="{{site + \'internal/downloads/license/agreement\'}}">согласие на обработку персональных данных</a>.</label></span></div></section><section class="container-content-prepare"><div class="actions-section"><input data-ng-disabled="isPrepareButtonDisabled()" type="submit" class="btn btn-success btn-lg" value="Оформить"></div></section></form><script type="text/ng-template" id="orderInfo.html"><div class="popover-info-container">\n\t\t\t<div class="close-popover-btn"></div>\n\n\t\t\t<div class="popover-info">Возраст застрахованного влияет на стоимость полиса. Для изменения необходимо вернуться к <a class="popover-link" data-ng-href="{{searchResultsLink}}">Расчету</a></div>\n\t\t</div></script><script type="text/ng-template" id="emailPopoverTemplateHelper.html"><div>\n            Введите адрес эл. почты\n        </div></script><script type="text/ng-template" id="emailPopoverTemplateWarning.html"><div class="email-popover">\n\t\t\tДанный email уже используется. Измените его или войдите в <span data-ng-click="requestAuthenticate()">Личный кабинет</span>\n\t\t</div></script><script type="text/ng-template" id="birthDatePopoverTemplateWarning.html"><div>\n\t\t\tСтрахователь не может<br/>быть моложе 18 лет\n\t\t</div></script></div>'),a.put("modules/order-result/partials/order-done.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><div class="container-fluid container-content container-content-primary"><div class="actions-sequence centered"><ul class="items actions"><li class="action-sequence-step-wrapper disabled"><a data-dummy-link="" class="item action-sequence-step" href="#" data-sequence-title="Оформление">Оформление</a></li><li class="action-sequence-step-wrapper disabled"><a data-dummy-link="" class="item action-sequence-step" href="#" data-sequence-title="Оплата">Оплата</a></li><li class="action-sequence-step-wrapper active"><a data-dummy-link="" class="item action-sequence-step" href="#" data-sequence-title="Получение">Получение</a></li></ul></div></div></div><div class="container-fluid container-wrapper container-wrapper-darker"><div class="container-content container-content-purchase-confirmation"><section><div class="status status-success"></div><h2 class="subject-title">Застраховано!</h2><h3 class="subject-subtitle">Спасибо, что воспользовались нашим сервисом онлайн страхования!</h3></section><div class="container-related container-related-info"><div class="col-md-6"><div class="container-related-policy-info"><p>Оформленный полис в формате pdf отправлен вам на почту. Эта онлайн страховка подтверждает заключение договора страхования с выбранной вами компанией.</p><p>В любое удобное время можно скачать и распечатать полис в личном кабинете.</p></div></div><div class="col-md-6"><div class="container-related-advice"><div class="container-advice"><p>Если вы приобрели страховку для поездки за рубеж и вам необходимо оформить шенгенскую или иную визу, просто распечатайте полис на любом принтере и предоставьте вместе с другими документами. Распечатку онлайн страховки принимают все посольства и визовые центры.</p></div></div></div></div></div></div><div class="container-fluid container-wrapper container-wrapper-darker"><div class="container-content"><div class="actions-section actions-navigation row"><div class="main-page-link-btn col-xs-4"><a class="btn btn-green-transparent btn-arrow" href="/">Вернуться на главную</a></div><div class="col-xs-4" data-ng-show="!appInFrameMode"><a class="btn btn-success btn-lg" data-ng-href="{{privateOfficeLink}}">Личный кабинет</a></div></div></div></div>'),a.put("modules/order-result/partials/order-fail.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><div class="container-fluid container-content container-content-primary"><div class="actions-sequence centered"><ul class="items actions"><li class="action-sequence-step-wrapper disabled"><a data-dummy-link="" class="item action-sequence-step" href="#" data-sequence-title="Оформление">Оформление</a></li><li class="action-sequence-step-wrapper active"><a data-dummy-link="" class="item action-sequence-step" href="#" data-sequence-title="Оплата">Оплата</a></li><li class="action-sequence-step-wrapper disabled"><a data-dummy-link="" class="item action-sequence-step" href="#" data-sequence-title="Получение">Получение</a></li></ul></div></div></div><div class="container-fluid container-wrapper container-wrapper-darker"><div class="container-content container-content-purchase-confirmation"><section data-ng-if="failReasonUndefined"><div class="status status-error"></div><h2 class="subject-title" data-ng-bind="::orderStatus.TITLE"></h2><h3 class="subject-subtitle-fail" data-ng-bind="::orderStatus.FULL_DESCRIPTION"></h3></section><section data-ng-if="!failReasonUndefined"><div class="status status-error"></div><h2 class="subject-title" data-ng-bind="::orderStatus.TITLE"></h2><h3 class="subject-subtitle-fail-error" data-ng-bind-html="::orderStatus.FULL_DESCRIPTION.replace(insuranceCompanyTemplate, insuranceCompanyName)"></h3><h3 data-ng-if="!!orderStatus.SUGGESTIONS" class="subject-subtitle-fail-error" data-ng-bind="::orderStatus.SUGGESTIONS"></h3></section></div></div><div class="container-fluid container-wrapper container-wrapper-darker container-order-fail"><div class="container-content"><div class="actions-section actions-sequence actions-navigation row"><div class="main-page-link-btn col-xs-4"><a class="btn btn-green-transparent btn-arrow" href="/">Вернуться на главную</a></div><div class="col-xs-4"><a data-ng-if="failReasonUndefined && !appInFrameMode" class="btn btn-success btn-lg" data-ng-href="{{privateOfficeLink}}">Личный кабинет</a> <a data-ng-if="!failReasonUndefined" class="btn btn-grey-transparent" data-ng-href="{{ searchResultsLink }}">К результатам поиска</a></div></div></div></div>'),a.put("modules/partner-login/partials/partner-login.html",'<div class="partner-login-form"><div class="modal-backdrop"></div><div class="modal-dialog modal-sm"><div class="modal-content"><div class="modal-header"><div class="modal-logo"></div><h2 class="modal-title">Личный кабинет<br>партнера</h2></div><div class="modal-body"><form name="login" novalidate data-ng-submit="login.$valid && submit()"><div class="item-component"><div data-focus-styling="{class: \'focus\'}" class="user-input-element user-input-single-text" data-ng-class="{error: (login.userName.$error.required || login.userName.$error.pattern) && (login.userName.$touched || login.$submitted)}"><input type="text" placeholder="E-mail" data-ng-model="formData.userName" data-ng-required="true" name="userName" data-popover-trigger="focus" data-popover-is-open="login.$submitted && !login.userName.$valid" data-uib-popover="Укажите адрес электронной почты" data-ng-pattern="regexp.EMAIL"></div></div><div class="item-component"><div data-focus-styling="{class: \'focus\'}" class="user-input-element user-input-single-text" data-ng-class="{error: login.password.$error.required && (login.password.$touched || login.$submitted)}"><input type="password" placeholder="Пароль" data-ng-model="formData.password" data-ng-required="true" name="password" id="password" data-popover-trigger="focus" data-popover-is-open="login.$submitted && login.userName.$valid && !login.password.$valid" data-uib-popover="Укажите пароль"><span class="show-pass" data-ng-click="showpassword($event)"><img data-img-svg src="/img/min/pass_vizible_icon.svg" alt="Показать/скрыть пароль"></span></div></div><div><div data-focus-styling="{class: \'focus\'}"><input type="checkbox" placeholder="чужой компьютер" data-ng-model="formData.alienComputer" data-ng-required="false" name="alienComputer" id="alienComputer" data-popover-trigger="focus" data-uib-popover="чужой компьютер"><label for="alienComputer">чужой компьютер</label></div></div><div class="actions actions-login"><input class="btn btn-grey-transparent" type="submit" value="Войти"></div><p data-ng-if="loginError" data-ng-bind="feedBack" class="alert alert-danger"></p></form></div></div></div></div>'),a.put("modules/partner/partials/partner-trades.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><div class="container-content container-content-primary admin-monitor partner-monitor"><h2 class="partner-monitor-header">Личный кабинет партнера</h2><section class="control-panel"><div class="view-modes-container"><h3 class="content-title">Статистика продаж</h3><ul class="view-modes"><li class="view-mode" data-ng-repeat="period in periods" data-ng-class="{\'view-mode-active\': periodIsChosen(period)}" data-ng-click="showPaidInfo(period)"><span data-ng-bind="period.label"></span></li></ul></div><div class="brief"><div class="brief-info-chunk"><span class="brief-info-topic">Всего<br>полисов:</span><output class="brief-info-details"><span class="brief-info-primary-value" data-ng-bind="getTotalSoldItems()"></span></output></div><div class="brief-info-chunk"><span class="brief-info-topic">Общая<br>стоимость:</span><output class="brief-info-details"><span class="brief-info-primary-value" data-ng-bind="overallPrice.int | number: 0 | numdivider: \',\' : \' \'"></span> <span class="brief-info-secondary-value" data-ng-bind="overallPrice.float * 100 | number: 0"></span> <span class="brief-info-value-dimension">a</span></output></div><div class="brief-info-chunk"><span class="brief-info-topic">Общее<br>вознаграждение:</span><output class="brief-info-details"><span class="brief-info-primary-value" data-ng-bind="overallPartnerRevenue.int | number: 0 | numdivider: \',\' : \' \'"></span> <span class="brief-info-secondary-value" data-ng-bind="overallPartnerRevenue.float * 100 | number: 0"></span> <span class="brief-info-value-dimension">a</span></output></div><div class="brief-control"><a class="btn btn-white-transparent" data-ng-href="{{downloadUrl}}" target="_blank">Скачать отчет</a></div></div></section><div class="details-panel"><div class="details-header"><h5 class="subject-title col-smaller">Дата<br>продажи</h5><h5 class="subject-title col-larger">Номер<br>полиса</h5><h5 class="subject-title col-largest">Вид<br>страхования</h5><h5 class="subject-title col-larger">Страховщик</h5><h5 class="subject-title col-smaller">Стоимость<br>полиса</h5><h5 class="subject-title col-default">Вознаграждение<br>партнера</h5><h5 class="subject-title col-minor">Учет</h5></div><div class="detail-item" data-ng-repeat="item in soldItems | orderBy:\'-orderId\'"><span class="detail-item-param col-smaller" data-ng-bind="item.creationDate | date:\'dd.MM.yyyy\'"></span> <span class="detail-item-param col-larger" data-ng-bind="item.policyNumber"></span> <span class="detail-item-param col-largest" data-ng-bind="getInsuranceType(item.insuranceTypeCode)"></span> <span class="detail-item-param col-larger" data-ng-bind="getInsuranceCompanyName(item.insuranceCompany)"></span> <span class="detail-item-param detail-item-param-important col-smaller" data-ng-bind="item.price | number: 2 | numdivider: \',\' : \' \'"></span> <span class="detail-item-param detail-item-param-important col-default" data-ng-bind="getPartnerRevenue(item.insuranceTypeCode, item.price) | number: 2 | numdivider: \',\' : \' \'"></span> <span class="detail-item-param col-minor"></span></div></div></div></div>'),a.put("modules/private-office/partials/private-office.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><section class="container-content container-content-primary private-office"><header><h2 class="private-office-header">Личный кабинет</h2><ul class="policy-tab-pane"><li class="policy-tab-item" data-ng-class="{\'policy-tab-item-active\': policyTypeIsActive(policyCategory.type)}" data-ng-repeat="policyCategory in policyStructure | orderBy: \'priority\'" data-ng-click="setPoliciesFilter(policyCategory.type); setActivePolicyType(policyCategory.type); updateFilteredPolicyItems();"><div>{{ policyCategory.categoryLabel }} <span class="policy-counter" data-ng-if="policyCategory.showItemsQuantity && policiesExists(policyCategory.type)" data-ng-bind="itemsPerCategory[policyCategory.type]"></span></div></li></ul></header><div class="private-office-content"><div class="policy-item" data-ng-repeat="policyItem in policiesList | filter: policyFilter | orderBy: [sortByCategory, sortByDate]"><search-result-item data-item="policyItem.calculationData" data-expand="expandItem" data-risk-options="riskOptions" data-order-preview="policyItem.confirmationData" data-config="{showActionsButton: true}" data-preview-as-trigger="true" data-get-action-label="getPolicyActionLabel(item)" data-get-action-resource="getActionResource(item)" data-context-action="executePolicyAction(item)"><div><div class="policy-item-header" data-header><div class="policy-type status-mark" data-ng-bind="getPolicyType(policyItem)" data-ng-class="{\n                        \'draft-status-mark\': checkPolicyType(policyItem, \'draft\'),\n\n                        \'payment-pending-status-mark\': checkPolicyType(policyItem, \'payment-pending\'),\n\n                        \'paid-status-mark\': checkPolicyType(policyItem, \'paid\')\n                    }"></div><div class="policy-date" data-ng-bind-template="от {{ policyItem.creationDate | date:\'dd.MM.yyyy\' }}"></div><button class="btn btn-grey-transparent action-delete" data-action-trigger data-ng-click="removeItem(policyItem)" data-ng-show="checkPolicyType(policyItem, \'draft\') || checkPolicyType(policyItem, \'payment-pending\')">Удалить</button></div><div class="insured-persons-wrapper" data-extra-content><section class="container-content-insured"><header class="page-header"><h2 class="subject-title subject-section-title">Застрахованные</h2></header><div class="items"><div class="item item-insured-person item-insured-person-attributes"><div class="item-component"><h4 class="subject-title subject-title-param">Дата рождения</h4></div><div class="item-component"><h4 class="subject-title subject-title-param">Фамилия</h4></div><div class="item-component"><h4 class="subject-title subject-title-param">Имя</h4></div><div class="item-component" data-ng-if="isInsuranceCompany(vtbCompany, policyItem.calculationData.insuranceCompany.registeredService)"><h4 class="subject-title subject-title-param">Загранпаспорт</h4></div></div><div data-ng-class="{\'item-insured-person-terminator\': $last}" class="item item-insured-person" data-ng-repeat="insuredPerson in policyItem.calculationData.insuredPersons"><div class="item-component"><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insuredPerson.birthDate"></span></div></div></div><div class="item-component"><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insuredPerson.surname"></span></div></div></div><div class="item-component"><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insuredPerson.name"></span></div></div></div><div class="item-component" data-ng-if="isInsuranceCompany(vtbCompany, policyItem.calculationData.insuranceCompany.registeredService)"><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="insuredPerson.internationalPassportSerialAndNumber"></span></div></div></div></div></div></section><section class="container-content-insured container-content-insurer"><header class="page-header"><h2 class="subject-title subject-section-title">Страхователь</h2></header><div class="items"><div class="item item-insured-person item-insured-person-insurer"><div class="items-inner-wrapper"><div class="item-component"><h4 class="subject-title">Дата рождения</h4><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="policyItem.calculationData.insurer.birthDate"></span></div></div></div><div class="item-component"><h4 class="subject-title">Фамилия</h4><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="policyItem.calculationData.insurer.lastName"></span></div></div></div><div class="item-component"><h4 class="subject-title">Имя</h4><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="policyItem.calculationData.insurer.firstName"></span></div></div></div></div><div class="items-inner-wrapper"><div class="item-component item-larger"><h4 class="subject-title">E-mail</h4><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input user-input-email" data-ng-bind="policyItem.calculationData.insurer.email"></span></div></div></div><div class="item-component"><h4 class="subject-title">Мобильный телефон</h4><div class="user-input-widget user-input-widget-read-only"><div class="user-input-wrapper"><span class="user-input" data-ng-bind="policyItem.calculationData.insurer.phoneNumber"></span></div></div></div></div></div></div></section></div></div></search-result-item></div><div class="spinner-container" data-ng-show="!policiesFetched"><div class="spinner-dot"></div><div class="spinner-dot"></div><div class="spinner-dot"></div></div></div></section></div>'),a.put("modules/public-footer/partials/public-footer.html",'<div class="container-fluid container-content" data-ng-controller="publicFooterController"><div class="col-xs-2 footer-section-container"><p class="copyright">&copy; 2016, RiskMarket</p></div><div class="col-xs-6 footer-section-container"><a tabindex="-1" data-ng-href="{{aboutPageLink}}" class="footer-link">О компании</a> <a tabindex="-1" data-ng-href="{{contactsPageLink}}" class="footer-link">Контакты</a> <a tabindex="-1" data-ng-href="{{termsPageLink}}" class="footer-link" data-ng-hide="isPartnerPage()">Пользовательское соглашение</a> <a tabindex="-1" data-ng-href="{{partnerPageLink}}" class="footer-link" target="_blank">Для партнеров</a></div><div class="col-xs-4 footer-section-container"><ul class="items partner-items"><li class="partner-item item partner-item-visa"></li><li class="partner-item item partner-item-mastercard"></li><li class="partner-item item partner-item-geotrust"></li></ul></div></div>'),a.put("modules/public-navigation/partials/public-navigation.html","<nav class=\"navbar navbar-default main-nav navbar-fixed-top\" data-scrolled-nav data-class-at=\"{\n\t'navbar-index': 'main-page',\n\n\t'': 'order-prepare, order-payment, order-done, order-fail'\n"+'\t}" data-ng-controller="navigationController as vm"><div class="container-fluid container-content"><div class="navbar-header"><button tabindex="-1" type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a tabindex="-1" href="/" class="navbar-brand logo"></a></div><div class="collapse navbar-collapse menu-list" id="bs-example-navbar-collapse-1"><div class="nav-default-content" data-ng-show="!isPartnerPage()"><ul class="nav navbar-nav"><li class="nav-item"><a tabindex="-1" class="link" data-class-at="{\'static\': \'main-page\'}" href="/">Путешествия</a></li></ul><button tabindex="-1" data-ng-show="vm.currentUser.value == null" class="btn btn-nav btn-success" data-class-at="{\'btn-login-main-page\': \'main-page\'}" data-ng-click="vm.requestAuthenticate()">Войти</button><ul class="nav navbar-nav navbar-right" data-ng-show="vm.currentUser.value != null"><li class="dropdown"><a tabindex="-1" href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">{{::vm.currentUser.value.displayName}} <img data-img-svg class="fill-svg" src="img/min/cabinet_button_arrow.svg" alt="arrow"></a><ul class="dropdown-menu"><li><a tabindex="-1" class="link" href="/private-office"><img data-img-svg src="img/min/polis_ico.svg" alt="Полисы" class="link-icon"> Полисы</a></li><li data-ng-show="vm.isAdmin()"><a tabindex="-1" class="link" href="/admin.monitor"><img data-img-svg src="img/min/crown_admin.svg" alt="АДМИН" class="link-icon"> АДМИН</a></li><li><a tabindex="-1" class="link" href="#" data-ng-click="vm.logout($event)"><img data-img-svg src="img/min/exit_ico.svg" alt="Выйти" class="link-icon"> Выйти</a></li></ul></li></ul></div><div class="nav-alt-content" data-ng-show="isPartnerPage()"><a tabindex="-1" href="/" class="nav-inner-page-link" target="_blank"><span class="nav-inner-page-link-text">riskmarket.ru</span></a> <button tabindex="-1" class="btn btn-grey-transparent" data-ng-click="vm.logout($event)">Выйти</button></div></div></div></nav><script type="text/ng-template" id="login.html"><div data-handle-modal data-username="formData.userName" data-is-restore="isRestore" data-close-action="close($event)">\n\t\t<div class="modal-header">\n\t\t\t<a tabindex="-1"  class="action-close" href="#" data-ng-click="close($event)"></a>\n\n\t\t\t<div class="modal-logo"></div>\n\n\t\t\t<h2 class="modal-title" data-ng-hide="isRestore">\n\n\t\t\t\tВход<br />в личный кабинет\n\t\t\t</h2>\n\n\t\t\t<h2 class="modal-title restore" data-ng-show="isRestore">\n\t\t\t\tВосстановление<br />пароля\n\t\t\t</h2>\n\t\t</div>\n\n\t\t<div class="modal-body" data-ng-hide="isRestore">\n\t\t\t<form name="login" novalidate data-ng-submit="login.$valid && ok()">\n\t\t\t\t<div class="item-component">\n\t\t\t\t\t<div\n\t\t\t\t\t\tdata-focus-styling="{class: \'focus\'}"\n\n\t\t\t\t\t\tclass="user-input-element user-input-single-text"\n\n\t\t\t\t\t\tdata-ng-class="{\n\t\t\t\t\t\t\terror: (login.userName.$error.required || login.userName.$error.pattern) && (login.userName.$touched || login.$submitted)\n\t\t\t\t\t\t}"\n\t\t\t\t\t>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype="text"\n\n\t\t\t\t\t\t\tplaceholder="E-mail"\n\n\t\t\t\t\t\t\tdata-ng-model="formData.userName"\n\n\t\t\t\t\t\t\tdata-ng-required="true"\n\n\t\t\t\t\t\t\tname="userName"\n\n\t\t\t\t\t\t\tdata-popover-trigger="focus"\n\n\t\t\t\t\t\t\tdata-popover-is-open="login.$submitted && !login.userName.$valid"\n\n\t\t\t\t\t\t\tdata-uib-popover="Укажите адрес электронной почты"\n\n\t\t\t\t\t\t\tdata-ng-pattern="regexp.EMAIL"\n\n\t\t\t\t\t\t\tdata-ng-blur="isExistingEmail()"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="item-component">\n\t\t\t\t\t<div\n\t\t\t\t\t\tdata-focus-styling="{class: \'focus\'}"\n\n\t\t\t\t\t\tclass="user-input-element user-input-single-text"\n\n\t\t\t\t\t\tdata-ng-class="{error: login.password.$error.required && (login.password.$touched || login.$submitted) && userIsExisting}"\n\t\t\t\t\t>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype="password"\n\n\t\t\t\t\t\t\tplaceholder="Пароль"\n\n\t\t\t\t\t\t\tdata-ng-model="formData.password"\n\n\t\t\t\t\t\t\tdata-ng-required="true"\n\n\t\t\t\t\t\t\tname="password"\n\n\t\t\t\t\t\t\tid="password"\n\n\t\t\t\t\t\t\tdata-popover-trigger="focus"\n\n\t\t\t\t\t\t\tdata-popover-is-open="login.$submitted && userIsExisting && !login.password.$valid"\n\n\t\t\t\t\t\t\tdata-uib-popover="Укажите пароль"\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<span class="show-pass" data-ng-click="showpassword($event)">\n\t\t\t\t\t\t\t<img data-img-svg src="/img/min/pass_vizible_icon.svg" alt="Показать/скрыть пароль" />\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="item-component">\n\t\t\t\t\t<div data-focus-styling="{class: \'focus\'}" >\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype="checkbox"\n\n\t\t\t\t\t\t\tplaceholder="чужой компьютер"\n\n\t\t\t\t\t\t\tdata-ng-model="formData.alienComputer"\n\n\t\t\t\t\t\t\tdata-ng-required="false"\n\n\t\t\t\t\t\t\tname="alienComputer"\n\n\t\t\t\t\t\t\tid="alienComputer"\n\n\t\t\t\t\t\t\tdata-popover-trigger="focus"\n\n\t\t\t\t\t\t\tdata-uib-popover="чужой компьютер"\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<label for="alienComputer">чужой компьютер</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="actions actions-login">\n\t\t\t\t\t<input class="btn btn-grey-transparent" type="submit" value="Войти" data-ng-click="findInvalidFields()" />\n\t\t\t\t</div>\n\n\t\t\t\t<div class="actions actions-restore">\n\t\t\t\t\t<a tabindex="-1"  class="link restore-password-link" href="#" data-ng-click="setRestore($event);">Забыли пароль?</a>\n\t\t\t\t</div>\n\t\t\t</form>\n\n\t\t\t<p\n\t\t\t\tdata-ng-if="passwordRestoreError || loginError"\n\n\t\t\t\tdata-ng-bind="feedBack"\n\n\t\t\t\tclass="alert alert-danger"\n\t\t\t></p>\n\n\t\t\t<div class="helper">\n\t\t\t\t<a tabindex="-1"  data-ng-click="isCollapsed = !isCollapsed" class="action">Как завести личный кабинет?</a>\n\n\t\t\t\t<div uib-collapse="isCollapsed">\n\t\t\t\t\t<div class="message">\n\t\t\t\t\t\tЛичный кабинет на RiskMarket.ru создаётся автоматически после указания пользователем своего адреса электронной почты для получения страхового полиса. Адрес электронной почты будет являться логином. На e-mail придёт письмо с паролем к созданному личному кабинету, где будут храниться купленные страховки, откуда их всегда можно распечатать.\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="modal-body restore" data-ng-show="isRestore">\n\t\t\t<form\n\t\t\t\tname="restore"\n\n\t\t\t\tnovalidate\n\n\t\t\t\tdata-ng-submit="restore.$valid && restorePassword()"\n\n\t\t\t\tdata-ng-hide="passwordRestoreIntent && passwordRestoreResultReceived"\n\t\t\t>\n\t\t\t\t<div class="helper">\n\t\t\t\t\t<p>Новый пароль<br/>будет выслан на почту</p>\n\n\t\t\t\t\t<p class="email-value" data-ng-bind="formData.userName"></p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="actions">\n\t\t\t\t\t<input data-ng-disabled="restore.$invalid" class="btn btn-grey-transparent" type="submit" value="Восстановить" />\n\t\t\t\t</div>\n\t\t\t</form>\n\n\t\t\t<p\n\t\t\t\tdata-ng-if="passwordRestoreIntent && passwordRestoreResultReceived"\n\n\t\t\t\tdata-ng-bind="feedBack"\n\n\t\t\t\tclass="alert alert-success"\n\t\t\t></p>\n\t\t</div>\n\t</div></script>'),
a.put("modules/search-results/partials/search-filter.html",'<div class="filter-container filter-light" data-ng-show="referenceDataFetched"><div class="filter-wrapper filter-wrapper-separate"><a class="btn btn-grey-transparent compare-items-btn" data-ng-href="{{comparedItemsPageLink}}" target="_blank" data-ng-class="{\'invisible\': appInFrameMode}">Сравнить страховки <span class="compared-items-num" data-ng-bind="comparedItemsNum" data-ng-class="{ \'active\' : comparedItemsNum } "></span></a><div class="filtered-items-number">Всего <span data-ng-bind-template="{{ relevantItemsQuantity }} {{ quantitySuffix(relevantItemsQuantity, \'расчет\', [\'\', \'а\', \'ов\']) }}"></span></div><div class="filter-area sorting-filter"><span class="item-label">Сортировка</span><div class="user-input-widget" data-user-input-list="" data-target-model="order" data-view-prop="label" data-model-prop="value" data-ignore-events="true" data-default-view-value="По умолчанию" data-values="dictionaries.sortOrder"></div></div></div><div class="filter-wrapper"><div class="filter-wrapper-inner"><div class="filter-area"><span class="item-label">Компания</span><div class="user-input-widget" data-user-input-list="" data-view-prop="label" data-model-prop="value" data-target-model="params.insuranceCompany" data-values="dictionaries.insuranceCompanies"></div></div><div class="filter-area"><span class="item-label">Тип полиса</span><div class="user-input-widget" data-user-input-list="" data-target-model="params.calculationDataInput.travelData.period.multi" data-view-prop="label" data-model-prop="value" data-values="dictionaries.policyType"></div></div><div class="filter-area"><span class="item-label">Застраховано дней<br><span class="item-label-note">для многократных полисов</span></span><div class="user-input-widget" data-user-input-list="" data-target-model="params.calculationDataInput.travelData.period.insuredDays" data-view-prop="label" data-model-prop="value" data-values="dictionaries.insuredDays" data-widget-code="INSURED_DAYS"></div></div></div><div class="filter-area"><button data-ng-class="{\'active-btn\': showAdditionalFilters}" class="btn btn-grey-transparent" data-ng-click="toggleFilters()">Все фильтры</button></div></div><div class="filter-extra" data-ng-show="showAdditionalFilters" data-filter-extra><div class="filter-wrapper"><div class="filter-area"><span class="item-label">Страховая сумма</span><div class="user-input-widget" data-user-input-list="" data-target-model="params.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.risk.sumInsured" data-view-prop="label" data-model-prop="value" data-values="dictionaries.insuranceSum"></div><div class="user-input-widget user-input-widget-currencies" data-user-input-list="" data-target-model="params.calculationDataInput.currency" data-view-prop="label" data-model-prop="value" data-values="dictionaries.currency"></div></div><div class="filter-area"><span class="item-label">Сервисная компания</span><div class="user-input-widget" data-user-input-list="" data-view-prop="label" data-model-prop="value" data-target-model="params.serviceCompany" data-values="dictionaries.assistanceCompanies"></div></div></div><h5 class="filter-wrapper-title">Наполнение полиса:</h5><div class="filter-wrapper"><div class="filter-group"><div class="filter-area"><input type="checkbox" id="extraDentalTreatment" data-ng-true-value="\'INCLUDED\'" data-ng-false-value="undefined" data-ng-model="params.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.subRisks.EXTRA_DENTAL_TREATMENT.riskStatus"><label for="extraDentalTreatment">экстренная стоматология</label></div><div class="filter-area"><input type="checkbox" id="carInsurance" data-ng-true-value="\'INCLUDED\'" data-ng-false-value="undefined" data-ng-model="params.calculationDataInput.riskAliasMap.BROKEN_CAR.riskStatus"><label for="carInsurance">для поездки на авто</label></div><div class="filter-area"><input type="checkbox" id="flightDelay" data-ng-true-value="\'INCLUDED\'" data-ng-false-value="undefined" data-ng-model="params.calculationDataInput.riskAliasMap.FLIGHT_DELAY.riskStatus"><label for="flightDelay">задержка рейса</label></div></div><div class="filter-group"><div class="filter-area"><input type="checkbox" id="thirdPartyVisit" data-ng-true-value="\'INCLUDED\'" data-ng-false-value="undefined" data-ng-model="params.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.subRisks.THIRD_PARTY_VISIT.riskStatus"><label for="thirdPartyVisit">визит родственника</label></div><div class="filter-area"><input type="checkbox" id="prescheduleReturn" data-ng-true-value="\'INCLUDED\'" data-ng-false-value="undefined" data-ng-model="params.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.subRisks.PRESCHEDULE_RETURN.riskStatus"><label for="prescheduleReturn">досрочное возвращение</label></div><div class="filter-area"><input type="checkbox" id="transportExpenses" data-ng-true-value="\'INCLUDED\'" data-ng-false-value="undefined" data-ng-model="params.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.subRisks.TRANSPORT_EXPENSES.riskStatus"><label for="transportExpenses">временное возвращение</label></div></div><div class="filter-group"><div class="filter-area"><input type="checkbox" id="children" data-ng-true-value="\'INCLUDED\'" data-ng-false-value="undefined" data-ng-model="params.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.subRisks.BRING_CHILDREN_BACK_HOME.riskStatus"><label for="children">возвращение детей домой</label></div><div class="filter-area"><input type="checkbox" id="legalHelp" data-ng-true-value="\'INCLUDED\'" data-ng-false-value="undefined" data-ng-model="params.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.subRisks.LEGAL_HELP.riskStatus"><label for="legalHelp">юридическая помощь и консультация</label></div><div class="filter-area"><input type="checkbox" id="lostDocuments" data-ng-true-value="\'INCLUDED\'" data-ng-false-value="undefined" data-ng-model="params.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.subRisks.LOST_OR_STOLEN_DOCUMENTS.riskStatus"><label for="lostDocuments">потеря или хищение документов</label></div></div></div></div></div>'),a.put("modules/search-results/partials/search-query.html",'<div class="filter-container filter-darker"><div class="filter-wrapper"><div class="filter-fields"><div class="filter-area"><selectable-items data-params="{\n\t\t\t\t\tmode: \'full\',\n\n\t\t\t\t\tlabels: textLabels,\n\n\t\t\t\t\titemLabel: \'nameRus\',\n\n\t\t\t\t\tmaxItems: selectableItems.MAIN_PAGE_TRIP_ITEMS_LIMIT,\n\n\t\t\t\t\tenableTips: false\n\t\t\t\t}" data-ng-model="data.country" data-uib-tooltip="Укажите страну" data-tooltip-placement="top" data-tooltip-enable="!data.country.length" data-tooltip-trigger="none" data-tooltip-is-open="!data.country.length" data-items="data.countries"></selectable-items></div><div class="filter-area"><participants-control data-participants="data.passengers" data-max-participant-count="4" data-is-valid="data.validation" data-lazy-update="false" class="slim" data-uib-tooltip="Укажите туристов" data-tooltip-placement="top" data-tooltip-trigger="none" data-tooltip-is-open="!data.passengers[0].birthDate.length && !data.passengers[0].isValid"></participants-control></div><div class="filter-area"><period-control data-start="data.period[\'start-date\']" data-finish="data.period[\'end-date\']" data-is-valid="data.validation" data-uib-tooltip="Укажите даты" data-tooltip-placement="top" data-tooltip-enable="!data.period[\'start-date\'] || !data.period[\'end-date\']" data-tooltip-trigger="none" data-tooltip-is-open="!data.period[\'start-date\'] || !data.period[\'end-date\']" class="slim"></period-control></div></div><div class="filter-buttons"><div class="filter-area"><button data-ng-click="showOptions = !showOptions" class="btn btn-options" data-ng-class="{ \'btn-options-active\': showOptions }">ОПЦИИ</button></div><div class="filter-area"><button class="btn" data-ng-disabled="!actionAllowed();" data-ng-click="action({data: data});">РАССЧИТАТЬ</button></div></div></div><div data-ng-class="{\'inactive\': !showOptions}" class="filter-wrapper dummy"><div class="filter-options"><div class="filter-area"><input type="checkbox" id="searchQueryLuggage" data-ng-checked="data.riskFilters[\'LUGGAGE\'] == 1"><label data-ng-click="toggleRisk(\'luggage\');">Защита багажа</label></div><div class="filter-area"><input type="checkbox" id="searchQueryCancellation" data-ng-checked="data.riskFilters[\'TRIP_CHANGE_OR_CANCELLATION\'] == 1"><label data-ng-click="toggleRisk(\'trip_change_or_cancellation\');">Отмена поездки</label></div><div class="filter-area"><input type="checkbox" id="searchQueryAccident" data-ng-checked="data.riskFilters[\'ACCIDENT\'] == 1"><label data-ng-click="toggleRisk(\'accident\');">Несчастный случай</label></div><div class="filter-area"><input type="checkbox" id="searchQueryResponsibility" data-ng-checked="data.riskFilters[\'PERSONAL_LIABILITY\'] == 1"><label data-ng-click="toggleRisk(\'personal_liability\');">Гражданская ответственность</label></div></div></div><div data-ng-class="{\'inactive\': !showOptions}" class="filter-wrapper dummy"><div class="filter-options"><div class="filter-area" data-ng-repeat="termData in dictionaries.activity track by $index | orderBy: \'orderNumber\'"><input type="checkbox" data-ng-checked="data.specialTermFilters.indexOf(termData.code.toUpperCase()) != -1" data-ng-attr-id="{{ ::(\'term\' + termData.code) }}"><label data-ng-click="toggleTerm(termData.code);" data-ng-bind="::termData.displayName"></label></div></div></div></div>'),a.put("modules/search-results/partials/search-result-item.html",'<div class="search-result-item" data-sticky-block data-sticky-block-offset-top-by="data-scrolled-nav" data-sticky-block-fixed-to="data-fixed-nav" data-sticky-active-prop="item.expanded" data-sticky-block-scroll-speed="200" data-element-enable-flag="{{ item.expanded }}"><div class="search-result-item-common sticky-top" data-primary-top><div class="search-result-item-common-row"><div class="flex-container"><div class="flex-item search-result-item-common-logo" data-bg-image="{template: \'vendorCompany\', file: item.insuranceCompany.registeredService.toLowerCase()}"></div><div class="flex-item-center"><div class="flex-container-inner"><div class="program-descr"><div class="item-type"><span data-action-trigger data-ng-click="expand(item);" data-ng-bind-template="{{ ::(item.calculationDataInput.travelData.period.multi ? \'Многократный\' : \'Однократный\') }} полис, страховая сумма {{ ::(item.calculationDataInput.riskAliasMap[\'MEDICAL_EXPENSES\'].risk.sumInsured | number: 0 | numdivider: \',\' : \' \') }}"></span> <span class="currency" data-ng-bind="::currencySymbols[item.calculationDataInput.riskAliasMap[\'MEDICAL_EXPENSES\'].risk.currency]"></span></div><div class="program-territory" data-ng-bind-template="{{ ::(territory | wordcut:maxTerritoryTextLength) }}"></div></div><div class="item-price"><span class="currency-base" data-ng-bind="::(item.priceContainer.integralPart | number: 0 | numdivider: \',\' : \' \')"></span> <span class="currency-fraction" data-ng-bind="::item.priceContainer.fractionalPart"></span> <span class="currency currency-symbol" data-ng-bind="::currencySymbols[\'RUB\']"></span></div></div></div><div data-ng-show="config.showBuyButton || config.showPayButton || config.showDownloadButton" class="flex-item"><button data-ng-if="config.showBuyButton" class="btn btn-success btn-buy" data-ng-click="events.onBuyClick(item)">КУПИТЬ</button> <button data-ng-if="config.showPayButton" class="btn btn-success btn-buy" data-ng-click="events.onPayClick(item, orderPreview)">ОПЛАТИТЬ</button> <a target="_self" data-ng-show="config.showDownloadButton" class="btn btn-success btn-buy" data-ng-href="{{ ::(site  + \'/\' + orderPreview.policyPdfUrl) }}">СКАЧАТЬ</a></div></div></div><div class="separator"></div><div class="search-result-item-common-row"><div class="flex-container search-result-insurer-common-params"><div class="flex-item program-name" data-ng-bind="::item.calculationDataInput.insuranceProgramName"></div><div class="flex-item-center"><div class="flex-container-inner"><div class="option">Застраховано дней: <span class="value" data-ng-bind="::item.calculationDataInput.travelData.period.termDays"></span></div><div class="option">Количество поездок: <span class="value"><span data-ng-show="item.calculationDataInput.travelData.period.multi" class="infinity">&infin;</span> <span data-ng-show="!item.calculationDataInput.travelData.period.multi">1</span></span></div><div class="option">Макс. дней в одной поездке: <span class="value" data-ng-bind="::item.calculationDataInput.travelData.period.daysInTrip"></span></div></div></div><div class="flex-item"><div data-ng-hide="appInFrameMode" class="animated-el-wrapper compare-btn-wrapper"><button data-ng-hide="showExtraOptions" class="compare-btn" data-ng-class="{ \'active\' : item.isAddedToCompared }" data-ng-click="updateComparedItemState(item)" data-uib-tooltip="{{item.tooltipText}}" data-tooltip-is-open="mouseover" data-clone-animation><img data-img-svg src="/img/min/compare_icon.svg" alt="Добавить к сравнению / убрать из сравнения"></button></div><button data-ng-hide="showExtraOptions" data-ng-show="config.showParamsButton" data-action-trigger class="btn btn-grey-transparent btn-params" data-ng-click="expand(item);" data-ng-class="{\'item-full-width\': appInFrameMode}">ПАРАМЕТРЫ</button> <a data-ng-if="config.showActionsButton" data-download-link data-action-trigger class="btn btn-green" data-ng-bind="getActionLabel({item: item})" data-ng-href="{{ getActionResource({item: item}) }}" data-ng-click="contextAction({item: item})"></a></div></div><div data-ng-if="showExtraOptions" class="flex-container search-result-insurer-extra-params"><div class="options-wrapper flex-container"><div class="option">Начало действия: <span class="value" data-ng-bind="::item.calculationDataInput.travelData.period[\'start-date\']"></span></div><div class="option">Застрахованные: <span class="value" data-ng-bind-template="{{ ::totalInsuredPersons }} {{ ::quantitySuffix(totalInsuredPersons, \'турист\', [\'\', \'а\', \'ов\']) }}"></span></div></div><div class="flex-item"><button data-ng-show="config.showParamsButton" data-action-trigger class="btn btn-grey-transparent btn-params" data-ng-click="expand(item);">ПАРАМЕТРЫ</button></div></div></div></div><div class="search-result-params scrolled-block" data-ng-if="item.expanded" data-ng-include="\'modules/search-results/partials/search-result-params.html\'"></div><div data-primary-bottom data-ng-show="item.expanded"></div></div>'),a.put("modules/search-results/partials/search-result-params.html",'<h4 class="search-result-params-header">Страховые риски и лимиты</h4><div class="search-result-params-group"><h4 class="search-result-params-group-header"><span data-ng-bind="::item.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.displayName"></span><div class="dash"></div><span data-ng-bind-template="{{ ::(item.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.risk.sumInsured | number: 0 | numdivider: \',\' : \' \') }}"></span> <span class="value-currency" data-ng-bind-template="{{ ::currencySymbols[item.calculationDataInput.riskAliasMap.MEDICAL_EXPENSES.risk.currency] }}"></span></h4><div data-ng-repeat="expense in medicalExpenses track by $index" class="flex-container"><div class="flex-container-inner params-row col-left"><div data-ng-bind="::expense.left.displayName"></div><div class="value excluded" data-ng-class="{ \'included\': expense.left.included, \'sum-insured\': expense.left.risk && expense.left.risk.sumInsured }"><span data-ng-bind-template="{{ ::(expense.left.risk && expense.left.risk.sumInsured ? (expense.left.risk.sumInsured | number: 0 | numdivider: \',\' : \' \') : \' \') }}"></span> <span class="value-currency" data-ng-bind-template="{{ ::(expense.left.risk && expense.left.risk.sumInsured ? currencySymbols[expense.left.risk.currency] : \' \') }}"></span></div></div><div class="flex-container-inner params-row col-right"><div data-ng-bind="::expense.right.displayName"></div><div class="value excluded" data-ng-class="{ \'included\': expense.right.included, \'sum-insured\': expense.right.risk && expense.right.risk.sumInsured }"><span data-ng-bind-template="{{ ::(expense.right.risk && expense.right.risk.sumInsured ? (expense.right.risk.sumInsured | number: 0 | numdivider: \',\' : \' \') : \' \') }}"></span> <span class="value-currency" data-ng-bind-template="{{ ::(expense.right.risk && expense.right.risk.sumInsured ? currencySymbols[expense.right.risk.currency] : \' \') }}"></span></div></div></div></div><div class="search-result-params-group"><h4 class="search-result-params-group-header">Опции</h4><div data-ng-repeat="option in extraOptions track by $index" class="flex-container"><div class="flex-container-inner params-row col-left"><div data-ng-bind="::option.left.displayName"></div><div class="value excluded" data-ng-class="{ \'included\': option.left.included, \'sum-insured\': option.left.risk && option.left.risk.sumInsured }"><span data-ng-bind-template="{{ ::(option.left.risk && option.left.risk.sumInsured ? (option.left.risk.sumInsured | number: 0 | numdivider: \',\' : \' \') : \' \') }}"></span> <span class="value-currency" data-ng-bind-template="{{ ::(option.left.risk && option.left.risk.sumInsured ? currencySymbols[option.left.risk.currency] : \' \') }}"></span></div></div><div class="flex-container-inner params-row col-right"><div data-ng-bind="::option.right.displayName"></div><div class="value excluded" data-ng-class="{ \'included\': option.right.included, \'sum-insured\': option.right.risk && option.right.risk.sumInsured }"><span data-ng-bind-template="{{ ::(option.right.risk && option.right.risk.sumInsured ? (option.right.risk.sumInsured | number: 0 | numdivider: \',\' : \' \') : \' \') }}"></span> <span class="value-currency" data-ng-bind-template="{{ ::(option.right.risk && option.right.risk.sumInsured ? currencySymbols[option.right.risk.currency] : \' \') }}"></span></div></div></div></div><div class="search-result-params-description" data-ng-if="item.calculationDataInput.description"><div class="caption">Дополнительные условия:</div><span data-ng-bind-html="::item.calculationDataInput.description"></span></div><div class="flex-container"><div class="search-result-params-territory"><div class="caption">Территория покрытия:</div><span data-ng-bind="::item.calculationDataInput.territoryDisplayName"></span></div><div class="search-result-params-links"><a class="download-link" target="{{::linkTargetAttr}}" data-ng-href="{{ ::(site + \'/\' + item.links.linkToRules) }}" href=""><span class="link-content">ПРАВИЛА СТРАХОВАНИЯ</span></a> <a class="download-link" target="{{::linkTargetAttr}}" data-ng-href="{{ ::(site + \'/\' + item.links.linkSpecialConditions) }}" href=""><span class="link-content">ОСОБЫЕ УСЛОВИЯ</span></a> <a class="download-link" target="{{::linkTargetAttr}}" data-ng-href="{{ ::(site + \'/\' + item.links.linkToMemo) }}" href=""><span class="link-content">ПАМЯТКА ПРИ СТРАХОВОМ СЛУЧАЕ</span></a></div></div><div class="search-result-params-company"><div class="caption">Сервисная компания:</div><div class="search-result-item-common-logo service-company-logo" data-bg-image="{template: \'vendorCompany\', file: item.serviceCompany.companyCode.toLowerCase()}"></div></div>'),a.put("modules/search-results/partials/search-result-participants.html",'<label>Застрахованные</label><table><tr data-ng-repeat="insuredPerson in orderPreview.insuredPersons"><td><div>{{ insuredPerson.birthDate }}</div></td><td><div>{{ insuredPerson.surname }}</div></td><td><div>{{ insuredPerson.name }}</div></td></tr></table>'),a.put("modules/search-results/partials/search-results.html",'<div class="container-fluid container-wrapper container-wrapper-darker"><div data-search-query data-data="insuranceParams" data-action="getResults(data);" data-action-allowed="allowToFetchResults();"></div><div data-smart-sticky data-fixed-nav class="query-control-area" data-ng-if="allowDisplayFilterInFrame"><div data-search-filter data-params="insuranceParams.resultsFilter" data-order="sortData.resultsOrder"></div></div><section class="container-fluid container-content container-content-primary container-content-search-results"><p data-ng-show="!getRelevantItemsReport().presence && calculationDone;">Нет данных, удовлетворяющих параметрам запроса.</p><div class="list-items"><search-result-item data-ng-repeat="insuranceItem in searchResults | orderBy:sortData.resultsOrder.prop:sortData.resultsOrder.direction track by insuranceItem.calculationId" data-ng-if="isRelevantSearchResult(insuranceItem, insuranceParams.resultsFilter);" class="search-result-container" data-ng-class="{\'chosen-item\': insuranceItem.expanded}" data-item="insuranceItem" data-risk-options="riskOptions" data-expand="expandItem" data-config="{\n                  showBuyButton: true,\n\n                  showParamsButton: true,\n\n                  showPolicyActionsButton: false\n                }"></search-result-item></div><div class="spinner-container" data-ng-show="fetchingResults"><div class="spinner-dot"></div><div class="spinner-dot"></div><div class="spinner-dot"></div></div></section></div><script type="text/ng-template" id="offers.html"><div class="container-fluid container-wrapper">\n        <!-- Container for inner content  -->\n\n        <div class="container-fluid container-content">\n            <!-- Offers row:1 (should be a flex grid with bootstrap columns) -->\n\n            <div class="subjects-container subjects-promo">\n                <!-- Promo text -->\n\n                <div class="subject-container">\n                    <h3 class="subject-title">Специально для путешествий</h3>\n\n                    <!-- End of promo text -->\n                </div>\n\n                <!-- Product with graphical element (picture / video) -->\n\n                <div class="subject-container subject-container-media">\n                    <figure class="subject-container-resource subject-media-asset">\n                        <img src="img/min/banners/banner-00.jpg" alt="Новые семейные программы" />\n\n                        <figcaption class="subject-container-brief alpha">\n                            <!-- Note: use pseudo elements for insurance company logo -->\n\n                            <h4 class="subject-title">Новые семейные программы</h4>\n                        </figcaption>\n                    </figure>\n                    <!-- End of product -->\n                </div>\n\n                <!-- Product with graphical element (picture / video) -->\n\n                <div class="subject-container subject-container-media">\n                    <figure class="subject-container-resource subject-media-asset">\n                        <img src="img/min/banners/banner-01.jpg" alt="Время отпусков это ваше время" />\n\n                        <figcaption class="subject-container-brief vtb">\n                            <!-- Note: use pseudo elements for insurance company logo -->\n\n                            <h4 class="subject-title">Время отпусков это ваше время</h4>\n                        </figcaption>\n                    </figure>\n                    <!-- End of product -->\n                </div>\n\n                <div class="subject-container subject-container-media">\n                    <figure class="subject-container-resource subject-media-asset">\n                        <img src="img/min/banners/banner-02.jpg" alt="Больше семья, больше защита" />\n\n                        <figcaption class="subject-container-brief vsk">\n                            <!-- Note: use pseudo elements for insurance company logo -->\n\n                            <h4 class="subject-title">Больше семья, больше защита</h4>\n                        </figcaption>\n                    </figure>\n                    <!-- End of product -->\n                </div>\n\n                <!-- End of offers row:1 -->\n            </div>\n\n            <!-- Offers row:2 (should be a flex grid with bootstrap columns) -->\n\n            <div class="subjects-container subjects-promo">\n                <!-- Promo text -->\n\n                <div class="subject-container">\n                    <h3 class="subject-title">Специально для путешествий</h3>\n\n                    <!-- End of promo text -->\n                </div>\n\n                <!-- Product with graphical element (picture / video) -->\n\n                <div class="subject-container subject-container-media">\n                    <figure class="subject-container-resource subject-media-asset">\n                        <img src="img/min/banners/banner-00.jpg" alt="Новые семейные программы" />\n\n                        <figcaption class="subject-container-brief alpha">\n                            <!-- Note: use pseudo elements for insurance company logo -->\n\n                            <h4 class="subject-title">Новые семейные программы</h4>\n                        </figcaption>\n                    </figure>\n                    <!-- End of product -->\n                </div>\n\n                <!-- Product with graphical element (picture / video) -->\n\n                <div class="subject-container subject-container-media">\n                    <figure class="subject-container-resource subject-media-asset">\n                        <img src="img/min/banners/banner-01.jpg" alt="Время отпусков это ваше время" />\n\n                        <figcaption class="subject-container-brief vtb">\n                            <!-- Note: use pseudo elements for insurance company logo -->\n\n                            <h4 class="subject-title">Время отпусков это ваше время</h4>\n                        </figcaption>\n                    </figure>\n                    <!-- End of product -->\n                </div>\n\n                <div class="subject-container subject-container-media">\n                    <figure class="subject-container-resource subject-media-asset">\n                        <img src="img/min/banners/banner-02.jpg" alt="Больше семья, больше защита" />\n\n                        <figcaption class="subject-container-brief vsk">\n                            <!-- Note: use pseudo elements for insurance company logo -->\n\n                            <h4 class="subject-title">Больше семья, больше защита</h4>\n                        </figcaption>\n                    </figure>\n\n                    <!-- End of product -->\n                </div>\n\n                <!-- End of offers row:2 -->\n            </div>\n\n            <!-- End of container for inner content -->\n        </div>\n    </div></script>'),a.put("modules/utils/directives/participants-control/partials/participants-control.html",'<div class="participants-control"><div class="participants-control-input" data-ng-click="togglePopup();" data-uib-tooltip-template="\'ageLimitWarning.html\'" data-tooltip-trigger="none" data-tooltip-enable="!isParticipantAgeAllowed" data-tooltip-is-open="!isParticipantAgeAllowed"><div class="widget-info-area" data-ng-class="{\n           active: params.show.popup,\n           invalid: touched && !isValid,\n           placeholder: !participantsQuantity\n         }" data-ng-bind="totalPassengersLabel"></div><button tabindex="-1">&nbsp;</button></div><div class="participants-control-popup hidden" data-ng-class="{hidden: !showControls}"><div class="age-add-title" data-ng-show="participants.length < 2">Даты рождения туристов</div><div class="participants-control-popup-row" data-ng-repeat="(participantId, participant) in participants track by $index"><input data-ng-model="participant.birthDate" type="text" required data-ng-class="{\n               \'stand-alone\': participants.length === 1,\n               \'entity-invalid\': participant.dirty && !participant.isValid\n             }" data-ui-mask="99.99.9999" data-ui-mask-placeholder="{{currentMask}}" data-model-view-value="true" data-ui-options="{\'clearOnBlur\': false}" data-ng-focus="currentMask = mask.focus" data-ng-blur="currentMask = mask.blur; checkParticipants(participants);" data-ng-keyup="onBirthDateInput($event, participant);"> <button class="participants-control-popup-row-remove" tabindex="-1" data-ng-show="participant !== participants[0] || participants.length > 1" data-ng-click="blockPropagation($event); removeParticipant($index);">&nbsp;</button></div><div class="participants-control-popup-add"><button data-ng-show="participants.length < maxParticipantCount" data-ng-click="addParticipant();">Ещё турист</button></div></div></div><script type="text/ng-template" id="ageLimitWarning.html"><div class="tooltip-warning">\n\t\tК туристам старше ста лет особый подход &mdash; им необходимо обращаться прямо в страховую компанию!\n\t</div></script>'),a.put("modules/utils/directives/period-control/partials/period-control.html",'<div class="period-control" tabindex="0"><div class="period-control-input" data-ng-init="events.checkDates()"><div class="period-control-input-div preview" data-ng-hide="events.notInPreviewMode()"><div id="preview" class="date_placeholder" data-ng-model="preview" data-ng-click="events.dateFieldFocus(dateType.start)">Даты поездки</div></div><div class="period-control-input-div" data-ng-show="events.notInPreviewMode()" data-ng-class="{\'active\': formData.type == dateType.start && formData.show.popup }"><input type="text" data-ng-model="start" id="startdate" data-ng-init="events.checkDates()" data-ng-click="events.dateFieldFocus(dateType.start)" placeholder="_ _._ _._ _ _ _" readonly></div><div class="period-control-input-dash" data-ng-show="events.notInPreviewMode()" data-ng-click="events.dateFieldFocus(dateType.start)">&mdash;</div><div class="period-control-input-div" data-ng-show="events.notInPreviewMode()" data-ng-class="{ \'invalid\': !formData.valid[dateType.finish] && finish, \'active\': formData.type == dateType.finish && formData.show.popup }"><input type="text" data-ng-model="finish" id="enddate" data-ng-init="events.checkDates()" data-ng-click="events.dateFieldFocus(dateType.finish)" placeholder="_ _._ _._ _ _ _" readonly></div><button tabindex="-1" data-ng-click="events.inputBtnClick()">&nbsp;</button></div><div class="period-control-popup" data-ng-show="formData.show.popup"><div class="period-control-popup-month"><button tabindex="-1" data-ng-click="events.prevMonthClick()" style="background-image: url(\'../../../../../img/min/calendar/btn-prev-month.png\')">&nbsp;</button><label data-ng-bind="months[formData.month] + \' \' + formData.year"></label><button tabindex="-1" data-ng-click="events.nextMonthClick()" style="background-image: url(\'../../../../../img/min/calendar/btn-next-month.png\')">&nbsp;</button></div><div class="period-control-popup-day-header"><span data-ng-repeat="acronym in daysAcronyms track by $index" data-ng-bind="::acronym"></span></div><div class="period-control-popup-day-body"><span data-ng-repeat="offset in formData.grid.offset track by $index">&nbsp;</span> <span data-ng-if="formData.grid.overdueType == overdueType.before" class="period-control-popup-overdue-day" data-ng-repeat="overdueDay in formData.grid.overdue track by $index" data-ng-bind="overdueDay"></span> <span class="period-control-popup-active-day" data-ng-class="{ \'period-control-popup-active-day-select\': actualDay.select }" data-ng-repeat="actualDay in formData.grid.actual track by $index" data-ng-click="events.selectDate(actualDay, $last)" data-ng-bind="actualDay.index"></span> <span data-ng-if="formData.grid.overdueType == overdueType.after" class="period-control-popup-overdue-day" data-ng-repeat="overdueDay in formData.grid.overdue track by $index" data-ng-bind="overdueDay"></span></div></div></div>'),a.put("modules/utils/directives/selectable-items/partials/selectable-items.html",'<div class="selectable-items"><div class="suggestion-fake-input selectable-item" data-ng-show="isFakeInputVisible();">Укажите страну</div><div class="items-wrapper"><span data-ng-repeat="selectedItem in selection track by selectedItem[itemLabel]" class="selectable-item">{{ ::selectedItem[itemLabel] }} <span data-ng-click="removeItem(selectedItem);" class="control control-remove"></span></span> <input type="text" class="suggestion-input"></div><button type="button" class="btn-trigger btn-trigger-map btn-command"></button><div data-ng-show="enableSuggestions && suggestions.length"><ul class="selectable-items-suggestions items"></ul></div></div><div class="tips" data-ng-if="enableTips"><span class="title" data-ng-bind="::labels.SELECTABLE_ITEMS.COUNTRIES.TIPS_LABEL"></span><ul class="tip-items-container"><li data-ng-repeat="tip in labels.SELECTABLE_ITEMS.COUNTRIES.TIPS track by $index" data-ng-bind="::tip" class="tip-item" data-ng-click="tipClick(tip);"></li></ul></div>'),
a.put("modules/utils/directives/user-input-list/partials/user-input-list.html",'<div class="user-input-wrapper"><span class="current-item" data-ng-bind="getViewValue(selectedValue);"></span><ul class="user-input-items-list"><li tabindex="-1" class="user-input-item" data-ng-repeat="value in values track by $index" data-ng-mousedown="setCurrentValue(value);" data-ng-class="{\'user-input-item-selected\': value.inactive ||  selectedValue[viewProp] === value[viewProp] && viewProp !== \'self\'}"><span data-ng-bind="getViewValue(value);" class="user-input-item-value"></span></li></ul></div><span class="btn-trigger btn-arrow-down"></span>'),a.put("index.html","<!DOCTYPE html><html lang=\"ru\" data-ng-app=\"riskMarket\" data-ng-class=\"{'iframe-app': appInFrameMode}\" data-ng-strict-di><head><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n              new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n              j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n              'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n"+'            })(window,document,\'script\',\'dataLayer\',\'GTM-MDZDVN\');</script><meta charset="utf-8"><meta name="fragment" content="!"><base href="/"><title data-ng-bind="pageTitle"></title><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&amp;subset=latin,cyrillic" rel="stylesheet"><link rel="icon" href="img/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="css/vendor-style.min.css"><link rel="stylesheet" href="css/app-style.min.css"></head><body data-popover-close data-ng-class="{\n            \'iframe-app\': appInFrameMode,\n\n            \'iframe-app-ravta\': currentPartner.id === \'RAVTA\'\n        }"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MDZDVN" height="0" width="0" style="display:none;visibility:hidden" ></iframe></noscript><div class="background-container" data-class-at="{\'main-page-background\': \'main-page\'}" data-main-page-bg-random><div class="container-fluid container-wrapper" data-ng-include="\'modules/public-navigation/partials/public-navigation.html\'" data-ng-if="!isPartnerLoginPage() && !appInFrameMode"></div><div data-ng-view class="container-fluid container-wrapper main-content"></div></div><section class="features hidden" data-ng-if="isMainPage()" data-class-at="{visible: \'main-page\'}"><h3 class="subject-title">Сервис онлайн страхования</h3><div class="wrapper"><article class="feature"><figure class="picture-container"><img class="feature-picture" src="img/min/promo/price-wide-choice.png" alt="Большой выбор, гарантия цены"></figure><h4 class="subject-title">Большой выбор<br>Гарантия цены</h4><p class="feature-text">RiskMarket.ru имеет прямые подключения к базам страховых компаний и, отвечая на запросы пользователей, предоставляет множество актуальных вариантов страховых продуктов.</p></article><article class="feature"><figure class="picture-container"><img class="feature-picture" src="img/min/promo/safe-buy.png" alt="Удобная покупка"></figure><h4 class="subject-title">Удобная<br>покупка</h4><p class="feature-text">Для поиска подходящей страховки можно воспользоваться системой фильтров и сортировок, а подробное описание условий, рейтинги и отзывы клиентов помогут сделать окончательный выбор.</p></article><article class="feature"><figure class="picture-container"><img class="feature-picture" src="img/min/promo/policy-storage.png" alt="Хранение полисов"></figure><h4 class="subject-title">Хранение<br>полисов</h4><p class="feature-text">На сервисе для пользователя создается личный кабинет, в котором сохраняется история покупок, и откуда всегда можно распечатать необходимую страховку.</p></article></div><a tabindex="-1" class="btn btn-success" data-ng-href="{{ routes.ABOUT }}">Узнать больше</a></section><article class="promo-slogan hidden" data-ng-if="isMainPage()" data-class-at="{visible: \'main-page\'}"><h3 class="subject-title">RiskMarket.ru дает возможность на одном сайте рассчитать, выбрать и купить страховки на разные случаи жизни прямо у ведущих страховых компаний.</h3></article><footer class="container-fluid container-wrapper container-wrapper-darker" data-ng-include="\'modules/public-footer/partials/public-footer.html\'" data-class-at="{\'container-wrapper-darker\': \'trip-form, search-results\', \'container-wrapper-lighter\': \'order-prepare, order-payment, order-done, order-fail\'}" data-ng-if="!isPartnerLoginPage() && !appInFrameMode"></footer><script type="text/javascript" src="js/vendor-logic.min.js"></script><script type="text/javascript" src="js/app-logic.min.js"></script></body></html>')}]);
//# sourceMappingURL=app-logic.min.js.map